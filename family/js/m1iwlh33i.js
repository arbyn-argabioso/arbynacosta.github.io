function hammerIt(e){hammertime=new Hammer(e,{}),hammertime.get("pinch").set({enable:!0});var t=0,n=0,i=1,o=1,a=0,r=0,s=0,l=0,m="",c=e;hammertime.on("doubletap pinch panend pinchend",function(e){if("doubletap"==e.type){m="translate3d(0, 0, 0) scale3d(2, 2, 1) ",i=2,o=2;try{"matrix(1, 0, 0, 1, 0, 0)"!=window.getComputedStyle(c,null).getPropertyValue("-webkit-transform").toString()&&(m="translate3d(0, 0, 0) scale3d(1, 1, 1) ",i=1,o=1)}catch(e){}c.style.webkitTransform=m,m=""}1!=i&&(t=a+e.deltaX,n=r+e.deltaY,s=Math.ceil((i-1)*c.clientWidth/2),l=Math.ceil((i-1)*c.clientHeight/2),t>s&&(t=s),t<-s&&(t=-s),n>l&&(n=l),n<-l&&(n=-l)),"pinch"==e.type&&(print("test"),i=Math.max(.999,Math.min(o*e.scale,4))),"pinchend"==e.type&&(o=i),"panend"==e.type&&(a=t<s?t:s,r=n<l?n:l),1!=i&&(m="translate3d("+t+"px,"+n+"px, 0) scale3d("+i+", "+i+", 1)"),m&&(c.style.webkitTransform=m)})}!function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.primitives=t()}):"object"==typeof module&&module.exports?module.exports=e.primitives=t():e.primitives=t()}(this,function(){var e={common:{version:"5.6.3"},orgdiagram:{},famdiagram:{},text:{},callout:{},connector:{},shape:{},pdf:{orgdiagram:{},famdiagram:{}}};if(e.common.getElementsByName=function(e,t,n,i){t=t.getElementsByTagName("*");for(var o=0;o<t.length;o+=1){var a=t[o];a.name==n&&i.call(e,a)}},e.common.getFixOfPixelALignment=function(t){t=(n=t.getBoundingClientRect()).top+document.body.scrollTop;var n=n.left+document.body.scrollLeft;return new e.common.Size(-n+Math.floor(n),-t+Math.floor(t))},e.common.getElementOffset=function(e){var t=e.getBoundingClientRect();e=e.ownerDocument.documentElement;return{top:t.top+window.pageYOffset-e.clientTop,left:t.left+window.pageXOffset-e.clientLeft}},e.common.hasClass=function(e,t){if(null!=(n=e.className)&&"string"==typeof n)for(var n=n.split(" "),i=0;i<n.length;i+=1)if(n[i]==t)return!0;return!1},e.common.stopPropagation=function(e){void 0!==e.stopPropagation?e.stopPropagation():void 0!==e.cancelBubble?e.cancelBubble=!0:void 0!==e.preventDefault&&e.preventDefault()},e.common.getInnerSize=function(t){return t=window.getComputedStyle(t),new e.common.Size(parseInt(t.width,10),parseInt(t.height,10))},e.common.isEven=function(e){return 0==e%2},e.common.isNullOrEmpty=function(e){var t=!0;return null!=e&&(0<(e=e.toString()).length&&(t=!1)),t},e.common.isArray=Array.isArray||function(e){return e instanceof Array},e.common.loop=function(t,n,i){var o,a;if(null!=i)if(e.common.isArray(n))for(o=0,a=n.length;o<a&&!i.call(t,o,n[o]);o+=1);else for(o in n)if(n.hasOwnProperty(o)&&i.call(t,o,n[o]))break},e.common.splitCamelCaseName=function(e){for(var t=[],n="",i=0;i<e.length;i+=1){var o=e[i];"A"<=o&&"Z">=o?(""!==n&&t.push(n),n=o):n+=o}return""!==n&&t.push(n),t},e.common.isObject=function(e){return null!==e&&"object"==typeof e},e.common.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},e.common.cloneObject=function(t,n){var i;if(null===t)i=null;else if(t instanceof Array)if(n)i=t.slice(0);else{i=[];for(var o=0,a=t.length;o<a;o+=1)i.push(e.common.cloneObject(t[o],n))}else switch(typeof t){case"object":for(o in i={},t)t.hasOwnProperty(o)&&(i[o]=n?t[o]:e.common.cloneObject(t[o],n));break;default:i=t}return i},e.common.mergeObjects=function(e,t){for(var n=1;n<arguments.length;n+=1){var i=arguments[n];if(null!=i)for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e},e.common.hashCode=function(e){var t,n=0;if(0<e.length)for(t=0;t<e.length;t+=1)n=(n<<5)-n+e.charCodeAt(t),n&=n;return n},e.common.indexOf=function(e,t,n){var i,o;for(i=0;i<e.length;i+=1)if(o=e[i],null!=n?n(o,t):o==t)return i;return-1},e.common._supportsSVG=null,e.common.supportsSVG=function(){return null===e.common._supportsSVG&&(e.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0")),e.common._supportsSVG},e.common._supportsCanvas=null,e.common.supportsCanvas=function(){return null===e.common._supportsCanvas&&(e.common._supportsCanvas=!!window.HTMLCanvasElement),e.common._supportsCanvas},e.common.createGraphics=function(t,n){var i,o,a=null;for(o in i=[t],e.common.GraphicsType)e.common.GraphicsType.hasOwnProperty(o)&&i.push(e.common.GraphicsType[o]);for(o=0;null===a&&o<i.length;o+=1)switch(i[o]){case 0:e.common.supportsSVG()&&(a=new e.common.SvgGraphics(n));break;case 1:e.common.supportsCanvas()&&(a=new e.common.CanvasGraphics(n))}return a},e.common.isChrome=function(){return null!=navigator&&(/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))},e.common.getColorHexValue=function(t){var n,i;if("#"===t.substr(0,1))return t;if(null!==(n=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(t))&&0<n.length)return t=((t=parseInt(n[2],10))<<16|(i=parseInt(n[3],10))<<8|parseInt(n[4],10)).toString(16),n[1]+"000000".substr(0,6-t.length)+t;if(void 0===e.common.ColorHexs)for(i in e.common.ColorHexs={},e.common.Colors)e.common.Colors.hasOwnProperty(i)&&(e.common.ColorHexs[i.toUpperCase()]=e.common.Colors[i]);return e.common.ColorHexs[t.toUpperCase()]},e.common.getColorName=function(t){var n;t=e.common.getColorHexValue(t);if(void 0===e.common.ColorNames)for(n in e.common.ColorNames={},e.common.Colors)e.common.Colors.hasOwnProperty(n)&&(e.common.ColorNames[e.common.Colors[n]]=n);return e.common.ColorNames[t]},e.common.getRed=function(e){return"#"===e.substr(0,1)&&7===e.length?parseInt(e.substr(1,2),16):null},e.common.getGreen=function(e){return"#"===e.substr(0,1)&&7===e.length?parseInt(e.substr(3,2),16):null},e.common.getBlue=function(e){return"#"===e.substr(0,1)&&7===e.length?parseInt(e.substr(5,2),16):null},e.common.beforeOpacity=function(t,n){var i,o=e.common;t=o.getColorHexValue(t);return i=((i=Math.ceil((o.getRed(t)-255*(1-n))/n))<<16|Math.ceil((o.getGreen(t)-255*(1-n))/n)<<8|(o=Math.ceil((o.getBlue(t)-255*(1-n))/n))).toString(16),"#"+"000000".substr(0,6-i.length)+i},e.common.highestContrast=function(t,n,i){var o=n,a=e.common,r=t+","+n+","+i;return void 0===a.highestContrasts&&(a.highestContrasts={}),a.highestContrasts.hasOwnProperty(r)?o=a.highestContrasts[r]:(a.luminosity(n,t)<a.luminosity(i,t)&&(o=i),a.highestContrasts[r]=o),o},e.common.luminosity=function(t,n){var i,o=(i=e.common).getColorHexValue(t),a=i.getColorHexValue(n);return(o=.2126*Math.pow(i.getRed(o)/255,2.2)+.7152*Math.pow(i.getRed(o)/255,2.2)+.0722*Math.pow(i.getRed(o)/255,2.2))>(i=.2126*Math.pow(i.getRed(a)/255,2.2)+.7152*Math.pow(i.getRed(a)/255,2.2)+.0722*Math.pow(i.getRed(a)/255,2.2))?(o+.05)/(i+.05):(i+.05)/(o+.05)},e.common.compareArrays=function(e,t,n){var i,o,a,r,s=!0;if(e.length!=t.length)s=!1;else{for(r={},i=0,o=e.length;i<o;i+=1)r[a=null!=n?n(e[i]):e[i]]=r.hasOwnProperty(a)?r[a]+1:1;for(i=0,o=t.length;i<o;i+=1){if(a=null!=n?n(t[i]):t[i],!r.hasOwnProperty(a)){s=!1;break}if(r[a]-=1,0>r[a]){s=!1;break}}}return s},e.common.JsonML={},"undefined"!=typeof document){var t=e.common.JsonML,n=document,i=function(e){this.value=e},o=function(e){return"function"==typeof e},a=function(e){switch(typeof e){case"object":return e?d(e)?2:u(e)?5:e instanceof Date?4:3:0;case"function":return 1;case"undefined":return 0;default:return 4}},r={accesskey:"accessKey",bgcolor:"bgColor",cellpadding:"cellPadding",cellspacing:"cellSpacing",checked:"defaultChecked",class:"className",colspan:"colSpan",contenteditable:"contentEditable",defaultchecked:"defaultChecked",for:"htmlFor",formnovalidate:"formNoValidate",hidefocus:"hideFocus",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",readonly:"readOnly",rowspan:"rowSpan",spellcheck:"spellCheck",tabindex:"tabIndex",usemap:"useMap",willvalidate:"willValidate"},s={enctype:"encoding",onscroll:"DOMMouseScroll"},l={autocapitalize:1,autocomplete:1,autocorrect:1},m={async:1,autofocus:1,checked:1,defaultchecked:1,defer:1,disabled:1,formnovalidate:1,hidden:1,indeterminate:1,ismap:1,multiple:1,novalidate:1,readonly:1,required:1,spellcheck:1,willvalidate:1},c=/^[\r\n]+/,h=/[\r\n]+$/;i.prototype.toString=function(){return this.value},t.raw=function(e){return new i(e)};var u=t.isRaw=function(e){return e instanceof i},d=Array.isArray||function(e){return e instanceof Array},g=function(e){if(e){if("!"===e.charAt(0))return n.createComment("!"===e?"":e.substr(1)+" ")}else{if(n.createDocumentFragment)return n.createDocumentFragment();e=""}return"style"===e.toLowerCase()&&n.createStyleSheet?n.createStyleSheet():n.createElement(e)},p=function(e,t,n){switch("on"===t.substr(0,2)&&(t=t.substr(2)),typeof n){case"function":if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent&&0!==a(e[t]))e.attachEvent("on"+t,n);else{var i=e["on"+t]||e[t];e["on"+t]=e[t]=o(i)?function(e){return!1!==i.call(this,e)&&!1!==n.call(this,e)}:n}break;case"string":e["on"+t]=new Function("event",n)}},f=t.applyStyles=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n]);return e},T=t.appendDOM=function(e,t){if(t){var i=(e.tagName||"").toLowerCase();if(8===e.nodeType)3===t.nodeType&&(e.nodeValue+=t.nodeValue);else if("table"===i&&e.tBodies){if(t.tagName)if((i=t.tagName.toLowerCase())&&"tbody"!==i&&"thead"!==i){var o=0<e.tBodies.length?e.tBodies[e.tBodies.length-1]:null;o||(o=g("th"===i?"thead":"tbody"),e.appendChild(o)),o.appendChild(t)}else!1!==e.canHaveChildren&&e.appendChild(t);else if(11===t.nodeType)for(;t.firstChild;)T(e,t.removeChild(t.firstChild))}else if("style"===i&&n.createStyleSheet)e.cssText=t;else if(!1!==e.canHaveChildren)e.appendChild(t);else if("object"===i&&t.tagName&&"param"===t.tagName.toLowerCase()){try{e.appendChild(t)}catch(e){}try{e.object&&(e.object[t.name]=t.value)}catch(e){}}}},y=function(e){return!(!e||3!==e.nodeType||e.nodeValue&&/\S/.exec(e.nodeValue))},k=function(e,t){e&&3===e.nodeType&&t.exec(e.nodeValue)&&(e.nodeValue=e.nodeValue.replace(t,""))},v=function(e){if(e){for(;y(e.firstChild);)e.removeChild(e.firstChild);for(k(e.firstChild,c);y(e.lastChild);)e.removeChild(e.lastChild);k(e.lastChild,h)}},w=function(e){var t=g("div");if(t.innerHTML=""+e,v(t),1===t.childNodes.length)return t.firstChild;for(e=g("");t.firstChild;)e.appendChild(t.firstChild);return e};t.onerror=null;var C=t.patch=function(e,t,i){for(var o=1;o<t.length;o+=1)if(d(t[o])||"string"==typeof t[o])T(e,b(t[o],i));else if(u(t[o]))T(e,w(t[o].value));else if("object"==typeof t[o]&&null!==t[o]&&1===e.nodeType){var c=t[o];if(c.name&&n.attachEvent&&!e.parentNode)try{var h=g("<"+e.tagName+' name="'+c.name+'">');e.tagName===h.tagName&&(e=h)}catch(e){}var y=void 0;for(y in c)if(c.hasOwnProperty(y)){var k=c[y],v=a(k);if(y)if(0===v&&(k="",v=4),"$"===(y=r[y.toLowerCase()]||y))k(e);else if("className"==y)if(d(k))for(v=0;v<k.length;v+=1)e.className+=" "+k[v];else e.className+=" "+k;else"style"===y?0!==a(e.style.cssText)?"string"==typeof k?e.style.cssText=k:f(e,k):e.style=k:"on"===y.substr(0,2)?(p(e,y,k),(y=s[y])&&p(e,y,k)):l[y.toLowerCase()]||4===v&&"$"!==y.charAt(0)&&0===a(e[y])&&0===a(e[s[y]])?m[y.toLowerCase()]?k&&(e.setAttribute(y,y),(y=s[y])&&e.setAttribute(y,y)):(e.setAttribute(y,k),(y=s[y])&&e.setAttribute(y,k)):(e[y]=k,(y=s[y])&&(e[y]=k))}}return e},b=t.toHTML=function(e,i){try{if(!e)return null;if("string"==typeof e)return n.createTextNode(e);if(u(e))return w(e.value);if(!d(e)||"string"!=typeof e[0])throw new SyntaxError("invalid JsonML");if(!(r=e[0])){for(var a=g(""),r=1;r<e.length;r+=1)T(a,b(e[r],i));return v(a),1===a.childNodes.length?a.firstChild:a}if("style"===r.toLowerCase()&&n.createStyleSheet)return C(n.createStyleSheet(),e,i),null;var s=C(g(r),e,i);return v(s),s&&o(i)?i(s):s}catch(a){try{return(o(t.onerror)?t.onerror:function(e){return n.createTextNode("["+e+"]")})(a,e,i)}catch(e){return n.createTextNode("["+e+"]")}}};t.toHTMLText=function(e,t){var n=b(e,t);if(n.outerHTML)return n.outerHTML;var i=g("div");i.appendChild(n);var o=i.innerHTML;return i.removeChild(n),o}}return e.common.AdviserPlacementType={Auto:0,Left:2,Right:3},e.orgdiagram.AdviserPlacementType=e.common.AdviserPlacementType,e.common.AnnotationType={Connector:0,Shape:1,HighlightPath:2,Label:3,Background:4},e.common.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3},e.orgdiagram.ChildrenPlacementType=e.common.ChildrenPlacementType,e.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"},e.common.ConnectorLabelPlacementType={From:0,Between:1,To:2},e.common.ConnectorPlacementType={Offbeat:0,Straight:1},e.common.ConnectorShapeType={OneWay:0,TwoWay:1,BothWay:2},e.common.ConnectorStyleType={Extra:0,Regular:1,Highlight:2},e.common.ConnectorType={Squared:0,Angular:1,Curved:2},e.orgdiagram.ConnectorType=e.common.ConnectorType,e.common.ElbowType={None:0,Dot:1,Bevel:2,Round:3},e.common.Enabled={Auto:0,True:1,False:2},e.common.GraphicsType={SVG:0,Canvas:1},e.common.GroupByType={None:0,Parents:1,Children:2},e.common.HorizontalAlignmentType={Center:0,Left:1,Right:2},e.orgdiagram.ItemType={Regular:0,Adviser:2,Assistant:1,SubAssistant:4,SubAdviser:5,GeneralPartner:6,LimitedPartner:7,AdviserPartner:8},e.common.LabelType={Regular:0,Dummy:1,Fixed:2,None:3},e.common.Layers={BackgroundAnnotation:2,BackgroundAnnotations:3,BackgroundConnectorAnnotation:4,BackgroundHighlightPathAnnotations:5,Connector:6,ForegroundHighlightPathAnnotations:7,Highlight:8,Marker:9,Label:10,Cursor:11,Item:12,ForegroundAnnotations:13,ForegroundConnectorAnnotation:14,Annotation:15,Controls:16},e.common.LineType={Solid:0,Dotted:1,Dashed:2},e.common.NavigationMode={Default:0,CursorOnly:1,HighlightOnly:3,Inactive:2},e.common.NeighboursSelectionMode={ParentsAndChildren:0,ParentsChildrenSiblingsAndSpouses:1},e.common.OrientationType={Top:0,Bottom:1,Left:2,Right:3,None:4},e.orgdiagram.OrientationType=e.common.OrientationType,e.common.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3,AutoSize:5,SelectionOnly:6},e.orgdiagram.PageFitMode=e.common.PageFitMode,e.common.PlacementType={Auto:0,TopLeft:8,Top:1,TopRight:2,RightTop:11,Right:3,RightBottom:12,BottomRight:4,Bottom:5,BottomLeft:6,LeftBottom:10,Left:7,LeftTop:9},e.common.RenderingMode={Create:0,Update:1},e.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4},e.common.SelectionPathMode={None:0,FullStack:1},e.orgdiagram.SelectionPathMode=e.common.SelectionPathMode,e.common.ShapeType={Rectangle:0,Oval:1,Triangle:2,CrossOut:3,Circle:4,Rhombus:5,Wedge:7,FramedOval:8,FramedTriangle:9,FramedWedge:10,FramedRhombus:11,None:6},e.common.SideFlag={Top:1,Right:2,Bottom:4,Left:8},e.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2,Auto:3},e.common.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2},e.orgdiagram.UpdateMode=e.common.UpdateMode,e.common.VectorRelationType={None:0,Null:1,Collinear:2,Opposite:3},e.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2},e.common.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4},e.common.ZOrderType={Auto:0,Background:1,Foreground:2},e.common.RenderEventArgs=function(){this.renderingMode=this.templateName=this.context=this.element=this.id=null,this.isSelected=this.isCursor=!1},e.common.BaseShape=function(){},e.common.BaseShape.prototype._getLabelPosition=function(t,n,i,o,a,r,s,l){var m=null;switch(l){case 1:m=new e.common.Rect(t+i/2-a/2,n-s-r,a,r);break;case 2:m=new e.common.Rect(t+i-a,n-s-r,a,r);break;case 8:m=new e.common.Rect(t,n-s-r,a,r);break;case 3:m=new e.common.Rect(t+i+s,n+o/2-r/2,a,r);break;case 11:m=new e.common.Rect(t+i+s,n,a,r);break;case 12:m=new e.common.Rect(t+i+s,n+o-r,a,r);break;case 4:m=new e.common.Rect(t+i-a,n+o+s,a,r);break;case 6:m=new e.common.Rect(t,n+o+s,a,r);break;case 7:m=new e.common.Rect(t-a-s,n+o/2-r/2,a,r);break;case 9:m=new e.common.Rect(t-a-s,n,a,r);break;case 10:m=new e.common.Rect(t-a-s,n+o-r,a,r);break;default:m=new e.common.Rect(t+i/2-a/2,n+o+s,a,r)}return m},e.common.BaseShape.prototype._betweenPoint=function(t,n){return new e.common.Point((t.x+n.x)/2,(t.y+n.y)/2)},e.common.BaseShape.prototype._offsetPoint=function(t,n,i){var o=null;return 0===(o=t.distanceTo(n))||0===i?new e.common.Point(t):new e.common.Point(t.x+(n.x-t.x)/o*i,t.y+(n.y-t.y)/o*i)},e.common.Callout=function(e){this.m_graphics=e,this.pointerPlacement=0,this.cornerRadius="10%",this.offset=0,this.lineWidth=this.opacity=1,this.pointerWidth="10%",this.borderColor="#000000",this.lineType=0,this.fillColor="#d3d3d3",this.m_map=[[8,7,6],[1,null,5],[2,3,4]]},e.common.Callout.prototype=new e.common.BaseShape,e.common.Callout.prototype.draw=function(t,n){n=new e.common.Rect(n).offset(this.offset);var i,o,a=new e.common.Point(n.x,n.y),r=new e.common.Point(n.right(),n.y),s=new e.common.Point(n.right(),n.bottom()),l=[null,null,null,null,null,null,null,null],m=[a,r,s,m=new e.common.Point(n.left(),n.bottom())];r=this.m_graphics.getPxSize(this.cornerRadius,Math.min(a.distanceTo(r),r.distanceTo(s)));for(i={},null!==this.fillColor&&(i.fillColor=this.fillColor,i.opacity=this.opacity),null!==this.lineColor&&(i.lineColor=this.borderColor),i.lineWidth=this.lineWidth,i.lineType=this.lineType,o=new e.common.PaletteItem(i),o=(i=new e.common.PolylinesBuffer).getPolyline(o),null!==t&&(null!==(a=0===this.pointerPlacement?this._getPlacement(t,a,s):this.pointerPlacement)&&(l[a]=t)),s=0;s<m.length;s+=1)this._drawSegment(o,m[0],m[1],m[2],this.pointerWidth,r,l[1],l[2]),a=m.shift(),m.push(a),a=l.shift(),l.push(a),a=l.shift(),l.push(a);this.m_graphics.polylinesBuffer(i)},e.common.Callout.prototype._getPlacement=function(e,t,n){var i=e.x<t.x?0:e.x>n.x?2:1,o=e.y<t.y?0:e.y>n.y?2:1;return this.m_map[i][o]},e.common.Callout.prototype._drawSegment=function(t,n,i,o,a,r,s,l){var m=this._offsetPoint(n,i,r),c=this._offsetPoint(i,n,r);o=this._offsetPoint(i,o,r),a=this.m_graphics.getPxSize(a,n.distanceTo(i)/2);0===t.length()&&t.addSegment(new e.common.MoveSegment(m)),null!==s&&(m=this._betweenPoint(n,i),n=this._offsetPoint(m,n,a),a=this._offsetPoint(m,i,a),t.addSegment(new e.common.LineSegment(n)),t.addSegment(new e.common.LineSegment(s)),t.addSegment(new e.common.LineSegment(a))),t.addSegment(new e.common.LineSegment(c)),null!==l?(t.addSegment(new e.common.LineSegment(l)),t.addSegment(new e.common.LineSegment(o))):t.addSegment(new e.common.QuadraticArcSegment(i,o))},e.common.ConnectorOffbeat=function(){},e.common.ConnectorOffbeat.prototype=new e.common.BaseShape,e.common.ConnectorOffbeat.prototype.draw=function(t,n,i,o,a,r,s,l,m,c,h,u,d,g,p){d=r=0;var f,T,y,k,v,w,C,b,P,O,S=null;switch(P=t.getPolyline(n),v=[],m){case 1:v=[-a/2,a/2],O=!1;break;case 0:v=[0],O=!1;break;case 2:v=[0],O=!0}if(f=Math.max(u?s.width:0,5*a),i.right()+f<o.left()||i.left()>o.right()+f)if(i.left()>o.right()?(y=new e.common.Point(i.left(),i.verticalCenter()),k=new e.common.Point(o.right(),o.verticalCenter())):(y=new e.common.Point(i.right(),i.verticalCenter()),k=new e.common.Point(o.left(),o.verticalCenter())),u&&(i.left()>o.right()?(r=7,d=3):(r=3,d=7)),T=new e.common.Rect(y,k),b=y.y<=k.y,C=y.x<k.x,T.height<T.width){for(T.height<2*a&&T.offset(0,b?2*a:0,0,b?0:2*a),l=0,f=v.length;l<f;l+=1)w=v[l],t.addInverted(function(i){(i=i.getPolyline(n)).addSegment(new e.common.MoveSegment(y.x,y.y+w)),i.addSegment(new e.common.QuadraticArcSegment(T.horizontalCenter(),(b?T.top():T.bottom())+w,k.x,k.y+w)),O&&i.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))})},l||0==m),P.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))});u&&(m=s.width<T.width/5*2?e.common.QuadraticArcSegment.prototype.offsetPoint(y.x,y.y,T.horizontalCenter(),b?T.top():T.bottom(),k.x,k.y,.5):new e.common.Point(y.x,b?T.top():T.bottom()),S=new e.common.Rect(m.x+(C?a:-s.width-a),b?m.y-s.height-a:m.y+a,s.width,s.height))}else{for(l=0,f=v.length;l<f;l+=1)w=v[l],t.addInverted(function(i){(i=i.getPolyline(n)).addSegment(new e.common.MoveSegment(y.x,y.y+w)),i.addSegment(new e.common.QuadraticArcSegment(T.horizontalCenter()+w*(b!=C?1:-1),(b?T.top():T.bottom())+w,T.horizontalCenter()+w*(b!=C?1:-1),T.verticalCenter()+w)),i.addSegment(new e.common.QuadraticArcSegment(T.horizontalCenter()+w*(b!=C?1:-1),(b?T.bottom():T.top())+w,k.x,k.y+w)),O&&i.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))})},l||0==m),P.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))});u&&(S=new e.common.Rect(T.horizontalCenter()+(b!=C?a:-(a+s.width)),T.verticalCenter()-s.height/2,s.width,s.height))}else if(i.verticalCenter()<o.top()||i.verticalCenter()>o.bottom()){for(C=i.x<l.width/2,y=new e.common.Point(C?i.right():i.left(),i.verticalCenter()),k=new e.common.Point(C?o.right():o.left(),o.verticalCenter()),(T=new e.common.Rect(y,k)).offset(10*a,0,10*a,0),b=y.y<=k.y,l=0,f=v.length;l<f;l+=1)w=v[l],t.addInverted(function(i){(i=i.getPolyline(n)).addSegment(new e.common.MoveSegment(y.x,y.y+w)),i.addSegment(new e.common.QuadraticArcSegment(C?T.right()+w*(b?-1:1):T.left()-w*(b?-1:1),T.verticalCenter(),C?o.right():o.left(),o.verticalCenter()-w)),O&&i.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))})},l||0==m),P.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))});u&&(d=r=C?3:7,m=e.common.QuadraticArcSegment.prototype.offsetPoint(y.x,y.y,C?T.right():T.left(),T.verticalCenter(),k.x,k.y,.5),S=new e.common.Rect(m.x+(C?a/2:-a/2-s.width),m.y-s.height/2,s.width,s.height))}else{for(y=new e.common.Point(i.horizontalCenter(),i.top()),k=new e.common.Point(o.horizontalCenter(),o.top()),(T=new e.common.Rect(y,k)).offset(0,7*a,0,0),C=y.x<k.x,l=0,f=v.length;l<f;l+=1)w=v[l],t.addInverted(function(i){(i=i.getPolyline(n)).addSegment(new e.common.MoveSegment(y.x+w,y.y)),i.addSegment(new e.common.QuadraticArcSegment(T.horizontalCenter(),T.top()-w*(C?-1:1),o.horizontalCenter()-w,o.top())),O&&i.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))})},l||0==m),P.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))});u&&(d=r=1,m=e.common.QuadraticArcSegment.prototype.offsetPoint(y.x,y.y,T.horizontalCenter(),T.top(),k.x,k.y,.5),S=new e.common.Rect(m.x-s.width/2,m.y-(c+s.height),s.width,s.height))}if(u)switch(h){case 0:S=this._getLabelPosition(i.x,i.y,i.width,i.height,S.width,S.height,c,r);break;case 2:S=this._getLabelPosition(o.x,o.y,o.width,o.height,S.width,S.height,c,d)}null!=g&&g(S,p)},e.common.ConnectorStraight=function(){},e.common.ConnectorStraight.prototype=new e.common.BaseShape,e.common.ConnectorStraight.prototype.draw=function(t,n,i,o,a,r,s,l,m,c,h,u,d,g,p){var f,T,y,k,v,w=a/2,C=null,b=0,P=0,O=this;if(k=new e.common.Vector(i.centerPoint(),o.centerPoint()),i.loopEdges(function(e,t){return f=e.getIntersectionPoint(k,!0,1),b=t,null!=f}),o.loopEdges(function(e,t){return T=e.getIntersectionPoint(k,!0,1),P=t,null!=T}),null!=f&&null!=T){var S=new e.common.Vector(f,T);d.getOffset(S,function(i,o,a){switch(S.offset((i*r-(o-1)*r/2)*a),f=S.from,T=S.to,m){case 1:(v=new e.common.Vector(T.clone(),f.clone())).offset(w),O._drawLine(t,n,v.from,v.to,!1),(v=new e.common.Vector(f.clone(),T.clone())).offset(w),O._drawLine(t,n,v.from,v.to,!1);break;case 0:O._drawLine(t,n,f,T,!1);break;case 2:O._drawLine(t,n,f,T,!0)}if(u){switch(h){case 0:C=O._getLabelPositionBySnapPoint(f.x,f.y,s.width,s.height,c,b);break;case 1:y=O._betweenPoint(f,T),C=O._getLabelPositionBySnapPoint(y.x,y.y,s.width,s.height,c,3);break;case 2:C=O._getLabelPositionBySnapPoint(T.x,T.y,s.width,s.height,c,P)}null!=g&&g.call(this,C,p)}})}},e.common.ConnectorStraight.prototype._drawLine=function(t,n,i,o,a){var r;t.addInverted(function(a){(r=a.getPolyline(n)).addSegment(new e.common.MoveSegment(i)),r.addSegment(new e.common.LineSegment(o)),r.addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))})},!1),a&&(r=t.getPolyline(n)).addArrow(n.lineWidth,function(e){e.mergeTo(t.getPolyline(e.paletteItem))})},e.common.ConnectorStraight.prototype._getLabelPositionBySnapPoint=function(t,n,i,o,a,r){var s=null;switch(r){case 0:case 1:s=new e.common.Rect(t-i/2,n-a-o,i,o);break;case 3:s=new e.common.Rect(t+a,n-o/2,i,o);break;case 5:s=new e.common.Rect(t-i/2,n+a,i,o);break;case 7:s=new e.common.Rect(t-i-a,n-o/2,i,o)}return s},e.common.Marker=function(){},e.common.Marker.Markers={},e.common.Marker.DrawCircle=function(t,n){var i=Math.min(n.width/2,n.height/2);n=new e.common.Rect(n.horizontalCenter()-i,n.verticalCenter()-i,2*i,2*i);e.common.Marker.DrawOval(t,n)},e.common.Marker.DrawRectangle=function(t,n){t.addSegment(new e.common.MoveSegment(n.x,n.verticalCenter())),t.addSegment(new e.common.LineSegment(n.x,n.y)),t.addSegment(new e.common.LineSegment(n.right(),n.y)),t.addSegment(new e.common.LineSegment(n.right(),n.bottom())),t.addSegment(new e.common.LineSegment(n.x,n.bottom())),t.addSegment(new e.common.LineSegment(n.x,n.verticalCenter()))},e.common.Marker.DrawOval=function(t,n){var i,o;i=n.width/2*.5522848,o=n.height/2*.5522848,t.addSegment(new e.common.MoveSegment(n.x,n.verticalCenter())),t.addSegment(new e.common.CubicArcSegment(n.x,n.verticalCenter()-o,n.horizontalCenter()-i,n.y,n.horizontalCenter(),n.y)),t.addSegment(new e.common.CubicArcSegment(n.horizontalCenter()+i,n.y,n.right(),n.verticalCenter()-o,n.right(),n.verticalCenter())),t.addSegment(new e.common.CubicArcSegment(n.right(),n.verticalCenter()+o,n.horizontalCenter()+i,n.bottom(),n.horizontalCenter(),n.bottom())),t.addSegment(new e.common.CubicArcSegment(n.horizontalCenter()-i,n.bottom(),n.x,n.verticalCenter()+o,n.x,n.verticalCenter()))},e.common.Marker.DrawTriangle=function(t,n){t.addSegment(new e.common.MoveSegment(n.left(),n.bottom())),t.addSegment(new e.common.LineSegment(n.horizontalCenter(),n.y)),t.addSegment(new e.common.LineSegment(n.right(),n.bottom())),t.addSegment(new e.common.LineSegment(n.left(),n.bottom()))},e.common.Marker.DrawCrossOut=function(t,n){t.addSegment(new e.common.MoveSegment(n.horizontalCenter(),n.verticalCenter())),t.addSegment(new e.common.LineSegment(n.x,n.y)),t.addSegment(new e.common.MoveSegment(n.horizontalCenter(),n.verticalCenter())),t.addSegment(new e.common.LineSegment(n.right(),n.bottom())),t.addSegment(new e.common.MoveSegment(n.horizontalCenter(),n.verticalCenter())),t.addSegment(new e.common.LineSegment(n.right(),n.y)),t.addSegment(new e.common.MoveSegment(n.horizontalCenter(),n.verticalCenter())),t.addSegment(new e.common.LineSegment(n.left(),n.bottom()))},e.common.Marker.DrawRhombus=function(t,n){t.addSegment(new e.common.MoveSegment(n.horizontalCenter(),n.bottom())),t.addSegment(new e.common.LineSegment(n.left(),n.verticalCenter())),t.addSegment(new e.common.LineSegment(n.horizontalCenter(),n.y)),t.addSegment(new e.common.LineSegment(n.right(),n.verticalCenter())),t.addSegment(new e.common.LineSegment(n.horizontalCenter(),n.bottom()))},e.common.Marker.DrawWedge=function(t,n){t.addSegment(new e.common.MoveSegment(n.horizontalCenter(),n.y)),t.addSegment(new e.common.LineSegment(n.right(),n.y)),t.addSegment(new e.common.LineSegment(n.horizontalCenter(),n.bottom())),t.addSegment(new e.common.LineSegment(n.left(),n.y)),t.addSegment(new e.common.LineSegment(n.horizontalCenter(),n.y))},e.common.Marker.DrawFramedOval=function(t,n){e.common.Marker.DrawRectangle(t,n),e.common.Marker.DrawOval(t,n)},e.common.Marker.DrawFramedTriangle=function(t,n){e.common.Marker.DrawRectangle(t,n),e.common.Marker.DrawTriangle(t,n)},e.common.Marker.DrawFramedWedge=function(t,n){e.common.Marker.DrawRectangle(t,n),e.common.Marker.DrawWedge(t,n)},e.common.Marker.DrawFramedRhombus=function(t,n){e.common.Marker.DrawRectangle(t,n),e.common.Marker.DrawRhombus(t,n)},e.common.Marker.DrawNone=function(){},e.common.Marker.Markers[4]=e.common.Marker.DrawCircle,e.common.Marker.Markers[0]=e.common.Marker.DrawRectangle,e.common.Marker.Markers[1]=e.common.Marker.DrawOval,e.common.Marker.Markers[2]=e.common.Marker.DrawTriangle,e.common.Marker.Markers[3]=e.common.Marker.DrawCrossOut,e.common.Marker.Markers[5]=e.common.Marker.DrawRhombus,e.common.Marker.Markers[7]=e.common.Marker.DrawWedge,e.common.Marker.Markers[8]=e.common.Marker.DrawFramedOval,e.common.Marker.Markers[9]=e.common.Marker.DrawFramedTriangle,e.common.Marker.Markers[10]=e.common.Marker.DrawFramedWedge,e.common.Marker.Markers[11]=e.common.Marker.DrawFramedRhombus,e.common.Marker.Markers[6]=e.common.Marker.DrawNone,e.common.Marker.prototype.draw=function(t,n,i,o){t=t.getPolyline(o),e.common.Marker.Markers[n](t,i)},e.common.MergedRectangles=function(e){this.graphics=e,this.transform=null,this.opacity=this.lineWidth=1,this.fillColor=null,this.lineType=0,this.borderColor=null},e.common.MergedRectangles.prototype=new e.common.BaseShape,e.common.MergedRectangles.prototype.draw=function(t){var n=new e.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,fillColor:this.fillColor,lineType:this.lineType,opacity:this.opacity}),i=new e.common.Polyline(n);e.common.getMergedRectangles(this,t,function(t){for(var n=0,o=t.length;n<o;n+=1){var a=t[n];0==n?i.addSegment(new e.common.MoveSegment(a.x,a.y)):i.addSegment(new e.common.LineSegment(a.x,a.y))}}),i.transform(this.transform,!0),this.graphics.polyline(i)},e.common.Shape=function(t){this.m_graphics=t,this.transform=null,this.orientationType=0,this.panelSize=null,this.shapeType=0,this.offset=new e.common.Thickness(0,0,0,0),this.lineWidth=1,this.labelOffset=4,this.cornerRadius="10%",this.opacity=1,this.fillColor=null,this.labelSize=new e.common.Size(60,30),this.lineType=0,this.borderColor=null,this.hasLabel=!1,this.labelTemplate=null,this.labelPlacement=0},e.common.Shape.prototype=new e.common.BaseShape,e.common.Shape.prototype.draw=function(t,n){var i,o,a,r;t=new e.common.Rect(t).offset(this.offset);switch(this.transform=new e.common.Transform,this.transform.size=this.panelSize,this.transform.setOrientation(this.orientationType),this.hasLabel&&(i=this._getLabelPosition(t.x,t.y,t.width,t.height,this.labelSize.width,this.labelSize.height,this.labelOffset,this.labelPlacement)),this.shapeType){case 0:(o=new e.common.Callout(this.m_graphics)).cornerRadius=this.cornerRadius,o.opacity=this.opacity,o.lineWidth=this.lineWidth,o.lineType=this.lineType,o.borderColor=this.borderColor,o.fillColor=this.fillColor,o.draw(null,t);break;default:o=new e.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,lineType:this.lineType,fillColor:this.fillColor,opacity:this.opacity}),this.transform.transformRect(t.x,t.y,t.width,t.height,!1,this,function(n,i,o,a){t=new e.common.Rect(n,i,o,a)}),r=new e.common.Marker,a=new e.common.PolylinesBuffer,r.draw(a,this.shapeType,t,o),a.transform(this.transform,!0),this.m_graphics.polylinesBuffer(a)}this.hasLabel&&this.m_graphics.template(i.x,i.y,0,0,0,0,i.width,i.height,this.labelTemplate.template(),this.labelTemplate.getHashCode(),this.labelTemplate.render,n,null)},e.common.Point=function(e,t){switch(this.context=this.y=this.x=null,arguments.length){case 1:this.x=e.x,this.y=e.y,this.context=e.context;break;case 2:this.x=e,this.y=t}},e.common.Point.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.common.Point.prototype.distanceTo=function(e,t){var n=0,i=0;switch(arguments.length){case 1:n=e.x,i=e.y;break;case 2:n=e,i=t}return n=this.x-n,i=this.y-i,Math.sqrt(n*n+i*i)},e.common.Point.prototype.equalTo=function(e){return this.x==e.x&&this.y==e.y},e.common.Point.prototype.swap=function(e){var t=e.x,n=e.y;e.x=this.x,e.y=this.y,this.x=t,this.y=n},e.common.Point.prototype.clone=function(){return new e.common.Point(this)},e.common.Point.prototype.toString=function(e){e=void 0!==e?e:"px";return"left:"+this.x+e+";"+"top:"+this.y+e+";"},e.common.Point.prototype.getCSS=function(e){return e=void 0!==e?e:"px",{left:this.x+e,top:this.y+e}},e.common.Rect=function(e,t,n,i){switch(this.context=this.height=this.width=this.y=this.x=null,arguments.length){case 1:this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height;break;case 2:this.x=Math.min(e.x,t.x),this.y=Math.min(e.y,t.y),this.width=Math.abs(t.x-e.x),this.height=Math.abs(t.y-e.y);break;case 4:this.x=e,this.y=t,this.width=n,this.height=i}},e.common.Rect.prototype.left=function(){return this.x},e.common.Rect.prototype.top=function(){return this.y},e.common.Rect.prototype.right=function(){return this.x+this.width},e.common.Rect.prototype.bottom=function(){return this.y+this.height},e.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2},e.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2},e.common.Rect.prototype.centerPoint=function(){return new e.common.Point(this.horizontalCenter(),this.verticalCenter())},e.common.Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||0>this.width||0>this.height},e.common.Rect.prototype.offset=function(e,t,n,i){switch(arguments.length){case 1:null!==e&&"object"==typeof e?(this.x-=e.left,this.y-=e.top,this.width=this.width+e.left+e.right,this.height=this.height+e.top+e.bottom):(this.x-=e,this.y-=e,this.width+=2*e,this.height+=2*e);break;case 4:this.x-=e,this.y-=t,this.width=this.width+e+n,this.height=this.height+t+i}return this},e.common.Rect.prototype.scale=function(e){return this.x*=e,this.y*=e,this.width*=e,this.height*=e,this},e.common.Rect.prototype.translate=function(e,t){return this.x+=e,this.y+=t,this},e.common.Rect.prototype.invert=function(){var e=this.width,t=this.x;return this.width=this.height,this.height=e,this.x=this.y,this.y=t,this},e.common.Rect.prototype.loopEdges=function(t){var n=[new e.common.Point(this.left(),this.top()),new e.common.Point(this.right(),this.top()),new e.common.Point(this.right(),this.bottom()),new e.common.Point(this.left(),this.bottom())],i=[1,3,5,7];if(n.push(n[0]),null!=t)for(var o=1,a=n.length;o<a&&!t(new e.common.Vector(n[o-1],n[o]),i[o-1]);o+=1);return this},e.common.Rect.prototype.contains=function(e,t){switch(arguments.length){case 1:return this.x<=e.x&&e.x<=this.x+this.width&&this.y<=e.y&&e.y<=this.y+this.height;case 2:return this.x<=e&&e<=this.x+this.width&&this.y<=t&&t<=this.y+this.height;default:return!1}},e.common.Rect.prototype.cropByRect=function(e){return this.x<e.x&&(this.width-=e.x-this.x,this.x=e.x),this.right()>e.right()&&(this.width-=this.right()-e.right()),this.y<e.y&&(this.height-=e.y-this.y,this.y=e.y),this.bottom()>e.bottom()&&(this.height-=this.bottom()-e.bottom()),this.isEmpty()&&(this.height=this.width=this.y=this.x=null),this},e.common.Rect.prototype.overlaps=function(e){var t=!0;return(this.x+this.width<e.x||e.x+e.width<this.x||this.y+this.height<e.y||e.y+e.height<this.y)&&(t=!1),t},e.common.Rect.prototype.addRect=function(e,t,n,i){var o,a;switch(arguments.length){case 1:e.isEmpty()||(this.isEmpty()?(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height):(o=Math.max(this.right(),e.right()),a=Math.max(this.bottom(),e.bottom()),this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=o-this.x,this.height=a-this.y));break;case 2:this.isEmpty()?(this.x=e,this.y=t,this.height=this.width=0):(o=Math.max(this.right(),e),a=Math.max(this.bottom(),t),this.x=Math.min(this.x,e),this.y=Math.min(this.y,t),this.width=o-this.x,this.height=a-this.y);break;case 4:this.isEmpty()?(this.x=e,this.y=t,this.width=n,this.height=i):(o=Math.max(this.right(),e+n),a=Math.max(this.bottom(),t+i),this.x=Math.min(this.x,e),this.y=Math.min(this.y,t),this.width=o-this.x,this.height=a-this.y)}return this},e.common.Rect.prototype.getCSS=function(e){return e=void 0!==e?e:"px",{left:this.x+e,top:this.y+e,width:this.width+e,height:this.height+e}},e.common.Rect.prototype.toString=function(e){var t;e=void 0!==e?e:"px";return t="left:"+this.x+e+";",t+="top:"+this.y+e+";",(t+="width:"+this.width+e+";")+"height:"+this.height+e+";"},e.common.Rect.prototype.validate=function(){if(isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height))throw"Invalid rect position."},e.common.Rect.prototype.equalTo=function(e){return this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},e.common.MoveSegment=function(){this.parent=e.common.Point.prototype,this.parent.constructor.apply(this,arguments),this.segmentType=1},e.common.MoveSegment.prototype=new e.common.Point,e.common.MoveSegment.prototype.clone=function(){return new e.common.MoveSegment(this)},e.common.MoveSegment.prototype.loop=function(e,t){null!=t&&t.call(e,this.x,this.y,0)},e.common.MoveSegment.prototype.setPoint=function(e){this.x=e.x,this.y=e.y},e.common.MoveSegment.prototype.getEndPoint=function(){return this},e.common.MoveSegment.prototype.invert=function(e){this.x=e.x,this.y=e.y},e.common.MoveSegment.prototype.transform=function(e,t){var n=this;e.transformPoint(n.x,n.y,t,n,function(e,t){n.x=e,n.y=t})},e.common.CubicArcSegment=function(t,n,i,o,a,r){switch(this.parent=e.common.Point.prototype,this.cpY2=this.cpX2=this.cpY1=this.cpX1=this.y=this.x=null,arguments.length){case 3:this.parent.constructor.apply(this,[i.x,i.y]),this.cpX1=t.x,this.cpY1=t.y,this.cpX2=n.x,this.cpY2=n.y;break;case 6:this.parent.constructor.apply(this,[a,r]),this.cpX1=t,this.cpY1=n,this.cpX2=i,this.cpY2=o}this.segmentType=3},e.common.CubicArcSegment.prototype=new e.common.Point,e.common.CubicArcSegment.prototype.clone=function(){return new e.common.CubicArcSegment(this.cpX1,this.cpY1,this.cpX2,this.cpY2,this.x,this.y)},e.common.CubicArcSegment.prototype.loop=function(e,t){null!=t&&(t.call(e,this.cpX1,this.cpY1,0),t.call(e,this.cpX2,this.cpY2,1),t.call(e,this.x,this.y,2))},e.common.CubicArcSegment.prototype.setPoint=function(e,t){switch(t){case 0:this.cpX1=e.x,this.cpY1=e.y;break;case 1:this.cpX2=e.x,this.cpY2=e.y;break;case 2:this.x=e.x,this.y=e.y}},e.common.CubicArcSegment.prototype.getEndPoint=function(){return this},e.common.CubicArcSegment.prototype.invert=function(e){var t=this.cpX1,n=this.cpY1;this.x=e.x,this.y=e.y,this.cpX1=this.cpX2,this.cpY1=this.cpY2,this.cpX2=t,this.cpY2=n},e.common.CubicArcSegment.prototype.transform=function(e,t){var n=this;e.transform3Points(n.x,n.y,n.cpX1,n.cpY1,n.cpX2,n.cpY2,t,n,function(e,t,i,o,a,r){n.x=e,n.y=t,n.cpX1=i,n.cpY1=o,n.cpX2=a,n.cpY2=r})},e.common.CubicArcSegment.prototype.trim=function(e,t){var n=.5,i=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,e.x,e.y,n),o=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,e.x,e.y,.1);n=t*(n/i.distanceTo(this.x,this.y)+.1/o.distanceTo(this.x,this.y))/2,i=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,e.x,e.y,n);return this.x=i.x,this.y=i.y,this},e.common.CubicArcSegment.prototype.offsetPoint=function(t,n,i,o,a,r,s,l,m){return new e.common.Point((1-m)*(1-m)*(1-m)*t+3*(1-m)*(1-m)*m*i+3*(1-m)*m*m*a+m*m*m*s,(1-m)*(1-m)*(1-m)*n+3*(1-m)*(1-m)*m*o+3*(1-m)*m*m*r+m*m*m*l)},e.common.DotSegment=function(e,t,n,i,o){this.segmentType=4,this.x=e,this.y=t,this.width=n,this.height=i,this.cornerRadius=o},e.common.Label=function(){this.position=this.text=null,this.weight=0,this.isActive=!0,this.horizontalAlignmentType=this.labelOrientation=this.labelType=0,this.verticalAlignmentType=2,this.parent=e.common.Rect.prototype,this.parent.constructor.apply(this,arguments)},e.common.Label.prototype=new e.common.Rect,e.common.LineSegment=function(){this.parent=e.common.MoveSegment.prototype,this.parent.constructor.apply(this,arguments),this.segmentType=0},e.common.LineSegment.prototype=new e.common.MoveSegment,e.common.LineSegment.prototype.clone=function(){return new e.common.LineSegment(this)},e.common.LineSegment.prototype.trim=function(e,t){var n=this.offsetPoint(this,e,t);return this.x=n.x,this.y=n.y,this},e.common.LineSegment.prototype.offsetPoint=function(t,n,i){var o=null;return 0===(o=t.distanceTo(n))||0===i?new e.common.Point(t):new e.common.Point(t.x+(n.x-t.x)/o*i,t.y+(n.y-t.y)/o*i)},e.common.Matrix=function(e,t,n,i){switch(this.b2=this.a2=this.b1=this.a1=null,arguments.length){case 1:this.a1=e.a1,this.b1=e.b1,this.a2=e.a2,this.b2=e.b2;break;case 4:this.a1=e,this.b1=t,this.a2=n,this.b2=i}},e.common.Matrix.prototype.determinant=function(){return this.a1*this.b2-this.b1*this.a2},e.common.PaletteItem=function(t){var n,i,o,a;for(this.lineColor="#c0c0c0",this.lineWidth=1,this.lineType=0,this.opacity=this.fillColor=null,this._key="",o=0,a=(i=["lineColor","lineWidth","lineType","fillColor","opacity"]).length;o<a;o+=1)n=i[o],null!=t&&t.hasOwnProperty(n)&&(this[n]=t[n]),this._key+=(e.common.isNullOrEmpty(this._key)?"":", ")+n+":"+this[n]},e.common.PaletteItem.prototype.toAttr=function(){var e={lineWidth:this.lineWidth,lineType:this.lineType};return null!==this.fillColor&&(e.fillColor=this.fillColor),null!==this.opacity&&(e.opacity=this.opacity),null!==this.lineColor&&(e.borderColor=this.lineColor),e},e.common.PaletteItem.prototype.toString=function(){return this._key},e.common.PaletteManager=function(t,n){var i,o;if(this.palette=[],this.cursor=0,0===n.length)this.palette=[new e.common.PaletteItem({lineColor:t.linesColor,lineWidth:t.linesWidth,lineType:t.linesType})],this.paletteLength=this.palette.length,this.regularIndex=0;else{for(i=0,o=n.length;i<o;i+=1)this.palette.push(new e.common.PaletteItem(n[i]));this.paletteLength=this.palette.length,this.palette.push(new e.common.PaletteItem({lineColor:t.linesColor,lineWidth:t.linesWidth,lineType:t.linesType})),this.regularIndex=this.palette.length-1}this.palette.push(new e.common.PaletteItem({lineColor:t.highlightLinesColor,lineWidth:t.highlightLinesWidth,lineType:t.highlightLinesType})),this.highlightIndex=this.palette.length-1},e.common.PaletteManager.prototype.selectPalette=function(e){this.cursor=e%this.paletteLength},e.common.PaletteManager.prototype.getPalette=function(e){var t=null;switch(e){case 1:t=this.regularIndex;break;case 2:t=this.highlightIndex;break;case 0:t=this.cursor}return this.palette[t]},e.common.Polyline=function(t){function n(e,t){var n,i,o;if(null!=t)for(n=0,i=h.length;n<i&&(!(o=h[n])||!t.call(e,o,n));n+=1);}function i(){return e.common.isNullOrEmpty(c.fillColor)}function o(t,n,i,o,a,r){var s,l,c=new e.common.Polyline(m),h=(a=[new e.common.Point(a,-r/2),new e.common.Point(0,0),new e.common.Point(a,r/2),new e.common.Point(a/4*3,0)],Math.atan2(n-o,t-i));for(t=0,n=a.length;t<n;t+=1)s=(r=a[t]).x*Math.cos(h)-r.y*Math.sin(h),l=r.x*Math.sin(h)+r.y*Math.cos(h),r.x=s+i,r.y=l+o;return c.addSegment(new e.common.MoveSegment(a[0].x,a[0].y)),c.addSegment(new e.common.LineSegment(a[1].x,a[1].y)),c.addSegment(new e.common.LineSegment(a[2].x,a[2].y)),c.addSegment(new e.common.QuadraticArcSegment(a[3].x,a[3].y,a[0].x,a[0].y)),c}function a(e,t){this.segment=e,this.pointIndex=t}function r(t,n,i,o,r){var s=t.relateTo(n),l=r?0:i;2==s?n.offset(l):3==s&&0===n.from.context.pointIndex?(s=new e.common.LineSegment(n.from),o.addSegment(s),n.offset(l),(o=n.from.clone()).context=new a(s,0),l=new e.common.Vector(t.to.clone(),o),r||(n.from=o.clone()),l.offset(i),l.intersect(t),l.from.context.pushToSegment(l.from),n.intersect(l),r&&l.to.context.pushToSegment(l.to)):(n.offset(l),n.intersect(t)),n.from.context.pushToSegment(n.from)}function s(e,t,n,i){var o=e[0],a=o.to.context.segment.getEndPoint().toString();t.hasOwnProperty(a)&&(r(o,t[a],n,i,!0),delete t[a]),o.to.context.pushToSegment(o.to),e.length=0}var l,m,c=new e.common.PaletteItem,h=[];switch(arguments.length){case 1:c=t}return m=new e.common.PaletteItem({lineColor:c.lineColor,lineWidth:0,fillColor:c.lineColor,opacity:c.opacity||1}),a.prototype.pushToSegment=function(e){this.segment.setPoint(e,this.pointIndex)},l={paletteItem:c,arrowPaletteItem:m,addSegment:function(e){h.push(e)},addSegments:function(e){var t,n;for(t=0,n=e.length;t<n;t+=1)h.push(e[t])},mergeTo:function(e){e.addSegments(h)},length:function(){return h.length},loop:n,loopReversed:function(e,t){var n,i;if(null!=t)for(n=h.length-1;0<=n&&(!(i=h[n])||!t.call(e,i,n));n-=1);},transform:function(e,t){n(this,function(n){null!=n.transform&&n.transform(e,t)})},isInvertable:i,addInverted:function(t){var n=!1,o=[];i()?t.loopReversed(this,function(t){4!=t.segmentType&&(n||(h.push(new e.common.MoveSegment(t.getEndPoint())),n=!0),o.unshift(t),1<o.length&&(o[1].invert(o[0].getEndPoint()),h.push(o[1]),o.length=1))}):t.mergeTo(l)},addArrow:function(t,n){var i,a,r,s;a=h.length,s=3*t;var l=2*t;switch(t){case 1:s=8,l=6;break;case 2:s=12,l=8;break;case 3:s=16,l=10}null!=n&&1<a&&(i=h[a-2].getEndPoint(),null!=(r=h[a-1]).trim&&(a=new e.common.Point(r.getEndPoint()),n(s=o((i=r.trim(i,l)).x,i.y,a.x,a.y,s,l),i)))},addOffsetArrow:function(t,n,i,a,r){var s,l,m;s=h.length,m=3*n;var c,u=2*n;switch(n){case 1:m=8,u=6;break;case 2:m=12,u=8;break;case 3:m=16,u=10}null!=r&&1<s&&(n=h[s-2].getEndPoint(),null!=(l=h[s-1]).offsetPoint&&(s=new e.common.Point(l.getEndPoint()),(c=n.distanceTo(s))>a&&(i*=c,t?(t=l.offsetPoint(n,s,i),m=o(n.x,n.y,t.x,t.y,m,u)):(t=l.offsetPoint(s,n,i),m=o(s.x,s.y,t.x,t.y,m,u)),r(m))))},optimizeMoveSegments:function(){var e,t,n,i,o;n={};var a=[],r=[];for(e=0,t=h.length;e<t-1;e+=1)switch(i=h[e],o=h[e+1],i.segmentType){case 0:case 2:case 3:switch(o.segmentType){case 1:case 4:i=i.x+"&"+i.y,n.hasOwnProperty(i)||(n[i]=e)}break;case 1:i=i.x+"&"+i.y,n.hasOwnProperty(i)&&!a[n[i]]&&(a[n[i]]=e+1,r[e]=!0)}for(o=[],e=0;e<t;e+=1)if(!r[e]&&(i=h[e],o.push(i),r[e]=!0,0<a[e]))for(n=a[e];n<t&&!r[n];)i=h[n],o.push(i),r[n]=!0,n=0<a[n]?a[n]:n+1;h=o},getOffsetPolyine:function(t){var i=new e.common.Polyline(c),o={},l=[],m=[];return n(this,function(n){var c=n.clone();switch(c.segmentType){case 4:case 1:0<m.length&&s(m,o,t,i),l.length=0,1==c.segmentType&&((n=new e.common.Point(c)).context=new a(c,0),l.push(n));break;default:c.loop(this,function(n,s,h){switch((n=new e.common.Point(n,s)).context=new a(c,h),l.unshift(n),1<l.length&&(m.unshift(new e.common.Vector(l[1].clone(),l[0].clone())),l.length=1),m.length){case 1:n=(h=m[0]).from.toString(),o[n]=h,h.offset(t),h.from.context.pushToSegment(h.from);break;case 2:r(n=m[1],h=m[0],t,i,!1),m.length=1}})}i.addSegment(c)}),0<m.length&&s(m,o,t,i),i},toString:function(){return c.toString()},getStartPoint:function(){var e=null;return 0<h.length&&(e=h[0].getEndPoint()),e},getEndPoint:function(){var e=null;return 0<h.length&&(e=h[h.length-1].getEndPoint()),e},clone:function(){var t,n,i,o=new e.common.Polyline(c),a=[];for(t=0,n=h.length;t<n;t+=1)i=h[t],a.push(i.clone());return o.addSegments(a),o}}},e.common.PolylinesBuffer=function(){function t(t,n){return t[n.toString()]||(t[n.toString()]=new e.common.Polyline(n)),t[n.toString()]}function n(e,t){var n,o;if(null!=t)for(n in i)if(i.hasOwnProperty(n)&&(o=i[n])&&(o.optimizeMoveSegments(),t.call(e,o)))break}var i={};return{getPolyline:function(e){return t(i,e)},loop:n,addInverted:function(e,o){var a,r;a=i,i={},null!=e&&e(this),n(this,function(e){r=t(a,e.paletteItem),o?e.mergeTo(r):r.addInverted(e)}),i=a},transform:function(e,t){n(this,function(n){n.transform(e,t)})}}},e.common.QuadraticArcSegment=function(e,t,n,i){switch(this.cpY=this.cpX=this.y=this.x=null,arguments.length){case 2:this.x=t.x,this.y=t.y,this.cpX=e.x,this.cpY=e.y;break;case 4:this.cpX=e,this.cpY=t,this.x=n,this.y=i}this.segmentType=2},e.common.QuadraticArcSegment.prototype.clone=function(){return new e.common.QuadraticArcSegment(this.cpX,this.cpY,this.x,this.y)},e.common.QuadraticArcSegment.prototype.loop=function(e,t){null!=t&&(t.call(e,this.cpX,this.cpY,0),t.call(e,this.x,this.y,1))},e.common.QuadraticArcSegment.prototype.setPoint=function(e,t){switch(t){case 0:this.cpX=e.x,this.cpY=e.y;break;case 1:this.x=e.x,this.y=e.y}},e.common.QuadraticArcSegment.prototype.getEndPoint=function(){return this},e.common.QuadraticArcSegment.prototype.invert=function(e){this.x=e.x,this.y=e.y},e.common.QuadraticArcSegment.prototype.transform=function(e,t){var n=this;e.transformPoints(n.x,n.y,n.cpX,n.cpY,t,n,function(e,t,i,o){n.x=e,n.y=t,n.cpX=i,n.cpY=o})},e.common.QuadraticArcSegment.prototype.trim=function(e,t){var n=.5,i=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,e.x,e.y,n),o=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,e.x,e.y,.1);n=t*(n/i.distanceTo(this.x,this.y)+.1/o.distanceTo(this.x,this.y))/2,i=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,e.x,e.y,n);return this.x=i.x,this.y=i.y,this},e.common.QuadraticArcSegment.prototype.offsetPoint=function(t,n,i,o,a,r,s){return new e.common.Point((1-s)*(1-s)*t+2*(1-s)*s*i+s*s*a,(1-s)*(1-s)*n+2*(1-s)*s*o+s*s*r)},e.common.Size=function(e,t){switch(this.height=this.width=0,arguments.length){case 1:this.width=e.width,this.height=e.height;break;case 2:this.width=e,this.height=t}},e.common.Size.prototype.invert=function(){var e=this.width;return this.width=this.height,this.height=e,this},e.common.Size.prototype.scale=function(e){return this.width*=e,this.height*=e,this},e.common.Size.prototype.getCSS=function(e){return e=void 0!==e?e:"px",{left:this.x+e,top:this.y+e,width:this.width+e,height:this.height+e}},e.common.Size.prototype.cropBySize=function(e){return this.width=Math.min(this.width,e.width),this.height=Math.min(this.height,e.height),this},e.common.Size.prototype.addSize=function(e){return this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height),this},e.common.Size.prototype.validate=function(){if(isNaN(this.width)||isNaN(this.height))throw"Invalid size."},e.common.Thickness=function(e,t,n,i){this.left=e,this.top=t,this.right=n,this.bottom=i},e.common.Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom},e.common.Thickness.prototype.toString=function(e){return e=void 0!==e?e:"px",this.left+e+", "+this.top+e+", "+this.right+e+", "+this.bottom+e},e.common.Vector=function(e,t){switch(this.context=this.to=this.from=null,arguments.length){case 1:this.from=e.from,this.to=e.to;break;case 2:this.from=e,this.to=t}},e.common.Vector.prototype.isNull=function(){return this.from.x==this.to&&this.from.y==this.to.y},e.common.Vector.prototype.length=function(){return this.from.distanceTo(this.to)},e.common.Vector.prototype.equalTo=function(e){return this.from.equalTo(e.from)&&this.to.equalTo(e.to)},e.common.Vector.prototype.getMiddlePoint=function(){return new e.common.Point((this.from.x+this.to.x)/2,(this.from.y+this.to.y)/2)},e.common.Vector.prototype.relateTo=function(e){var t=0,n=this.to.x-this.from.x,i=this.to.y-this.from.y,o=e.to.x-e.from.x;switch((n?8:0)+(i?4:0)+(o?2:0)+((e=e.to.y-e.from.y)?1:0)){case 0:case 1:case 2:case 3:case 4:case 8:case 12:t=1;break;case 5:t=0<i*e?2:3;break;case 10:t=0<n*o?2:3;break;case 15:n/o==i/e&&(t=0<n/o?2:3)}return t},e.common.Vector.prototype.offset=function(e){var t=this.length(),n=(this.to.y-this.from.y)*e/t;e=-(this.to.x-this.from.x)*e/t;this.from.x+=n,this.from.y+=e,this.to.x+=n,this.to.y+=e},e.common.Vector.prototype.getLine=function(){var e=this.from.x,t=this.from.y,n=this.to.x,i=this.to.y;return[i-t,e-n,e*(t-i)+t*(n-e)]},e.common.Vector.prototype.getLineKey=function(){var e=(n=this.getLine())[0],t=n[1],n=n[2];return(n=0!==t?[Math.floor(e/t*1e4),1,Math.floor(n/t*1e4)]:[1,0,Math.floor(n/e*1e4)]).toString()},e.common.Vector.prototype.intersect=function(t){var n,i=this.getLine(),o=t.getLine(),a=new e.common.Matrix(i[0],i[1],o[0],o[1]).determinant();return n=!1,0!==a&&(n=(n=new e.common.Matrix(-i[2],i[1],-o[2],o[1])).determinant(),i=new e.common.Matrix(i[0],-i[2],o[0],-o[2]),o=n/a,a=(i=i.determinant())/a,t.to.x=o,t.to.y=a,this.from.x=o,this.from.y=a,n=!0),n},e.common.Vector.prototype.getIntersectionPoint=function(t,n,i){var o,a=this.getLine(),r=t.getLine(),s=new e.common.Matrix(a[0],a[1],r[0],r[1]).determinant(),l=null;return 0!==s&&(o=(o=new e.common.Matrix(-a[2],a[1],-r[2],r[1])).determinant(),o/=s,s=(a=(a=new e.common.Matrix(a[0],-a[2],r[0],-r[2])).determinant())/s,n?t._contains(o,s,i)&&this._contains(o,s,i)&&(l=new e.common.Point(o,s)):l=new e.common.Point(o,s)),l},e.common.Vector.prototype._contains=function(e,t,n){var i=Math.min(this.from.x,this.to.x),o=Math.min(this.from.y,this.to.y),a=Math.max(this.from.x,this.to.x),r=Math.max(this.from.y,this.to.y);return i-n<=e&&e<=a+n&&o-n<=t&&t<=r+n},e.common.Graphics=function(t){this.m_element=t,this.m_placeholders={},this.m_activePlaceholder=null,this.m_cache=new e.common.Cache,this.graphicsType=null,this.debug=this.hasGraphics=!1,this.layerNames={},e.common.loop(this,e.common.Layers,function(e,t){this.layerNames[t]=e})},e.common.Graphics.prototype.clean=function(){var e,t,n,i;for(e in this.m_cache.clear(),this.m_element=this.m_cache=null,this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e)){for(n in(t=this.m_placeholders[e]).layers)t.layers.hasOwnProperty(n)&&((i=t.layers[n]).canvas.parentNode.removeChild(i.canvas),i.canvas=null);t.layers.length=0,t.activeLayer=null,t.size=null,t.rect=null,t.div=null}this.m_placeholders.length=0,this.m_activePlaceholder=null},e.common.Graphics.prototype.resize=function(e,t,n){null!=(e=this.m_placeholders[e])&&this.resizePlaceholder(e,0,0,t,n)},e.common.Graphics.prototype.position=function(e,t,n,i,o){null!=(e=this.m_placeholders[e])&&this.resizePlaceholder(e,t,n,i,o)},e.common.Graphics.prototype.show=function(t){null!=(t=this.m_placeholders[t])&&e.common.JsonML.applyStyles(t.div,{display:"inherit",visibility:"inherit"})},e.common.Graphics.prototype.hide=function(t){null!=(t=this.m_placeholders[t])&&e.common.JsonML.applyStyles(t.div,{display:"none",visibility:"hidden"})},e.common.Graphics.prototype.resizePlaceholder=function(t,n,i,o,a){var r;for(r in t.size=new e.common.Size(o,a),t.rect=new e.common.Rect(n,i,o,a),e.common.JsonML.applyStyles(t.div,t.rect.getCSS()),t.layers)t.layers.hasOwnProperty(r)&&(-1!==(n=t.layers[r]).name&&e.common.JsonML.applyStyles(n.canvas,{position:"absolute",width:"0px",height:"0px"}))},e.common.Graphics.prototype.begin=function(){this.m_cache.begin()},e.common.Graphics.prototype.end=function(){this.m_cache.end()},e.common.Graphics.prototype.reset=function(e,t){var n="none",i=-1;switch(arguments.length){case 1:"string"==typeof e?n=e:i=e;break;case 2:n=e,i=t}this.m_cache.reset(n,i)},e.common.Graphics.prototype.activate=function(e,t){switch(arguments.length){case 1:"string"==typeof e?(this._activatePlaceholder(e),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(e));break;case 2:this._activatePlaceholder(e),this._activateLayer(t)}return this.m_activePlaceholder},e.common.Graphics.prototype._activatePlaceholder=function(t){var n,i=this.m_placeholders[t];void 0===i&&("none"===t?n=this.m_element:n=0<(i=this.m_element.getElementsByClassName(t)).length?i[0]:this.m_element,(i=new e.common.Placeholder(t)).div=n,i.size=e.common.getInnerSize(n),i.rect=new e.common.Rect(0,0,i.size.width,i.size.height),this.m_placeholders[t]=i),this.m_activePlaceholder=i},e.common.Graphics.prototype._activateLayer=function(t){var n,i,o,a,r=this.m_activePlaceholder.layers[t];if(void 0===r){if(n=this.m_activePlaceholder,-1===t)(r=new e.common.Layer(t)).canvas=n.div;else{for(a in i=e.common.JsonML.toHTML(["div",{style:{position:"absolute",width:"0px",height:"0px"},class:["Layer"+t,"Layer"+this.layerNames[t]]}]),o=null,n.layers)n.layers.hasOwnProperty(a)&&((r=n.layers[a]).name<t&&(o=null!==o?Math.max(o,r.name):r.name));(r=new e.common.Layer(t)).canvas=i,null===o?this.prepend(n.div,r.canvas):this.insertAfter(n.layers[o].canvas,r.canvas)}n.layers[t]=r}this.m_activePlaceholder.activeLayer=r},e.common.Graphics.prototype.prepend=function(e,t){null==e.firstChild?e.appendChild(t):e.insertBefore(t,e.firstChild)},e.common.Graphics.prototype.insertAfter=function(e,t){var n=e.parentNode;n.lastChild==e?n.appendChild(t):n.insertBefore(t,e.nextSibling)},e.common.Graphics.prototype.text=function(t,n,i,o,a,r,s,l,m){var c=this.m_activePlaceholder;s={position:"absolute",padding:0,margin:0,textAlign:this._getTextAlign(s),fontSize:m.fontSize,fontFamily:m.fontFamily,fontWeight:m.fontWeight,fontStyle:m.fontStyle,color:m.fontColor,lineHeight:1},m="";switch(r){case 0:case 3:s.left=t+"px",s.top=n+"px",s.width=i+"px",s.height=o+"px";break;case 1:s.left=t+Math.round(i/2-o/2)+"px",s.top=n+Math.round(o/2-i/2)+"px",s.width=o+"px",s.height=i+"px",m="rotate(-90deg)";break;case 2:s.left=t+Math.round(i/2-o/2)+"px",s.top=n+Math.round(o/2-i/2)+"px",s.width=o+"px",s.height=i+"px",m="rotate(90deg)"}switch(s["-webkit-transform-origin"]="center center",s["-moz-transform-origin"]="center center",s["-o-transform-origin"]="center center",s["-ms-transform-origin"]="center center",s["-webkit-transform"]=m,s["-moz-transform"]=m,s["-o-transform"]=m,s["-ms-transform"]=m,s.transform=m,s.maxWidth=s.width,s.maxHeight=s.height,a=a.replace(RegExp("\n","g"),"<br/>"),l){case 0:this.debug&&(s.border="solid 1px black"),null===(n=this.m_cache.get(c.name,c.activeLayer.name,"text"))?(n=e.common.JsonML.toHTML(["div",{style:s,$:function(e){e.innerHTML=a}}]),c.activeLayer.canvas.appendChild(n),this.m_cache.put(c.name,c.activeLayer.name,"text",n)):(e.common.JsonML.applyStyles(n,s),n.innerHTML=a);break;default:s.borderCollapse="collapse",t={verticalAlign:this._getVerticalAlignment(l),padding:0},this.debug&&(t.border="solid 1px black"),null===(n=this.m_cache.get(c.name,c.activeLayer.name,"textintable"))?(n=e.common.JsonML.toHTML(["table",{style:s},["tbody",["tr",["td",{style:t,$:function(e){e.innerHTML=a}}]]]]),c.activeLayer.canvas.appendChild(n),this.m_cache.put(c.name,c.activeLayer.name,"textintable",n)):(e.common.JsonML.applyStyles(n,s),c=n.getElementsByTagName("td")[0],e.common.JsonML.applyStyles(c,t),c.innerHTML=a)}},e.common.Graphics.prototype._getTextAlign=function(e){var t=null;switch(e){case 0:t="center";break;case 1:t="left";break;case 2:t="right"}return t},e.common.Graphics.prototype._getVerticalAlignment=function(e){var t=null;switch(e){case 1:t="middle";break;case 0:t="top";break;case 2:t="bottom"}return t},e.common.Graphics.prototype.polylinesBuffer=function(e){e.loop(this,function(e){0<e.length()&&this.polyline(e)})},e.common.Graphics.prototype.polyline=function(e){var t=null,n=null,i=e.paletteItem.toAttr();e.loop(this,function(e){switch(e.segmentType){case 1:t=Math.round(e.x)+.5,n=Math.round(e.y)+.5;break;case 0:this.rightAngleLine(t,n,Math.round(e.x)+.5,Math.round(e.y)+.5,i),t=Math.round(e.x)+.5,n=Math.round(e.y)+.5;break;case 4:this.dot(e.x,e.y,e.width,e.height,e.cornerRadius,i)}})},e.common.Graphics.prototype.dot=function(t,n,i,o,a,r){var s=this.m_activePlaceholder,l=this.m_cache.get(s.name,s.activeLayer.name,"dot"),m=void 0!==r.lineWidth&&void 0!==r.borderColor;t={position:"absolute",width:i-(m?1:0),top:Math.round(n),left:Math.round(t),padding:0,margin:0,lineHeight:"0px",overflow:"hidden",height:o-(m?1:0),background:r.fillColor,MozBorderRadius:a,WebkitBorderRadius:a,"-khtml-border-radius":a,borderRadius:a,fontSize:"0px",borderStyle:m?"Solid":"None",borderWidth:m?"1px":"0px",borderColor:m?r.borderColor:""};null===l?(l=e.common.JsonML.toHTML(["div",{style:t}]),s.activeLayer.canvas.appendChild(l),this.m_cache.put(s.name,s.activeLayer.name,"dot",l)):e.common.JsonML.applyStyles(l,t)},e.common.Graphics.prototype.rightAngleLine=function(t,n,i,o,a){var r=this.m_activePlaceholder,s=Math.abs(o-n)>Math.abs(i-t),l=a.lineWidth;a={position:"absolute",top:Math.round(Math.min(n,o)-(s?0:l/2)),left:Math.round(Math.min(t,i)-(s?l/2:0)),padding:0,margin:0,opacity:.5,lineHeight:"0px",overflow:"hidden",background:a.borderColor,fontSize:"0px"};s?(a.width=l,a.height=Math.abs(Math.round(o-n))):(a.width=Math.abs(Math.round(i-t)),a.height=l),null===(t=this.m_cache.get(r.name,r.activeLayer.name,"rect"))?(t=e.common.JsonML.toHTML(["div",{style:a}]),r.activeLayer.canvas.appendChild(t),this.m_cache.put(r.name,r.activeLayer.name,"rect",t)):e.common.JsonML.applyStyles(t,a)},e.common.Graphics.prototype.template=function(t,n,i,o,a,r,s,l,m,c,h,u,d){i=this.m_activePlaceholder,o="template"+(null!==c?c:e.common.hashCode(m));var g,p=0;c=this.m_cache.get(i.name,i.activeLayer.name,o);return null!==d&&void 0!==d.borderWidth&&(p=this.getPxSize(d.borderWidth)),g={width:s-p+"px",height:l-p+"px",top:n+1.5+r+"px",left:t+a+"px"},e.common.mergeObjects(g,d),null==u&&(u=new e.common.RenderEventArgs),u.x=t+a,u.y=n+r,u.width=s-p,u.height=l-p,null==c?(c=this.getElementByTemplate(m),g=e.common.mergeObjects(g,{position:"absolute",padding:"0px",margin:"0px"},d),e.common.JsonML.applyStyles(c,g),u.element=c,u.renderingMode=0,null!==h&&h(null,u),i.activeLayer.canvas.appendChild(c),this.m_cache.put(i.name,i.activeLayer.name,o,c)):(u.element=c,u.renderingMode=1,e.common.JsonML.applyStyles(c,g),null!==h&&h(null,u)),c},e.common.Graphics.prototype.getElementByTemplate=function(t){var n=null;return e.common.isArray(t)?n=e.common.JsonML.toHTML(t):((n=document.createElement("div")).innerHTML=t,n=n.firstChild),n},e.common.Graphics.prototype.getPxSize=function(e,t){var n=e;return"string"==typeof e&&(n=0<e.indexOf("pt")?96*parseInt(e,10)/72:0<e.indexOf("%")?parseFloat(e)/100*t:parseInt(e,10)),n},e.common.Cache=function(){this.threshold=20,this.m_visible={},this.m_invisible={}},e.common.Cache.prototype.begin=function(){var e,t,n,i;for(e in this.m_visible)if(this.m_visible.hasOwnProperty(e))for(t in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(t)){for(n=this.m_visible[e][t].length-1;0<=n;n-=1)(i=this.m_visible[e][t][n]).style.visibility="hidden",this.m_invisible[e][t].push(i);this.m_visible[e][t].length=0}},e.common.Cache.prototype.end=function(){var e,t,n;for(e in this.m_visible)if(this.m_visible.hasOwnProperty(e))for(t in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(t)&&this.m_invisible[e][t].length>this.threshold)for(;void 0!==(n=this.m_invisible[e][t].pop());)n.parentNode.removeChild(n)},e.common.Cache.prototype.reset=function(e,t){e=e+"-"+t;var n,i,o=null;for(n in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(n)){for(i=this.m_visible[e][n].length-1;0<=i;i-=1)o=this.m_visible[e][n][i],this.m_invisible[e][n].push(o),o.style.visibility="hidden";this.m_visible[e][n].length=0}},e.common.Cache.prototype.clear=function(){var e,t,n;for(e in this.m_visible)if(this.m_visible.hasOwnProperty(e))for(t in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(t)){for(;void 0!==(n=this.m_visible[e][t].pop());)n.parentNode.removeChild(n);for(;void 0!==(n=this.m_invisible[e][t].pop());)n.parentNode.removeChild(n)}},e.common.Cache.prototype.get=function(e,t,n){return e=e+"-"+t,t=null,void 0===this.m_visible[e]&&(this.m_visible[e]={},this.m_invisible[e]={}),void 0===this.m_visible[e][n]&&(this.m_visible[e][n]=[],this.m_invisible[e][n]=[]),null!==(t=this.m_invisible[e][n].pop()||null)&&(this.m_visible[e][n].push(t),t.style.visibility="inherit"),t},e.common.Cache.prototype.put=function(e,t,n,i){this.m_visible[e+"-"+t][n].push(i)},e.common.CanvasGraphics=function(t){this.parent=e.common.Graphics.prototype,this.parent.constructor.apply(this,arguments),this.graphicsType=1,this.m_maximum=8e3},e.common.CanvasGraphics.prototype=new e.common.Graphics,e.common.CanvasGraphics.prototype.clean=function(){var e,t,n,i;for(e in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e))for(n in(t=this.m_placeholders[e]).layers)t.layers.hasOwnProperty(n)&&(null!==(i=t.layers[n]).canvascanvas&&(i.canvascanvas.parentNode.removeChild(i.canvascanvas),i.canvascanvas=null));this.parent.clean.apply(this,arguments)},e.common.CanvasGraphics.prototype._activatePlaceholder=function(e){var t,n,i;this.parent._activatePlaceholder.apply(this,arguments),n=(t=this.m_activePlaceholder).size.width,i=t.size.height,t.hasGraphics=!(n>this.m_maximum||i>this.m_maximum)},e.common.CanvasGraphics.prototype.resizePlaceholder=function(e,t,n,i,o){var a,r;for(a in this.parent.resizePlaceholder.apply(this,arguments),e.layers)e.layers.hasOwnProperty(a)&&(null!==(r=e.layers[a]).canvascanvas&&(r.canvascanvas.width=i,r.canvascanvas.height=o))},e.common.CanvasGraphics.prototype.begin=function(){var e,t,n,i,o,a;for(e in this.parent.begin.apply(this),this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e))for(n in o=(t=this.m_placeholders[e]).size.width,a=t.size.height,t.layers)t.layers.hasOwnProperty(n)&&(null!==(i=t.layers[n]).canvascanvas&&i.canvascontext.clearRect(0,0,o,a))},e.common.Graphics.prototype._getContext=function(e,t){var n=e.size.width,i=e.size.height;return null===t.canvascanvas&&(t.canvascanvas=document.createElement("canvas"),t.canvascanvas.width=n,t.canvascanvas.height=i,this.prepend(e.activeLayer.canvas,t.canvascanvas),t.canvascontext=t.canvascanvas.getContext("2d")),t.canvascontext},e.common.CanvasGraphics.prototype.reset=function(e,t){var n,i,o="none",a=-1;switch(arguments.length){case 1:"string"==typeof e?o=e:a=e;break;case 2:o=e,a=t}this.parent.reset.apply(this,arguments),void 0!==(n=this.m_placeholders[o])&&(o=n.size.width,i=n.size.height,void 0!==(a=n.layers[a])&&null!==a.canvascanvas&&a.canvascontext.clearRect(0,0,o,i))},e.common.CanvasGraphics.prototype.polyline=function(e){var t,n,i,o,a=this.m_activePlaceholder,r=e.paletteItem.toAttr();if(a.hasGraphics){if(t=a.activeLayer,(n=this._getContext(a,t)).save(),void 0!==r.lineWidth&&void 0!==r.borderColor?(n.strokeStyle=r.borderColor,n.lineWidth=r.lineWidth):(n.lineWidth=0,n.strokeStyle="Transparent"),null!=r.lineType){switch(a=Math.round(r.lineWidth)||1,r.lineType){case 0:i=[];break;case 1:i=[a,a];break;case 2:i=[5*a,3*a]}void 0!==n.setLineDash?n.setLineDash(i):void 0!==n.webkitLineDash?n.webkitLineDash=i:void 0!==n.mozDash&&(n.mozDash=i)}n.beginPath(),e.loop(this,function(e){switch(e.segmentType){case 1:n.moveTo(Math.round(e.x)+.5,Math.round(e.y)+.5);break;case 0:n.lineTo(Math.round(e.x)+.5,Math.round(e.y)+.5);break;case 4:e.width==e.height&&e.width/2<=e.cornerRadius?(n.moveTo(Math.round(e.x)+e.width+.5,Math.round(e.y)+e.height/2+.5),n.arc(Math.round(e.x)+e.width/2+.5,Math.round(e.y)+e.height/2+.5,Math.round(e.width/2),0,2*Math.PI,!1)):0===e.cornerRadius?(n.moveTo(Math.round(e.x)+.5,Math.round(e.y)+.5),n.lineTo(Math.round(e.x+e.width)+.5,Math.round(e.y)+.5),n.lineTo(Math.round(e.x+e.width)+.5,Math.round(e.y+e.height)+.5),n.lineTo(Math.round(e.x)+.5,Math.round(e.y+e.height)+.5),n.lineTo(Math.round(e.x)+.5,Math.round(e.y)+.5)):(o=Math.min(e.cornerRadius,Math.min(e.width/2,e.height/2)),n.moveTo(Math.round(e.x)+.5,Math.round(e.y+o)+.5),n.arc(Math.round(e.x+o)+.5,Math.round(e.y+o)+.5,Math.round(o),Math.PI,-Math.PI/2,!1),n.lineTo(Math.round(e.x+e.width-o)+.5,Math.round(e.y)+.5),n.arc(Math.round(e.x+e.width-o)+.5,Math.round(e.y+o)+.5,Math.round(o),-Math.PI/2,0,!1),n.lineTo(Math.round(e.x+e.width)+.5,Math.round(e.y+e.height-o)+.5),n.arc(Math.round(e.x+e.width-o)+.5,Math.round(e.y+e.height-o)+.5,Math.round(o),0,Math.PI/2,!1),n.lineTo(Math.round(e.x+o)+.5,Math.round(e.y+e.height)+.5),n.arc(Math.round(e.x+o)+.5,Math.round(e.y+e.height-o)+.5,Math.round(o),Math.PI/2,Math.PI,!1),n.lineTo(Math.round(e.x)+.5,Math.round(e.y+o)+.5));break;case 2:n.quadraticCurveTo(Math.round(e.cpX)+.5,Math.round(e.cpY)+.5,Math.round(e.x)+.5,Math.round(e.y)+.5);break;case 3:n.bezierCurveTo(Math.round(e.cpX1)+.5,Math.round(e.cpY1)+.5,Math.round(e.cpX2)+.5,Math.round(e.cpY2)+.5,Math.round(e.x)+.5,Math.round(e.y)+.5)}}),null!=r.opacity&&(n.globalAlpha=r.opacity),void 0!==r.lineWidth&&n.stroke(),void 0!==r.fillColor&&(n.fillStyle=r.fillColor,n.fill()),n.restore()}else this.parent.polyline.apply(this,arguments)},e.common.Element=function(e,t){switch(this.name=this.ns=null,this.attr={},this.style={},this.children=[],arguments.length){case 1:this.name=e;break;case 2:this.ns=e,this.name=t}},e.common.Element.prototype.setAttribute=function(e,t){this.attr[e]=t},e.common.Element.prototype.appendChild=function(e){this.children[this.children.length]=e},e.common.Element.prototype.create=function(e){var t,n,i=null;i=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name);for(t in this.attr)this.attr.hasOwnProperty(t)&&(void 0!==e?i[t]=this.attr[t]:i.setAttribute(t,this.attr[t]));for(t in this.style)this.style.hasOwnProperty(t)&&(i.style[t]=this.style[t]);for(n=0;n<this.children.length;n+=1)"string"==typeof(t=this.children[n])?i.appendChild(document.createTextNode(t)):i.appendChild(t.create(e));return i},e.common.Element.prototype.update=function(e,t){var n,i,o;for(n in this.style)this.style.hasOwnProperty(n)&&(i=this.style[n],e.style[n]!==i&&(e.style[n]=i));for(n in this.attr)this.attr.hasOwnProperty(n)&&(i=this.attr[n],void 0!==t?e[n]!==i&&(e[n]=i):e.getAttribute(n)!==i&&e.setAttribute(n,i));for(n=this.children.length,i=0;i<n;i+=1)"string"==typeof(o=this.children[i])?e.innerHtml!==o&&(e.innerHtml=o):this.children[i].update(e.children[i],t)},e.common.Layer=function(e){this.name=e,this.svgcanvas=this.canvascanvas=this.canvas=null},e.common.Placeholder=function(e){this.name=e,this.layers={},this.div=this.rect=this.size=this.activeLayer=null,this.hasGraphics=!0},e.common.SvgGraphics=function(t){this.parent=e.common.Graphics.prototype,this.parent.constructor.apply(this,arguments),this._svgxmlns="http://www.w3.org/2000/svg",this.graphicsType=0,this.hasGraphics=!0},e.common.SvgGraphics.prototype=new e.common.Graphics,e.common.SvgGraphics.prototype.clean=function(){var e,t,n,i;for(e in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e))for(n in(t=this.m_placeholders[e]).layers)t.layers.hasOwnProperty(n)&&(null!==(i=t.layers[n]).svgcanvas&&(i.svgcanvas.parentNode.removeChild(i.svgcanvas),i.svgcanvas=null));this.parent.clean.apply(this,arguments)},e.common.SvgGraphics.prototype.resizePlaceholder=function(t,n,i,o,a){var r,s;for(r in this.parent.resizePlaceholder.apply(this,arguments),t.layers)t.layers.hasOwnProperty(r)&&(null!==(s=t.layers[r]).svgcanvas&&(e.common.JsonML.applyStyles(s.svgcanvas,{position:"absolute",width:o+"px",height:a+"px"}),s.svgcanvas.viewBox="0 0 "+o+" "+a))},e.common.SvgGraphics.prototype._getCanvas=function(){var t=this.m_activePlaceholder,n=t.activeLayer,i=t.rect;return null===n.svgcanvas&&(n.svgcanvas=document.createElementNS(this._svgxmlns,"svg"),n.svgcanvas.viewBox=i.x+" "+i.y+" "+i.width+" "+i.height,e.common.JsonML.applyStyles(n.svgcanvas,{width:i.width+"px",height:i.height+"px"}),this.prepend(t.activeLayer.canvas,n.svgcanvas)),n.svgcanvas},e.common.SvgGraphics.prototype.polyline=function(t){var n,i,o,a,r,s=this.m_activePlaceholder,l=t.paletteItem.toAttr();if(n=new e.common.Element(this._svgxmlns,"path"),void 0!==l.fillColor?(n.setAttribute("fill",l.fillColor),n.setAttribute("fill-opacity",l.opacity)):n.setAttribute("fill-opacity",0),void 0!==l.lineWidth&&void 0!==l.borderColor?(n.setAttribute("stroke",l.borderColor),n.setAttribute("stroke-width",l.lineWidth),void 0!==l.opacity?n.setAttribute("stroke-opacity",l.opacity):n.setAttribute("stroke-opacity",1)):(n.setAttribute("stroke","transparent"),n.setAttribute("stroke-width",0)),null!=l.lineType)switch(o=Math.round(l.lineWidth)||1,l.lineType){case 0:n.setAttribute("stroke-dasharray","");break;case 1:n.setAttribute("stroke-dasharray",o+","+o);break;case 2:n.setAttribute("stroke-dasharray",5*o+","+3*o)}i="",t.loop(this,function(e){switch(e.segmentType){case 1:i+="M"+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+.5);break;case 0:i+="L"+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+.5);break;case 2:i+="Q"+(Math.round(e.cpX)+.5)+" "+(Math.round(e.cpY)+.5)+" "+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+.5);break;case 4:e.width==e.height&&e.width/2<=e.cornerRadius?(a=e.width/2,i+="M"+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+e.height/2+.5),i+="A"+a+" "+a+" 0 0 0 "+(Math.round(e.x+e.width)+.5)+" "+(Math.round(e.y)+e.height/2+.5),i+="A"+a+" "+a+" 0 0 0 "+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+e.height/2+.5)):0===e.cornerRadius?(i+="M"+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+.5),i+="L"+(Math.round(e.x+e.width)+.5)+" "+(Math.round(e.y)+.5),i+="L"+(Math.round(e.x+e.width)+.5)+" "+(Math.round(e.y+e.height)+.5),i+="L"+(Math.round(e.x)+.5)+" "+(Math.round(e.y+e.height)+.5),i+="L"+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+.5)):(r=Math.min(e.cornerRadius,Math.min(e.width/2,e.height/2)),i+="M"+(Math.round(e.x)+.5)+" "+(Math.round(e.y+r)+.5),i+="A"+Math.round(r)+" "+Math.round(r)+" 0 0 1 "+(Math.round(e.x+r)+.5)+" "+(Math.round(e.y)+.5),i+="L"+(Math.round(e.x+e.width-r)+.5)+" "+(Math.round(e.y)+.5),i+="A"+Math.round(r)+" "+Math.round(r)+" 0 0 1 "+(Math.round(e.x+e.width)+.5)+" "+(Math.round(e.y+r)+.5),i+="L"+(Math.round(e.x+e.width)+.5)+" "+(Math.round(e.y+e.height-r)+.5),i+="A"+Math.round(r)+" "+Math.round(r)+" 0 0 1 "+(Math.round(e.x+e.width-r)+.5)+" "+(Math.round(e.y+e.height)+.5),i+="L"+(Math.round(e.x+r)+.5)+" "+(Math.round(e.y+e.height)+.5),i+="A"+Math.round(r)+" "+Math.round(r)+" 0 0 1 "+(Math.round(e.x)+.5)+" "+(Math.round(e.y+e.height-r)+.5),i+="L"+(Math.round(e.x)+.5)+" "+(Math.round(e.y+r)+.5));break;case 3:i+="C"+(Math.round(e.cpX1)+.5)+" "+(Math.round(e.cpY1)+.5)+" "+(Math.round(e.cpX2)+.5)+" "+(Math.round(e.cpY2)+.5)+" "+(Math.round(e.x)+.5)+" "+(Math.round(e.y)+.5)}}),n.setAttribute("d",i),null===(t=this.m_cache.get(s.name,s.activeLayer.name,"path"))?(t=n.create(),(n=this._getCanvas()).appendChild(t),this.m_cache.put(s.name,s.activeLayer.name,"path",t)):n.update(t)},e.common.Transform=function(){this.invertVertically=this.invertHorizontally=this.invertArea=!1,this.size=null},e.common.Transform.prototype.setOrientation=function(e){switch(e){case 0:this.invertVertically=this.invertHorizontally=this.invertArea=!1;break;case 1:this.invertHorizontally=this.invertArea=!1,this.invertVertically=!0;break;case 2:this.invertArea=!0,this.invertVertically=this.invertHorizontally=!1;break;case 3:this.invertHorizontally=this.invertArea=!0,this.invertVertically=!1}},e.common.Transform.prototype.getOrientation=function(e){var t=e;if(this.invertHorizontally)switch(e){case 2:t=3;break;case 3:t=2}if(this.invertVertically)switch(e){case 0:t=1;break;case 1:t=0}if(this.invertArea)switch(t){case 0:t=2;break;case 1:t=3;break;case 2:t=0;break;case 3:t=1}return t},e.common.Transform.prototype.transformPoint=function(e,t,n,i,o){var a;n&&this.invertArea&&(a=e,e=t,t=a),this.invertHorizontally&&(e=this.size.width-e),this.invertVertically&&(t=this.size.height-t),!n&&this.invertArea&&(a=e,e=t,t=a),o.call(i,e,t)},e.common.Transform.prototype.transformPoints=function(e,t,n,i,o,a,r){var s;o&&this.invertArea&&(s=e,e=t,t=s,s=n,n=i,i=s),this.invertHorizontally&&(e=this.size.width-e,n=this.size.width-n),this.invertVertically&&(t=this.size.height-t,i=this.size.height-i),!o&&this.invertArea&&(s=e,e=t,t=s,s=n,n=i,i=s),r.call(a,e,t,n,i)},e.common.Transform.prototype.transform3Points=function(e,t,n,i,o,a,r,s,l){var m;r&&this.invertArea&&(m=e,e=t,t=m,m=n,n=i,i=m,m=o,o=a,a=m),this.invertHorizontally&&(e=this.size.width-e,n=this.size.width-n,o=this.size.width-o),this.invertVertically&&(t=this.size.height-t,i=this.size.height-i,a=this.size.height-a),!r&&this.invertArea&&(m=e,e=t,t=m,m=n,n=i,i=m,m=o,o=a,a=m),l.call(s,e,t,n,i,o,a)},e.common.Transform.prototype.transformRect=function(e,t,n,i,o,a,r){var s;o&&this.invertArea&&(s=e,e=t,t=s,s=n,n=i,i=s),this.invertHorizontally&&(e=this.size.width-e-n),this.invertVertically&&(t=this.size.height-t-i),!o&&this.invertArea&&(s=e,e=t,t=s,s=n,n=i,i=s),r.call(a,e,t,n,i)},e.common.ArrayReader=function(t,n,i,o,a){this.itemTemplate=t,this.containsUniqueItems=n,this.uniquePropertyKey=i,this.containsPrimitiveValues=e.common.isNullOrEmpty(i),this.createSourceHash=o,this.isOrdered=a},e.common.ArrayReader.prototype.read=function(t,n,i,o){var a,r,s,l,m,c,h,u=[],d={},g={},p={},f=i+"-seq";for(n&&e.common.isArray(n)||(n=[]),a=o.hash.hasOwnProperty(i)?o.hash[i]:{},r=o.hash.hasOwnProperty(f)?o.hash[f]:{},m=0,c=n.length;m<c;m+=1)s=n[m],l=this.containsUniqueItems?this.containsPrimitiveValues?s:s[this.uniquePropertyKey]:m,d.hasOwnProperty(l)||(h=this.itemTemplate.read(a.hasOwnProperty(l)?a[l]:{},s,i+"-"+m,o),u.push(h),d[l]=h,g[m]=l,this.createSourceHash&&(p[l]=s),this.isOrdered&&r[m]!=g[m]&&(o.isChanged=!0));return o.hash[i]=d,o.hash[f]=g,this.createSourceHash&&(o.sourceHash[i]=p),null!=t&&t.length==u.length||(o.isChanged=!0),u},e.common.EnumerationReader=function(e,t,n){for(var i in this.enumeration=e,this.isNullable=t,this.defaultValue=n,this.hash={},e)this.hash[e[i]]=i},e.common.EnumerationReader.prototype.read=function(e,t,n,i){return null!=t&&this.hash.hasOwnProperty(t)||(t=this.isNullable?null:this.defaultValue),e!==t&&(i.isChanged=!0),t},e.common.FunctionReader=function(){},e.common.FunctionReader.prototype.read=function(e,t){return"function"==typeof t?t:null},e.common.ObjectReader=function(e,t,n){this.dataTemplate=e,this.isNullable=t,this.defaultValue=n},e.common.ObjectReader.prototype.read=function(t,n,i,o){var a,r,s=null,l=e.common.isObject(t);if(n||(n=this.isNullable?null:this.defaultValue),e.common.isObject(n))for(a in s={},this.dataTemplate)this.dataTemplate.hasOwnProperty(a)&&(r=this.dataTemplate[a],s[a]=r.read(l?t[a]:null,n[a],i+"-"+a,o));else s=n,t!==n&&(o.isChanged=!0);return s},e.common.ValueReader=function(e,t,n){for(this.acceptedTypes=e,this.isNullable=t,this.defaultValue=n,this.hash={},t=0;t<e.length;t+=1)this.hash[e[t]]=!0},e.common.ValueReader.prototype.stringify=function(e){if(1==this.hash.object){var t=[];return JSON.stringify(e,function(e,n){return"_"===e[0]?null:null!==n&&"object"==typeof n?-1==t.indexOf(n)?(t.push(n),n):null:n})}return e},e.common.ValueReader.prototype.read=function(e,t,n,i){return null,null!=t&&this.hash.hasOwnProperty(typeof t)||(t=this.isNullable?null:this.defaultValue),n=t,this.stringify(e)!==this.stringify(t)&&(i.isChanged=!0),n},e.famdiagram.EventArgs=function(){this.context=this.oldContext=null,this.parentItems=[],this.childrenItems=[],this.name=this.position=null,this.cancel=!1},e.famdiagram.TemplateConfig=function(){this.name=null,this.isActive=!0,this.itemSize=new e.common.Size(120,100),this.itemBorderWidth=1,this.minimizedItemShapeType=this.itemTemplate=null,this.minimizedItemSize=new e.common.Size(4,4),this.minimizedItemCornerRadius=null,this.minimizedItemLineWidth=1,this.minimizedItemBorderColor=null,this.minimizedItemLineType=0,this.minimizedItemFillColor=null,this.minimizedItemOpacity=1,this.highlightPadding=new e.common.Thickness(2,2,2,2),this.highlightBorderWidth=1,this.highlightTemplate=null,this.cursorPadding=new e.common.Thickness(3,3,3,3),this.cursorBorderWidth=2,this.onButtonsRender=this.buttons=this.cursorTemplate=null},e.famdiagram.BackgroundAnnotationConfig=function(t){var n;switch(this.annotationType=4,this.items=[],this.zOrderType=0,this.offset=new e.common.Thickness(18,18,18,18),this.lineWidth=2,this.opacity=1,this.fillColor=this.borderColor=null,this.lineType=0,this.selectItems=!1,arguments.length){case 1:if(null!==t)if(t instanceof Array)this.items=t;else if("object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}},e.famdiagram.ButtonConfig=function(t,n,i){this.name=t,this.icon=n,this.text=!1,this.label=null,this.tooltip=i,this.size=new e.common.Size(16,16)},e.famdiagram.Config=function(t){this.name=void 0!==t?t:"FamDiagram",this.classPrefix="famdiagram",this.graphicsType=this.navigationMode=0,this.pageFitMode=3,this.minimalVisibility=2,this.orientationType=0,this.verticalAlignment=1,this.arrowsDirection=0,this.showExtraArrows=!0,this.extraArrowsMinimumSpace=30,this.groupByType=2,this.alignBylevels=!0,this.enableMatrixLayout=!1,this.minimumMatrixSize=4,this.maximumColumnsInMatrix=6,this.hideGrandParentsConnectors=!1,this.elbowType=3,this.elbowDotSize=this.bevelSize=4,this.emptyDiagramMessage="Diagram is empty.",this.items=[],this.annotations=[],this.highlightItem=this.cursorItem=null,this.highlightGravityRadius=40,this.selectedItems=[],this.hasSelectorCheckbox=0,this.selectCheckBoxLabel="Selected",this.neighboursSelectionMode=this.selectionPathMode=0,this.templates=[],this.defaultLabelAnnotationTemplate=this.defaultTemplateName=null,this.hasButtons=0,this.buttons=[],this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=this.onButtonsRender=null,this.dotLevelShift=this.normalLevelShift=20,this.normalItemsInterval=this.lineLevelShift=10,this.dotItemsInterval=1,this.lineItemsInterval=2,this.cousinsIntervalMultiplier=5,this.itemTitleFirstFontColor="#ffffff",this.itemTitleSecondFontColor="#000080",this.minimizedItemShapeType=6,this.linesColor="#c0c0c0",this.linesWidth=1,this.linesType=0,this.showNeigboursConnectorsHighlighted=!1,this.highlightLinesColor="#ff0000",this.highlightLinesWidth=1,this.highlightLinesType=0,this.linesPalette=[],this.showCallout=!0,this.calloutMaximumVisibility=2,this.calloutPlacementOffset=100,this.defaultCalloutTemplateName=null,this.calloutfillColor="#000000",this.calloutBorderColor=null,this.calloutCornerRadius=this.calloutOffset=4,this.calloutPointerWidth="10%",this.calloutLineWidth=1,this.calloutOpacity=.2,this.buttonsPanelSize=28,this.checkBoxPanelSize=this.groupTitlePanelSize=24,this.groupTitleOrientation=this.groupTitlePlacementType=2,this.groupTitleVerticalAlignment=1,this.groupTitleHorizontalAlignment=0,this.groupTitleFontSize="12px",this.groupTitleFontFamily="Arial",this.groupTitleColor="#4169e1",this.groupTitleFontStyle=this.groupTitleFontWeight="normal",this.distance=3,this.scale=1,this.minimumScale=.5,this.maximumScale=1,this.showLabels=0,this.labelSize=new e.common.Size(80,24),this.labelOffset=1,this.labelOrientation=0,this.labelPlacement=1,this.labelFontSize="10px",this.labelFontFamily="Arial",this.labelColor="#000000",this.labelFontStyle=this.labelFontWeight="normal",this.enablePanning=!0,this.autoSizeMinimum=new e.common.Size(800,600),this.autoSizeMaximum=new e.common.Size(1024,768)},e.famdiagram.ConnectorAnnotationConfig=function(t,n){var i;switch(this.annotationType=0,this.zOrderType=2,this.toItem=this.fromItem=null,this.connectorPlacementType=this.connectorShapeType=0,this.labelPlacementType=1,this.offset=new e.common.Thickness(0,0,0,0),this.lineWidth=2,this.color="#000000",this.lineType=0,this.selectItems=!0,this.label=null,this.labelSize=new e.common.Size(60,30),arguments.length){case 1:for(i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);break;case 2:this.fromItem=t,this.toItem=n}},e.famdiagram.HighlightPathAnnotationConfig=function(e){var t;switch(this.zOrderType=this.annotationType=2,this.items=[],this.lineWidth=2,this.color="#ff0000",this.lineType=0,this.opacity=1,this.showArrows=!0,this.selectItems=!1,arguments.length){case 1:if(null!==e)if(e instanceof Array)this.items=e;else if("object"==typeof e)for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}},e.famdiagram.ItemConfig=function(e,t,n,i,o){var a;switch(this.id=null,this.parents=[],this.spouses=[],this.relativeItem=null,this.placementType=3,this.context=this.image=this.description=this.title=this.position=null,this.itemTitleColor="#4169e1",this.groupTitle=this.minimizedItemShapeType=null,this.groupTitleColor="#4169e1",this.isActive=!0,this.hasButtons=this.hasSelectorCheckbox=0,this.templateName=null,this.showCallout=0,this.label=this.calloutTemplateName=null,this.showLabel=0,this.labelSize=null,this.labelOrientation=3,this.labelPlacement=0,arguments.length){case 1:for(a in e)e.hasOwnProperty(a)&&(this[a]=e[a]);break;case 5:this.id=e,this.parents=t,this.title=n,this.description=i,this.image=o}},e.famdiagram.LabelAnnotationConfig=function(e,t){var n;switch(this.annotationType=3,this.fromItem=null,this.toItems=[],this.title=null,this.itemTitleColor="#4169e1",this.templateName=null,arguments.length){case 1:for(n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);break;case 2:this.fromItem=e,this.toItem=t}},e.famdiagram.PaletteItemConfig=function(e,t,n){var i;switch(this.lineColor="#c0c0c0",this.lineWidth=1,this.lineType=0,arguments.length){case 1:for(i in e)e.hasOwnProperty(i)&&(this[i]=e[i]);break;case 3:this.lineColor=e,this.lineWidth=t,this.lineType=n}},e.famdiagram.ShapeAnnotationConfig=function(t){var n;switch(this.annotationType=1,this.zOrderType=0,this.items=[],this.shapeType=0,this.offset=new e.common.Thickness(0,0,0,0),this.lineWidth=2,this.cornerRadius="10%",this.opacity=1,this.fillColor=this.borderColor=null,this.lineType=0,this.selectItems=!1,this.label=null,this.labelSize=new e.common.Size(60,30),this.labelPlacement=0,this.labelOffset=4,arguments.length){case 1:if(null!==t)if(t instanceof Array)this.items=t;else if("object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}},e.famdiagram.EdgeItem=function(e,t,n,i){this.values=[t,i],this[e]=0,this[n]=1},e.famdiagram.EdgeItem.prototype.getNear=function(e){return this.values[this[e]]},e.famdiagram.EdgeItem.prototype.getFar=function(e){return this.values[Math.abs(this[e]-1)]},e.famdiagram.EdgeItem.prototype.setNear=function(e,t){this.values[this[e]]=t},e.famdiagram.EdgeItem.prototype.setFar=function(e,t){this.values[Math.abs(this[e]-1)]=t},e.famdiagram.EdgeItem.prototype.toString=function(){return this.parent+","+this.child},e.famdiagram.FamilyItem=function(e){var t;switch(this.itemConfig=this.familyId=this.id=null,this.isActive=this.isVisible=!0,this.isLevelNeutral=!1,this.level=null,this.levelGravity=0,this.hideChildrenConnection=this.hideParentConnection=!1,arguments.length){case 1:for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}},e.famdiagram.Slot=function(e){this.itemId=e,this.position=null,this.balance=0,this.left={},this.right={},this.crossings={}},e.famdiagram.Slot.prototype.clone=function(t){var n,i=new e.famdiagram.Slot(t);for(n in this.left)this.left.hasOwnProperty(n)&&(i.left[n]=this.left[n]);for(n in this.right)this.right.hasOwnProperty(n)&&(i.right[n]=this.right[n]);for(n in this.crossings)this.crossings.hasOwnProperty(n)&&(i.crossings[n]=this.crossings[n]);return i.itemid=t,i},e.famdiagram.LabelAnnotationOptionTask=function(t,n,i){var o=[],a={},r=null,s={},l=new e.common.ArrayReader(new e.common.ObjectReader({zOrderType:new e.common.EnumerationReader(e.common.ZOrderType,!1,i.zOrderType),fromItem:new e.common.ValueReader(["string","number"],!0),toItems:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0),title:new e.common.ValueReader(["string"],!0),itemTitleColor:new e.common.ValueReader(["string"],!1,i.itemTitleColor),templateName:new e.common.ValueReader(["string"],!0)},!1),!1,null,!0);return{process:function(){var e,i,m,c={isChanged:!1,hash:s,sourceHash:{}},h=n.getMaximumId();o=l.read(o,t.getAnnotations(3),"annotations",c),a={};var u=c.sourceHash.annotations;for(e=0,i=o.length;e<i;e+=1)h+=1,(m=o[e]).id=h,a[m.id]=u[e];return r=h,c.isChanged},getAnnotations:function(){return o},getMaximumId:function(){return r},getConfig:function(e){return a[e]}}},e.famdiagram.LabelAnnotationPlacementOptionTask=function(t){var n=[],i={},o=new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["number"],!0),fromItem:new e.common.ValueReader(["string","number"],!0),toItems:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0)}),!0,"id");return{process:function(){var e={isChanged:!1,hash:i};return n=o.read(n,t.getAnnotations(),"annotations",e),e.isChanged},getAnnotations:function(){return n},getMaximumId:function(){return t.getMaximumId()}}},e.famdiagram.LabelAnnotationTemplateOptionTask=function(t,n){var i=[],o={},a=new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["number"],!0),title:new e.common.ValueReader(["string"],!0),itemTitleColor:new e.common.ValueReader(["string"],!1,n.itemTitleColor),templateName:new e.common.ValueReader(["string"],!0)}),!0,"id");return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getAnnotations(),"annotations",e),e.isChanged},getAnnotations:function(){return i}}},e.famdiagram.NeighboursSelectionModeOptionTask=function(t,n){var i={},o=new e.common.ObjectReader({neighboursSelectionMode:new e.common.EnumerationReader(e.common.NeighboursSelectionMode,!1,n.neighboursSelectionMode)});return{process:function(){var e={isChanged:!1};return i=o.read(i,t.getOptions(),"options",e),e.isChanged},getNeighboursSelectionMode:function(){return i.neighboursSelectionMode}}},e.famdiagram.HideGrandParentsConnectorsOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({hideGrandParentsConnectors:new e.common.ValueReader(["boolean"],!1,n.hideGrandParentsConnectors)});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i}}},e.famdiagram.ItemsOptionTask=function(t,n){var i={},o={},a={},r=new e.common.ObjectReader({items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),parents:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0),isActive:new e.common.ValueReader(["boolean"],!1,n.isActive)}),!0,"id",!0)});return{process:function(){var e={isChanged:!1,hash:o,sourceHash:a};return i=r.read(i,t.getOptions(),"options",e),e.isChanged},getItems:function(){return i.items},getConfig:function(e){return a["options-items"][e]}}},e.famdiagram.LinePaletteOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({linesPalette:new e.common.ArrayReader(new e.common.ObjectReader({lineColor:new e.common.ValueReader(["string"],!1,n.lineColor),lineWidth:new e.common.ValueReader(["number"],!1,n.lineWidth),lineType:new e.common.EnumerationReader(e.common.LineType,!1,n.lineType)}),!1)});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i}}},e.famdiagram.NormalizeOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({groupByType:new e.common.EnumerationReader(e.common.GroupByType,!1,n.groupByType),alignBylevels:new e.common.ValueReader(["boolean"],!1,n.alignBylevels)});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i}}},e.famdiagram.OptionsTask=function(e){return{process:function(){return!0},getOptions:e,description:"Raw options."}},e.famdiagram.OrderFamilyNodesOptionTask=function(t,n,i){var o={},a={},r=new e.common.ObjectReader({enableMatrixLayout:new e.common.ValueReader(["boolean"],!1,n.enableMatrixLayout),minimumMatrixSize:new e.common.ValueReader(["number"],!1,n.minimumMatrixSize),maximumColumnsInMatrix:new e.common.ValueReader(["number"],!1,n.maximumColumnsInMatrix),items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),position:new e.common.ValueReader(["number"],!0),relativeItem:new e.common.ValueReader(["string","number"],!0),placementType:new e.common.EnumerationReader(e.common.AdviserPlacementType,!1,i.placementType)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:a};return o=r.read(o,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return o}}},e.famdiagram.SpousesOptionTask=function(t){var n={},i={},o=new e.common.ObjectReader({items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),spouses:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:i};return n=o.read(n,t.getOptions(),"options",e),e.isChanged},getItems:function(){return n.items}}},e.famdiagram.VisualTreeOptionTask=function(){var e={leavesPlacementType:2,childrenPlacementType:2,maximumColumnsInMatrix:6,horizontalAlignment:0};return{process:function(){return!1},getOptions:function(){return e}}},e.famdiagram.CombinedTemplateParamsTask=function(e,t){return{process:function(){return!0},getTemplateParams:function(n){return e.getTemplateParams(n)||t.getTemplateParams(n)}}},e.famdiagram.LabelAnnotationTemplateParamsTask=function(t,n,i){var o={};return{process:function(){var a,r,s=t.getOptions(),l=n.getAnnotations();for(o={},a=0,r=l.length;a<r;a+=1){var m=l[a],c=new e.orgdiagram.TemplateParams,h=i.getTemplate(m.templateName,s.defaultLabelAnnotationTemplate,i.DefaultWidgetLabelAnnotationTemplateName);c.template=h,o[m.id]=c}return!0},getTemplateParams:function(e){return o[e]}}},e.famdiagram.BaseTransformer=function(e){this.debug=e},e.famdiagram.BaseTransformer.prototype.validate=function(e,t){if(!e.validate())throw"Family structure failed to pass validation!";e.loop(this,function(n,i){e.loopChildren(this,n,function(n,o){if(null===o.level||null===i.level||(t?o.level!=i.level+1:o.level<=i.level))throw"Family tree is broken. Children/Parents or levels mismatch!";return e.SKIP})})},e.famdiagram.FamilyBalance=function(){this.properties="title description image itemTitleColor groupTitle groupTitleColor isActive hasSelectorCheckbox hasButtons templateName showCallout calloutTemplateName label showLabel labelSize labelOrientation labelPlacement minimizedItemShapeType".split(" ")},e.famdiagram.FamilyBalance.prototype.balance=function(t){var n={maximumId:null,treeLevels:e.common.TreeLevels(),bundles:[],connectorStacks:[]},i={orgTree:e.common.tree(),maximumId:t.maximumId,orgPartners:{},itemByChildrenKey:{},minimumLevel:null,maximumLevel:null};return this.createOrgTree(t,i),i.orgTree.loopLevels(this,function(e,t,i){n.treeLevels.addItem(i,e,t)}),this.recalcLevelsDepth(n.bundles,n.connectorStacks,n.treeLevels,i.orgTree,i.orgPartners),n.maximumId=i.maximumId,n},e.famdiagram.FamilyBalance.prototype.Family=function(e){this.id=null,this.familyPriority=1,this.childFamilies=[],this.items=[],this.links=[],this.backLinks=[],1==arguments.length&&(this.id=e)},e.famdiagram.FamilyBalance.prototype.FamLink=function(e,t){this.fromItem=e,this.toItem=t},e.famdiagram.FamilyBalance.prototype.createOrgTree=function(t,n){var i,o,a,r,s,l,m,c,h,u,d,g,p,f,T,y,k,v,w,C=[],b=[];if(0<t.logicalFamily.hasNodes()){if(v={},u=0,w=[],t.logicalFamily.loopRoots(this,function(e){d=new this.Family(u),this.extractOrgChart(e,t.logicalFamily,t.defaultItemConfig,n.orgTree,n.orgPartners,n.itemByChildrenKey,v,d),b.push(d),w.push(d),u+=1}),w.sort(function(e,t){var n=e.items[0].level,i=t.items[0].level;return n!=i?n-i:t.items.length-e.items.length}),C=[],h={},0<b.length){for(s=e.common.graph(),i=0,o=b.length;i<o;i+=1)for(a=0,r=(d=b[i]).links.length;a<r;a+=1)l=d.links[a],(m=t.logicalFamily.node(l.fromItem).familyId)!=(c=t.logicalFamily.node(l.toItem).familyId)&&(s.addEdge(m,c,{weight:0}),s.edge(m,c).weight+=1),b[c].backLinks.push(new this.FamLink(l.toItem,l.fromItem));for(;C.length<b.length;)for(i=0,o=w.length;i<o;i+=1)d=w[i],h.hasOwnProperty(d.id)||(null!=(y=s.getSpanningTree(d.id,function(e){return-e.weight})).node(d.id)?(y.loopPostOrder(this,function(e,t,n){t=b[e];var i=b[n],o=[];null!=n&&(i.familyPriority+=t.familyPriority),o=[],y.loopChildren(this,e,function(e){o.push(e)}),o.sort(function(e,t){return b[e].familyPriority-b[t].familyPriority}),y.arrangeChildren(e,o)}),y.loopPreOrder(this,function(e){C.push(e),h[e]=!0})):(C.push(d.id),h[d.id]=!0))}for(n.maximumId+=1,(k=this.createOrgItem(n.orgTree,t.defaultItemConfig,n.maximumId,null,null,n.minimumLevel-1,null)).hideParentConnection=!0,k.hideChildrenConnection=!0,k.title="internal root",k.isVisible=!1,k.isActive=!1,k.childIndex=0,s={},i=0,o=C.length;i<o;i+=1){for(c={},f=k,T=0,r=(d=b[C[i]]).links.concat(d.backLinks),a=0;a<r.length;a+=1)l=r[a],m=n.orgTree.node(l.toItem),n.orgTree.node(l.fromItem),!0===s[m.familyId]&&(g=d.items[0],(p=m).level>=g.level&&n.orgTree.loopParents(this,p.id,function(e,t){if(p=t,t.level<g.level)return!0}),c[p.id]=c.hasOwnProperty(p.id)?c[p.id]+1:1,T<c[p.id]&&(f=p,T=c[p.id]));this.attachFamilyToOrgChart(n,t.defaultItemConfig,f,d),s[d.id]=!0}i=this.getExtraGravity(n),o=this.getGrandChildren(n),this.balanceOrgTree(n.orgTree,i,o,t.itemsPositions,t.itemsGroups)}},e.famdiagram.FamilyBalance.prototype.getGrandChildren=function(e){var t={};return e.orgTree.loopPostOrder(this,function(n,i,o){if(e.minimumLevel=null!=e.minimumLevel?Math.min(e.minimumLevel,i.level):i.level,e.maximumLevel=null!=e.maximumLevel?Math.max(e.maximumLevel,i.level):i.level,null!=o&&(t[o]||(t[o]={}),i=i.level-1,t[o][i]=t[o][i]?t[o][i]+1:1,null!=t[n]))for(i in t[n])t[n].hasOwnProperty(i)&&(t[o][i]=t[o][i]?t[o][i]+t[n][i]:t[n][i])}),t},e.famdiagram.FamilyBalance.prototype.balanceOrgTree=function(t,n,i,o,a){var r,s,l,m,c,h,u,d,g,p,f;t.loopLevels(this,function(T,y){var k,v=e.common.graph(),w={},C=null;if(u=[],t.loopChildren(this,y.id,function(e,i,o){var a;if(null==C&&(C=i),w[i.id]={},n.hasOwnProperty(i.id))for(a in h=n[i.id])if(h.hasOwnProperty(a))for(p=h[a],w[i.id][a]={},r=0,s=p.length;r<s;r+=1)c=p[r],k=c.commonParent==y.id?c.toParent:t.node(c.fromParent).childIndex<t.node(c.toParent).childIndex?"__right__":"__left__",i.id!=k&&(v.addEdge(i.id,k,{weight:0}),v.edge(i.id,k).weight+=1,null==w[i.id][a][k]&&(w[i.id][a][k]=0),w[i.id][a][k]+=1);0<o&&v.addEdge(i.id,C.id,{weight:0})}),null!=C)for(f=[],v.getTotalWeightGrowthSequence(this,function(e){return e.weight},function(e){f.push(e)}),0===f.length&&(f=[C.id]),d=this.balanceItems(f,"__left__","__right__",w,i,o,a),l=0,m=d.length;l<m;l+=1)(g=t.node(d[l])).childIndex=l,u.push(g.id);t.arrangeChildren(y.id,u)})},e.famdiagram.FamilyBalance.prototype.balanceItems=function(t,n,i,o,a,r,s){var l,m,c,h,u,d,g,p,f,T,y,k,v,w,C,b,P,O,S,I,x,A,M=[],L=e.common.LinkedHashItems(),R=0,z={},B={};for(c=[n,null,i],l=0;l<c.length;l+=1)u=c[l],m=R++,(h=new e.famdiagram.Slot(u)).position=l,L.add(m,h),null!==u&&(B[u]=m);for(l=0;l<t.length;l+=1)if((u=t[l])!=n&&u!=i)for(O in c=m=y=T=f=p=g=d=null,s.hasOwnProperty(u)&&(h=s[u],z.hasOwnProperty(h)&&(c=r[u],m=(h=z[h]).previousContext(c),c=h.nextContext(c))),L.iterate(function(e,t){var n,i,r,s;if(null==e.itemId){for(n in b=a[u],C=w=v=k=0,e.crossings)e.crossings.hasOwnProperty(n)&&(b&&null!=b[n]&&(k+=e.crossings[n]*b[n]),C+=e.crossings[n]);for(n in o[u])if(o[u].hasOwnProperty(n))for(i in r=o[u][n])r.hasOwnProperty(i)&&B.hasOwnProperty(i)&&(null!=(s=L.item(B[i]))&&(s.position<e.position?(k+=(e.left[n]||0)-(s.left[n]||0),w+=Math.abs(s.balance+1)):(k+=(e.right[n]||0)-(s.right[n]||0),w+=Math.abs(s.balance-1)),v+=Math.abs(s.position-e.position)));(null==p||p>k||p==k&&(f>v||f==v&&(T>w||T==w&&y>C)))&&(d=t,p=k,g=e,f=v,T=w,y=C)}},m,c),L.insertBefore(d,R++,g.clone(null)),P=B[u]=R,m=g.clone(u),r.hasOwnProperty(u)&&(h=s[u],z.hasOwnProperty(h)||(z[h]=e.common.SortedList()),(h=z[h]).add(r[u],R)),L.insertBefore(d,R++,m),x=m.position=0,L.iterate(function(e,t){var n,i;if(t!=P){for(n in i=a[u])i.hasOwnProperty(n)&&(e.left[n]=e.left[n]?e.left[n]+i[n]:i[n]);x+=1,e.position=x}},P),x=0,L.iterateBack(function(e,t){var n,i;if(t!=P){for(n in i=a[u],a[u])a[u].hasOwnProperty(n)&&(e.right[n]=e.right[n]?e.right[n]+i[n]:i[n]);x-=1,e.position=x}},P),o[u])if(o[u].hasOwnProperty(O))for(I in S=o[u][O])S.hasOwnProperty(I)&&B.hasOwnProperty(I)&&(A=B[I],null!=(h=L.item(A))&&(0>h.position?(h.balance+=1,m.balance-=1,L.iterateBack(function(e,t){t!=P&&t!=A&&(e.crossings[O]=e.crossings[O]?e.crossings[O]+S[I]:S[I])},P,A)):(h.balance-=1,m.balance+=1,L.iterate(function(e,t){t!=P&&t!=A&&(e.crossings[O]=e.crossings[O]?e.crossings[O]+S[I]:S[I])},P,A))));return L.iterate(function(e){null!=(e=e.itemId)&&e!=n&&e!=i&&M.push(e)}),M},e.famdiagram.FamilyBalance.prototype.ExtraGravity=function(e){this.toParent=this.fromParent=this.commonParent=null,this.level=e},e.famdiagram.FamilyBalance.prototype.getExtraGravity=function(e){var t,n,i,o,a,r,s={};for(t in e.orgPartners)if(e.orgPartners.hasOwnProperty(t))for(n=e.orgTree.node(t),i=0,o=(a=e.orgPartners[t]).length;i<o;i+=1)r=e.orgTree.node(a[i]),this.addExtraGravitiesForConnection(e.orgTree,s,r,n);return s},e.famdiagram.FamilyBalance.prototype.addExtraGravitiesForConnection=function(e,t,n,i){var o=new this.ExtraGravity(n.level),a=new this.ExtraGravity(i.level);e.zipUp(this,n.id,i.id,function(e,n,i,r){if(this.addExtraGravityForItem(t,e,o),this.addExtraGravityForItem(t,i,a),n==r)return o.commonParent=n,o.fromParent=e,o.toParent=i,a.commonParent=n,a.fromParent=i,a.toParent=e,!0})},e.famdiagram.FamilyBalance.prototype.addExtraGravityForItem=function(e,t,n){e.hasOwnProperty(t)||(e[t]={}),null==e[t][n.level]&&(e[t][n.level]=[]),e[t][n.level].push(n)},e.famdiagram.FamilyBalance.prototype.attachFamilyToOrgChart=function(e,t,n,i){var o=i.items[0],a=null;for(a=n,n=n.level+1;n<o.level;n+=1)e.maximumId+=1,(a=this.createOrgItem(e.orgTree,t,e.maximumId,a.id,null,n,null)).title="shift",a.isVisible=!1,a.isActive=!1,a.hideParentConnection=!0,a.hideChildrenConnection=!0,i.items.push(a);o.hideParentConnection=!0,e.orgTree.adopt(a.id,o.id,o)},e.famdiagram.FamilyBalance.prototype.extractOrgChart=function(e,t,n,i,o,a,r,s){var l,m,c,h=[];e=t.node(e);for((h=this.createOrgItem(i,n,e.id,null,s.id,e.level,e.itemConfig)).hideParentConnection=!0,h.isVisible=e.isVisible,h.isActive=e.isActive,h.hideParentConnection=e.hideParentConnection,h.hideChildrenConnection=e.hideChildrenConnection,s.items.push(h),r[e.id]=!0,e.familyId=s.id,h=this.extractChildren(e,t,n,i,o,a,r,s);0<h.length;){for(m=[],e=0,l=h.length;e<l;e+=1)c=h[e],m=m.concat(this.extractChildren(c,t,n,i,o,a,r,s));h=m}},e.famdiagram.FamilyBalance.prototype.extractChildren=function(e,t,n,i,o,a,r,s){var l,m=[],c=null,h=null;return 1==t.countChildren(e.id)&&(c=t.firstChild(e.id)),null!=a[c]?(null==o[(h=a[c]).id]&&(o[h.id]=[]),o[h.id].push(e.id),s.links.push(new this.FamLink(e.id,c))):(null!=c&&(a[c]=e),t.loopChildren(this,e.id,function(o,a){if(r[a.id])throw"Many to many relations should not exist at this stage";return m.push(a),(l=this.createOrgItem(i,n,a.id,e.id,s.id,a.level,a.itemConfig)).hideParentConnection=a.hideParentConnection,l.hideChildrenConnection=a.hideChildrenConnection,l.isVisible=a.isVisible,l.isActive=a.isActive,s.items.push(l),r[a.id]=!0,a.familyId=s.id,t.SKIP})),m},e.famdiagram.FamilyBalance.prototype.createOrgItem=function(t,n,i,o,a,r,s){var l=new e.orgdiagram.OrgItem({});for(l.id=i,l.familyId=a,l.level=r,i=0,a=this.properties.length;i<a;i+=1)l[r=this.properties[i]]=null!=s&&void 0!==s[r]?s[r]:n[r];return t.add(o,l.id,l),l},e.famdiagram.FamilyBalance.prototype.recalcLevelsDepth=function(t,n,i,o,a){var r,s,l,m,c,h,u,d,g,p,f,T,y={};i.loopLevels(this,function(k){var v=new e.orgdiagram.TreeLevelConnectorStackSize;if(n[k]=v,g=[],i.loopLevelItems(this,k,function(n,i){var l,m=[],c=[];if(!y.hasOwnProperty(n)){if(y[n]=!0,i.hideChildrenConnection||m.push(n),null!=(l=a[n]))for(r=0,s=l.length;r<s;r+=1){var h=l[r];y[h]=!0,m.push(h)}o.loopChildren(this,n,function(e,t){t.hideParentConnection||c.push(e)}),(1<m.length||0<c.length)&&(d=new e.common.VerticalConnectorBundle(m,c),t.push(d),1<m.length&&g.push(d))}}),0<g.length){for(T=e.common.pile(),l=0,m=g.length;l<m;l+=1){for(d=g[l],f=p=null,c=0,h=d.fromItems.length;c<h;c+=1)u=i.getItemPosition(d.fromItems[c]),p=null!=p?Math.min(p,u):u,f=null!=f?Math.max(f,u):u;T.add(p,f,d)}v.parentsStackSize=T.resolve(this,function(e,t,n,i,o){n.fromOffset=i+1,n.fromStackSize=o})}})},e.famdiagram.FamilyMatrixesExtractor=function(t){this.parent=e.famdiagram.BaseTransformer.prototype,this.parent.constructor.apply(this,arguments)},e.famdiagram.FamilyMatrixesExtractor.prototype=new e.famdiagram.BaseTransformer,e.famdiagram.FamilyMatrixesExtractor.prototype.extract=function(t,n,i,o,a,r){return 0<n.hasNodes()&&t.enableMatrixLayout&&n.groupBy(this,Math.max(2,t.minimumMatrixSize),function(s,l,m,c){var h=r+=1,u=r+=1,d=n.node(m[0]);d=new e.famdiagram.FamilyItem({id:h,level:d.level,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+h,description:"This is item used as aggregator of matrixed nodes."},levelGravity:1,hideParentConnection:!0,hideChildrenConnection:!0});o[h]=u;for(var g=0,p=m.length;g<p;g+=1)n.removeNode(m[g]);null!=s?(n.add([s],h,d),d.hideParentConnection=!1,a.push(new e.common.MatrixConnectorBundle(!0,m,h,h,this.getMatrixWidth(t.maximumColumnsInMatrix,m.length)))):n.add(null,h,d),null!=l&&(n.adopt([h],l),d.hideChildrenConnection=!1,a.push(new e.common.MatrixConnectorBundle(!1,m,h,u,this.getMatrixWidth(t.maximumColumnsInMatrix,m.length)))),i[h]=c}),r},e.famdiagram.FamilyMatrixesExtractor.prototype.getMatrixWidth=function(e,t){return Math.min(e,Math.ceil(Math.sqrt(t)))},e.famdiagram.FamilyNormalizer=function(t){this.parent=e.famdiagram.BaseTransformer.prototype,this.parent.constructor.apply(this,arguments)},e.famdiagram.FamilyNormalizer.prototype=new e.famdiagram.BaseTransformer,e.famdiagram.FamilyNormalizer.prototype.normalize=function(t,n,i){if(0<n.hasNodes()){if(n.loopLevels(this,1==t.groupByType,function(e,t,n){t.level=n}),n.optimizeReferences(function(){return i+=1,new e.famdiagram.FamilyItem({id:i,isVisible:!1,isActive:!1,itemConfig:{title:"bundle #"+i,description:" This item was created by references optimizer."},levelGravity:2})}),this.debug&&!n.validate())throw"References are broken in family structure!";if(this.debug&&n.hasLoops())throw"Structure has loops!";if(n.eliminateManyToMany(function(){return i+=1,new e.famdiagram.FamilyItem({id:i,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+i,description:"This is item used to eliminate M:M relations."},levelGravity:2,hideParentConnection:!1,hideChildrenConnection:!1})}),this.debug&&!n.validate())throw"References are broken in family structure!";t.alignBylevels?this.resortItemsBylevels(n):n.loopLevels(this,1==t.groupByType,function(e,t,n){t.level=n}),this.debug&&this.validate(n,!1),this.fillInItems(n,function(){return i+=1,new e.famdiagram.FamilyItem({id:i,levelGravity:2,isVisible:!1,isActive:!1,itemConfig:{title:"extension #"+i,description:"This is item used to fill gaps in levels."}})}),this.debug&&this.validate(n,!0)}return i},e.famdiagram.FamilyNormalizer.prototype.resortItemsBylevels=function(e){var t,n,i=[],o=null,a=null;for(e.loop(this,function(e,t){t.originalLevel=t.level,t.level=null,null!=t.originalLevel&&(i[t.originalLevel]||(i[t.originalLevel]={}),i[t.originalLevel][e]=t,o=null!=o?Math.min(t.originalLevel,o):t.originalLevel,a=null!=a?Math.max(t.originalLevel,a):t.originalLevel)}),t=o;t<=a;t+=1)n=i[t],this.setLevelsForItems(n,e);e.loopTopo(this,function(t,n){var i;1==n.levelGravity&&(i=null,e.loopParents(this,t,function(t,n){return i=null==i?n.level+1:Math.max(n.level+1,i),e.SKIP}),n.level=i||n.level)})},e.famdiagram.FamilyNormalizer.prototype.setLevelsForItems=function(t,n){var i,o,a,r=0;for(i in t)t.hasOwnProperty(i)&&n.loopParents(this,i,function(e,t){return r=Math.max(t.level+1,r),n.SKIP});for(i in t)t.hasOwnProperty(i)&&((o=t[i]).level=r);for(;!e.common.isEmptyObject(t);){for(i in a={},t)t.hasOwnProperty(i)&&(o=t[i],n.loopChildren(this,i,function(e,t){return(null==t.originalLevel||t.isLevelNeutral)&&(t.level=null==t.level?o.level+1:Math.max(t.level,o.level+1),a[e]=t),n.SKIP}));t=a}},e.famdiagram.FamilyNormalizer.prototype.fillInItems=function(e,t){var n;e.loop(this,function(i,o){for(var a,r=!0;r;)r=!1,a=[],e.loopParents(this,i,function(t,n){return o.level-1>n.level&&a.push(t),e.SKIP}),1<a.length&&((n=t(o)).level=o.level-1,n.hideParentConnection=!1,n.hideChildrenConnection=!1,e.bundleParents(i,a,n.id,n),r=!0,i=n.id,o=n)}),e.loop(this,function(i,o){for(var a,r=!0,s=!0;r;)r=!1,a=[],e.loopChildren(this,i,function(t,n){return o.level+1<n.level?a.push(t):s=!1,e.SKIP}),1<a.length&&((n=t(o)).level=o.level+1,s&&(n.hideParentConnection=!1,n.hideChildrenConnection=!1),e.bundleChildren(i,a,n.id,n),r=!0,i=n.id,o=n)}),e.loop(this,function(i,o){for(var a,r=!0;r;)r=!1,a=[],e.loopParents(this,i,function(t,n){return o.level-1>n.level&&a.push(t),e.SKIP}),0<a.length&&((n=t(o)).level=o.level-1,n.hideParentConnection=!1,n.hideChildrenConnection=!1,e.bundleParents(i,a,n.id,n),r=!0,i=n.id,o=n)})},e.famdiagram.UserDefinedNodesOrder=function(){},e.famdiagram.UserDefinedNodesOrder.prototype.getUserDefinedPositions=function(t){function n(e,t){this.position=e,this.items=t}var i,o,a,r=e.common.tree(),s={};for(o=0,a=t.length;o<a;o+=1)null!=(i=t[o]).relativeItem&&(s[i.relativeItem]=!0),null!=i.id&&(s[i.id]=!0);for(o=0,a=t.length;o<a;o+=1)i=t[o],s.hasOwnProperty(i.id)&&r.add(i.relativeItem||null,i.id,i);var l={},m={},c={};for(var h in r.loopPostOrder(this,function(e,t,i){var o,a=[],r=m[e],s=c[e];if(null!=r)for(r.sort(function(e,t){return t.position-e.position}),o=0;o<r.length;o+=1)a=a.concat(r[o].items);if(a.push(e),null!=s)for(s.sort(function(e,t){return e.position-t.position}),o=0;o<s.length;o+=1)a=a.concat(s[o].items);null!=i?2==t.placementType?(m.hasOwnProperty(i)||(m[i]=[]),m[i].push(new n(t.position,a))):(c.hasOwnProperty(i)||(c[i]=[]),c[i].push(new n(t.position,a))):l[e]=a}),i={},a={},l)if(l.hasOwnProperty(h))for(t=l[h],o=0;o<t.length;o+=1)i[r=t[o]]=o,a[r]=h;return{position:i,group:a}},e.common.BaseLayout=function(e,t){if(this._children={},null!=this.params)for(var n in this.params)this.params.hasOwnProperty(n)&&e.hasOwnProperty(n)&&(this.params[n]=e[n]);if(null!=this.options){for(n in this.options)this.options.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(this.options[n]=t[n]);this.options.shifts=this.getShifts(this.options),this.options.intervals=this.getIntervals(this.options)}},e.common.BaseLayout.prototype.add=function(e,t){this._children[e]=t},e.common.BaseLayout.prototype.getLayout=function(e){return this._children[e]||null},e.common.BaseLayout.prototype.getShifts=function(e){var t=[];return t[1]=e.normalLevelShift,t[2]=e.dotLevelShift,t[3]=e.lineLevelShift,t[4]=e.lineLevelShift,t},e.common.BaseLayout.prototype.getIntervals=function(e){var t=[];return t[1]=e.normalItemsInterval,t[2]=e.dotItemsInterval,t[3]=e.lineItemsInterval,t[4]=e.lineItemsInterval,t},e.common.BaseLayout.prototype.getItemSize=function(t,n,i,o){var a,r;switch(t){case 1:if(t=i.template.templateConfig,a=new e.common.Size(t.itemSize),r=new e.common.Rect(0,0,a.width,a.height),n&&(a.height+=t.cursorPadding.top+t.cursorPadding.bottom,a.width+=t.cursorPadding.left+t.cursorPadding.right,r.x=t.cursorPadding.left,r.y=t.cursorPadding.top),i.hasSelectorCheckbox&&(a.height+=o.checkBoxPanelSize),i.hasButtons)switch(a.width+=o.buttonsPanelSize,o.groupTitlePlacementType){case 3:r.x+=o.buttonsPanelSize}if(i.hasGroupTitle)switch(a.width+=o.groupTitlePanelSize,o.groupTitlePlacementType){case 3:break;default:r.x+=o.groupTitlePanelSize}break;case 2:t=i.template.templateConfig,a=new e.common.Size(t.minimizedItemSize);break;case 3:case 4:a=new e.common.Size}switch(o.orientationType){case 2:case 3:a.invert()}return{actualSize:a,contentPosition:r}},e.famdiagram.FamilyLayout=function(t,n){this.params={logicalFamily:null,treeLevels:null,getConnectorsStacksSizes:null,isItemSelected:null,cursorItemId:null,getTemplateParams:null},this.options={verticalAlignment:1,pageFitMode:0,minimalVisibility:2,orientationType:0,arrowsDirection:0,linesWidth:1,checkBoxPanelSize:24,buttonsPanelSize:28,groupTitlePanelSize:24,groupTitlePlacementType:2,normalLevelShift:20,dotLevelShift:20,lineLevelShift:20,normalItemsInterval:10,dotItemsInterval:1,lineItemsInterval:2},this.data={treeItemsPositions:{},treeLevelsPositions:[]},this.parent=e.common.BaseLayout.prototype,this.parent.constructor.apply(this,arguments)},e.famdiagram.FamilyLayout.prototype=new e.common.BaseLayout,e.famdiagram.FamilyLayout.prototype.measure=function(t){var n,i,o=new e.common.Rect(0,0,0,0),a={treeItemsPositions:{},treeLevelsPositions:[]};switch(this.options.orientationType){case 2:case 3:t.invert()}if(!this.params.treeLevels.isEmpty())switch(this.options.pageFitMode){case 0:case e.common.PageFitMode.PrintPreview:case 5:n=[new e.orgdiagram.LevelVisibility(0,1)],o=this.setTreeLevelsVisibilityAndPositionTreeItems(a,this.params,this.options,n,0);break;default:n=this.getLevelVisibilities(this.params.treeLevels,this.options.minimalVisibility),i=this.setTreeLevelsVisibilityAndPositionTreeItems(a,this.params,this.options,n,n.length-1),this.checkDiagramSize(i,t,this.options.pageFitMode)?(i.addRect(t),i.offset(0,0,5,5),this.findOptimalSize(this,n.length-1,function(e){return o=this.setTreeLevelsVisibilityAndPositionTreeItems(a,this.params,this.options,n,e),this.checkDiagramSize(o,i,this.options.pageFitMode)})):o=i}return this.data=a,o},e.famdiagram.FamilyLayout.prototype.getLevelVisibilities=function(t,n){var i=[new e.orgdiagram.LevelVisibility(0,1)],o=[];switch(n){case 2:o.push(2);break;case 0:case 3:case 4:o.push(2),o.push(3)}return t.loopLevelsReversed(this,function(t){for(var n=0;n<o.length;n+=1)i.push(new e.orgdiagram.LevelVisibility(t,o[n]))}),i},e.famdiagram.FamilyLayout.prototype.findOptimalSize=function(e,t,n){var i,o=0;if(!n.call(e,o)){for(i=t;1<t-o;)i=Math.floor((t+o)/2),n.call(e,i)?t=i:o=i;t!==i&&n.call(e,t)}},e.famdiagram.FamilyLayout.prototype.setTreeLevelsVisibilityAndPositionTreeItems=function(t,n,i,o,a){var r,s;for(t.treeLevelsPositions=[],n.treeLevels.loopLevels(this,function(){var n=new e.orgdiagram.TreeLevelPosition;n.currentvisibility=1,t.treeLevelsPositions.push(n)}),r=0;r<=a;r+=1)s=o[r],t.treeLevelsPositions[s.level].currentvisibility=s.currentvisibility;return t.treeItemsPositions={},this.recalcItemsSize(n.treeLevels,t.treeItemsPositions,t.treeLevelsPositions,n.isItemSelected,n.cursorItemId,n.getTemplateParams,i),this.setOffsets(n.treeLevels,t.treeItemsPositions,t.treeLevelsPositions,n.logicalFamily,i.intervals),this.recalcLevelsDepth(n.treeLevels,t.treeItemsPositions,t.treeLevelsPositions,i.verticalAlignment),this.shiftLevels(t.treeLevelsPositions,i.shifts[3],i.shifts,i.arrowsDirection,i.linesWidth,n.getConnectorsStacksSizes),this.getLayoutSize(n.treeLevels,t.treeItemsPositions,t.treeLevelsPositions)},e.famdiagram.FamilyLayout.prototype.checkDiagramSize=function(e,t,n){var i=!1;switch(n){case 1:t.width>=e.width&&(i=!0);break;case 2:t.height>=e.height&&(i=!0);break;case 3:t.height>=e.height&&t.width>=e.width&&(i=!0)}return i},e.famdiagram.FamilyLayout.prototype.getLayoutSize=function(t,n,i){return new e.common.Rect(0,0,Math.round(this.getLayoutWidth(t,n)),Math.round(this.getLayoutHeight(i)))},e.famdiagram.FamilyLayout.prototype.getLayoutWidth=function(e,t){var n=0;return e.loopLevels(this,function(i){var o=e.getLevelLength(i);0<o&&(i=e.getItemAtPosition(i,o-1),i=t[i],n=Math.max(n,i.offset+i.actualSize.width+i.rightPadding))}),n},e.famdiagram.FamilyLayout.prototype.getLayoutHeight=function(e){return(e=e[e.length-1]).shift+e.nextLevelShift},e.famdiagram.FamilyLayout.prototype.recalcItemsSize=function(t,n,i,o,a,r,s){t.loopLevels(this,function(l){var m=i[l];t.loopLevelItems(this,l,function(t,i){var l=new e.orgdiagram.TreeItemPosition;if(null==(h=this.getLayout(t))){var c=o(t)?1:i.isVisible?0:4,h=r(t);c=0===c?m.currentvisibility:c,h=this.getItemSize(c,a==t,h,s);l.actualVisibility=c,l.actualSize=h.actualSize,l.contentPosition=h.contentPosition}else h=h.measure(m.currentvisibility),l.actualVisibility=4,l.actualSize=h;n[t]=l})})},e.famdiagram.FamilyLayout.prototype.recalcLevelsDepth=function(e,t,n,i){var o,a;e.loopLevels(this,function(r){var s=n[r];switch(s.shift=0,s.depth=0,s.actualVisibility=4,a=o=null,e.loopLevelItems(this,r,function(e){switch(e=t[e],s.depth=Math.max(s.depth,e.actualSize.height),e.actualVisibility){case 2:case 3:case 4:a=a?Math.min(a,e.actualSize.height):e.actualSize.height;break;default:o=o?Math.min(o,e.actualSize.height):e.actualSize.height}s.actualVisibility=Math.min(s.actualVisibility,e.actualVisibility)}),null==o&&(o=s.depth),null!=a&&a>o&&(o=a),i){case 0:s.horizontalConnectorsDepth=o/2;break;case 1:s.horizontalConnectorsDepth=s.depth/2;break;case 2:s.horizontalConnectorsDepth=s.depth-o/2}})},e.famdiagram.FamilyLayout.prototype.shiftLevels=function(e,t,n,i,o,a){var r,s,l=0,m=0;o*=8;switch(i){case 1:l=o,m=0;break;case 2:l=0,m=o}for(i=0,o=e.length;i<o;i+=1)r=e[i],s=a(i),t+=r.setShift(t,n[r.actualVisibility],m,l,s.parentsStackSize)},e.famdiagram.FamilyLayout.prototype.setOffsets=function(t,n,i,o,a){var r,s;for(r=0,s=i.length;r<s;r+=1)i[r].currentOffset=0;i=o.getPlanarFamily(t);var l=new e.common.FamilyAlignment(this,i,t,function(e){e=n[e];var t=a[e.actualVisibility]/2;return e.leftPadding=t,e.rightPadding=t,e.leftPadding+e.actualSize.width+e.rightPadding}),m=null;t.loopLevels(this,function(e){if(null!=(e=t.getItemAtPosition(e,0))){var i=n[e];e=l.getOffset(e)-i.leftPadding-i.actualSize.width/2;m=null==m?e:Math.min(m,e)}}),t.loopLevels(this,function(e){t.loopLevelItems(this,e,function(e){var t=n[e];e=l.getOffset(e);t.offset=e-t.actualSize.width/2,t.offset-=m})})},e.famdiagram.FamilyLayout.prototype.arrange=function(e,t){var n=null;null!=t&&this.params.treeLevels.loopLevels(this,function(i){var o=this.data.treeLevelsPositions[i];this.params.treeLevels.loopLevelItems(this,i,function(i){var a=this.data.treeItemsPositions[i],r=this.getItemPosition(a.actualVisibility,a.offset,a.actualSize,n,o,this.options.verticalAlignment);a.actualPosition=r.position,a.horizontalConnectorsShift=r.horizontalConnectorsShift,a.topConnectorShift=r.topConnectorShift,a.topConnectorInterval=r.topConnectorInterval,a.bottomConnectorShift=r.bottomConnectorShift,a.bottomConnectorInterval=r.bottomConnectorInterval,t.call(e,i,a),null!=(i=this.getLayout(i))&&i.arrange(e,r.position,t)}),n=o})},e.famdiagram.FamilyLayout.prototype.getItemPosition=function(t,n,i,o,a,r){var s=0;switch(t){case 1:switch(r){case 0:s=0;break;case 1:s=(a.depth-i.height)/2;break;case 2:s=a.depth-i.height}break;case 2:case 3:case 4:s=a.horizontalConnectorsDepth-i.height/2}return{position:new e.common.Rect(n,a.shift+s,i.width,i.height),horizontalConnectorsShift:a.shift+a.horizontalConnectorsDepth,topConnectorShift:null!=o?o.shift+o.connectorShift:null,topConnectorInterval:null!=o?o.levelSpace/2:null,bottomConnectorShift:a.shift+a.connectorShift,bottomConnectorInterval:a.levelSpace/2}},e.famdiagram.MatrixLayout=function(t,n){this.params={items:[],isItemSelected:null,cursorItemId:null,getTemplateParams:null,hideParentConnection:!1,hideChildrenConnection:!1},this.options={verticalAlignment:1,orientationType:0,arrowsDirection:0,linesWidth:1,checkBoxPanelSize:24,buttonsPanelSize:28,groupTitlePanelSize:24,groupTitlePlacementType:2,normalLevelShift:20,dotLevelShift:20,lineLevelShift:20,normalItemsInterval:10,dotItemsInterval:1,lineItemsInterval:2,maximumColumnsInMatrix:6},this.data={treeItemsPositions:{},columns:[],rows:[]},this.parent=e.common.BaseLayout.prototype,this.parent.constructor.apply(this,arguments)},e.famdiagram.MatrixLayout.prototype=new e.common.BaseLayout,e.famdiagram.MatrixLayout.prototype.Column=function(){this.rightPadding=this.leftPadding=this.offset=this.depth=0},e.famdiagram.MatrixLayout.prototype.Row=function(){this.horizontalConnectorsDepth=this.offset=this.depth=0,this.dotsDepth=this.minimalDepth=null},e.famdiagram.MatrixLayout.prototype.getMatrixWidth=function(e,t){return Math.min(e,Math.ceil(Math.sqrt(t)))},e.famdiagram.MatrixLayout.prototype.measure=function(e){var t={treeItemsPositions:{},columns:[],rows:[]};return this.measureItems(t,this.params,this.options,e),this.measureColumns(t,this.params,this.options),this.measureRows(t,this.params,this.options),this.data=t,this.getLayoutSize(t)},e.famdiagram.MatrixLayout.prototype.measureItems=function(t,n,i,o){for(var a=0,r=n.items.length;a<r;a+=1){var s=(c=n.items[a]).id,l=new e.orgdiagram.TreeItemPosition,m=n.isItemSelected(s)?1:c.isVisible?0:4,c=n.getTemplateParams(s);m=0===m?o:m,c=this.getItemSize(m,n.cursorItemId==s,c,i);l.actualVisibility=m,l.actualSize=c.actualSize,l.contentPosition=c.contentPosition,t.treeItemsPositions[s]=l}},e.famdiagram.MatrixLayout.prototype.measureColumns=function(e,t,n){var i,o,a,r=this.getMatrixWidth(n.maximumColumnsInMatrix,t.items.length);for(o=0,a=t.items.length;o<a;o+=1){var s=e.treeItemsPositions[t.items[o].id];i=n.intervals[s.actualVisibility]/2,s.leftPadding=i,s.rightPadding=i;var l=o%r;null==(i=e.columns[l])&&(i=new this.Column,e.columns[l]=i),i.depth=Math.max(i.depth,s.leftPadding+s.actualSize.width+s.rightPadding)}for(r=8*n.linesWidth,o=s=0,a=e.columns.length;o<a;o+=1){if(i=e.columns[o],0==o%2)switch(n.arrowsDirection){case 1:i.leftPadding=t.hideChildrenConnection?0:r,i.rightPadding=0;break;case 2:i.leftPadding=0,i.rightPadding=t.hideParentConnection?0:r}else switch(n.arrowsDirection){case 1:i.leftPadding=0,i.rightPadding=t.hideChildrenConnection?0:r;break;case 2:i.leftPadding=t.hideParentConnection?0:r,i.rightPadding=0}i.offset=s+i.leftPadding+i.depth/2,s=i.offset+i.depth/2+i.rightPadding}},e.famdiagram.MatrixLayout.prototype.measureRows=function(e,t,n){var i,o,a,r=this.getMatrixWidth(n.maximumColumnsInMatrix,t.items.length);for(i=0,o=t.items.length;i<o;i+=1){var s=e.treeItemsPositions[t.items[i].id],l=Math.floor(i/r),m=n.shifts[s.actualVisibility]/2;switch(null==(a=e.rows[l])&&(a=new this.Row,e.rows[l]=a),a.depth=Math.max(a.depth,m+s.actualSize.height+m),s.actualVisibility){case 2:case 3:case 4:a.dotsDepth=a.dotsDepth?Math.min(a.dotsDepth,s.actualSize.height):s.actualSize.height;break;default:a.minimalDepth=a.minimalDepth?Math.min(a.minimalDepth,s.actualSize.height):s.actualSize.height}}for(i=t=0,o=e.rows.length;i<o;i+=1)switch(a=e.rows[i],a.offset=t+a.depth/2,t=a.offset+a.depth/2,null==a.minimalDepth&&(a.minimalDepth=a.depth),null!=a.dotsDepth&&a.dotsDepth>a.minimalDepth&&(a.minimalDepth=a.dotsDepth),n.verticalAlignment){case 0:a.horizontalConnectorsDepth=a.minimalDepth/2;break;case 1:a.horizontalConnectorsDepth=a.depth/2;break;case 2:a.horizontalConnectorsDepth=a.depth-a.minimalDepth/2}},e.famdiagram.MatrixLayout.prototype.getLayoutSize=function(t){return new e.common.Rect(0,0,Math.round(this.getLayoutWidth(t)),Math.round(this.getLayoutHeight(t)))},e.famdiagram.MatrixLayout.prototype.getLayoutWidth=function(e){var t=0,n=e.columns.length;return 0<n&&(t=(e=e.columns[n-1]).offset+e.depth/2+e.rightPadding),t},e.famdiagram.MatrixLayout.prototype.getLayoutHeight=function(e){var t=0,n=e.rows.length;return 0<n&&(t=(e=e.rows[n-1]).offset+e.depth/2),t},e.famdiagram.MatrixLayout.prototype.arrange=function(e,t,n){if(null!=n)for(var i=this.getMatrixWidth(this.options.maximumColumnsInMatrix,this.params.items.length),o=0,a=this.params.items.length;o<a;o+=1){var r=this.params.items[o].id,s=this.data.columns[o%i],l=this.data.rows[Math.floor(o/i)],m=this.data.treeItemsPositions[r],c=this.getItemPosition(m.actualVisibility,s,l,m.actualSize,this.options);c.translate(t.x,t.y),m.actualPosition=c,m.horizontalConnectorsShift=t.y+l.offset-l.depth/2+l.horizontalConnectorsDepth,m.leftMedianOffset=s.depth/2+s.leftPadding,m.rightMedianOffset=s.depth/2+s.rightPadding,m.topConnectorShift=l.depth/2,m.bottomConnectorShift=l.depth/2,n.call(e,r,m)}},e.famdiagram.MatrixLayout.prototype.getItemPosition=function(t,n,i,o,a){var r=0;switch(t){case 1:switch(a.verticalAlignment){case 0:r=0;break;case 1:r=(i.depth-o.height)/2;break;case 2:r=i.depth-o.height}break;case 2:case 3:case 4:r=i.horizontalConnectorsDepth-o.height/2}return new e.common.Rect(n.offset-o.width/2,i.offset-i.depth/2+r,o.width,o.height)},e.famdiagram.CursorNeighboursTask=function(t,n,i,o){var a=[],r={},s=new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:r},l=t.getCursorTreeItem(),m=i.getNavigationFamily(),c=n.getNeighboursSelectionMode(),h=o.getActiveItems();return a=s.read(a,function(e,t,n,i){var o=[],a={};if(null!==e)switch(t){case 0:n.loopParents(this,e,function(e){if(a.hasOwnProperty(e)||(a[e]=!0,o.push(e)),i.hasOwnProperty(e))return n.SKIP}),n.loopChildren(this,e,function(e){if(a.hasOwnProperty(e)||(a[e]=!0,o.push(e)),i.hasOwnProperty(e))return n.SKIP});break;case 1:n.loopNeighbours(this,e,function(e){if(a.hasOwnProperty(e)||(a[e]=!0,o.push(e)),i.hasOwnProperty(e))return!0})}return o}(l,c,m,h),"items",e),e.isChanged},getItems:function(){return a}}},e.famdiagram.AddLabelAnnotationsTask=function(t,n){function i(t,n){var i,o,a,r,s=e.common.graph(),l={};if(0<n.length){for(r=0,i=n.length;r<i;r+=1)o=n[r],l.hasOwnProperty(o.fromItem)?l[o.fromItem].push(o):(l[o.fromItem]=[o],t.loopChildren(this,o.fromItem,function(n){return s.addEdge(o.fromItem,n,new e.famdiagram.EdgeItem(o.fromItem,o.fromItem,n,n)),t.SKIP}),t.loopParents(this,o.fromItem,function(n){return s.addEdge(n,o.fromItem,new e.famdiagram.EdgeItem(n,n,o.fromItem,o.fromItem)),t.SKIP}));for(a in l)if(l.hasOwnProperty(a))for((i=l[a]).sort(function(e,t){return t.toItems.length-e.toItems.length}),r=0;r<i.length;r+=1){o=i[r];var m=t,c=s,h=o.fromItem,u=o.toItems,d=void 0,g=!0,p=null,f=void 0,T=void 0,y=void 0,k=void 0,v=[];for(T=0,y=u.length;T<y;T+=1){if(f=u[T],null==(d=c.edge(h,f))){g=!1;break}if(null==p)p=d.getFar(f);else if(p!=d.getFar(f)){g=!1;break}v.push(d.getNear(f))}if(g&&(k=new e.famdiagram.FamilyItem({id:o.id,isVisible:!0,isLevelNeutral:!0,isActive:!1,itemConfig:o}),m.bundleParents(p,v,k.id,k)?(k.levelGravity=2,g=!0):m.bundleChildren(p,v,k.id,k)?(k.levelGravity=1,g=!0):m.bundleParents(p,u,k.id,k)?(k.levelGravity=2,g=!0):m.bundleParents(p,u,k.id,k)&&(k.levelGravity=1,g=!0),g))for(T=0,y=u.length;T<y;T+=1)f=u[T],(d=c.edge(h,f)).setFar(f,k.id)}}}var o=null,a=null;return{process:function(e){var r=n.getLogicalFamily(),s=t.getAnnotations();if(i(r=r.clone(),s),o=r,a=t.getMaximumId(),e&&!r.validate())throw"References are broken in family structure!";return!0},getNavigationFamily:function(){return o},getMaximumId:function(){return a}}},e.famdiagram.AddSpousesTask=function(t,n){var i=null,o=null;return{process:function(a){var r,s,l,m,c,h,u,d,g=n.getLogicalFamily(),p=n.getMaximumId(),f=t.getItems(),T=g=g.clone();for(l=0,m=f.length;l<m;l+=1)for(h=0,u=(d=(c=f[l]).spouses.slice(0)).length;h<u;h+=1)r=[c.id,d[h]],T.hasCommonChild(r)||(p+=1,s=new e.famdiagram.FamilyItem({id:p,isVisible:!1,isActive:!1,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+p,description:"This is fake child keeps spouses together."},levelGravity:1}),T.add(r,s.id,s));if(i=g,o=p,a&&!g.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return i},getMaximumId:function(){return o}}},e.famdiagram.HideGrandParentsConnectorsTask=function(e,t){var n=null,i=null;return{process:function(){var o=t.getLogicalFamily(),a=t.getMaximumId();return i=o=1==e.getOptions().hideGrandParentsConnectors?o.getFamilyWithoutGrandParentsRelations():o.clone(),n=a,!0},getLogicalFamily:function(){return i},getMaximumId:function(){return n}}},e.famdiagram.ItemsPositionsTask=function(t,n,i,o,a,r,s,l,m,c){var h={},u=null;return{process:function(){var d=o.getOptions(),g=a.getOptions(),p=r.getOptions(),f={logicalFamily:s.getLogicalFamily(),treeLevels:s.getTreeLevels(),getConnectorsStacksSizes:s.getConnectorsStacksSizes,isItemSelected:c.isItemSelected,cursorItemId:m.getCursorTreeItem(),getTemplateParams:l.getTemplateParams};d={verticalAlignment:d.verticalAlignment,pageFitMode:d.pageFitMode,minimalVisibility:d.minimalVisibility,normalLevelShift:d.normalLevelShift,dotLevelShift:d.dotLevelShift,lineLevelShift:d.lineLevelShift,normalItemsInterval:d.normalItemsInterval,dotItemsInterval:d.dotItemsInterval,lineItemsInterval:d.lineItemsInterval,orientationType:i.getOptions().orientationType,arrowsDirection:g.arrowsDirection,linesWidth:g.linesWidth,checkBoxPanelSize:d.checkBoxPanelSize,buttonsPanelSize:d.buttonsPanelSize,groupTitlePanelSize:d.groupTitlePanelSize,groupTitlePlacementType:d.groupTitlePlacementType,maximumColumnsInMatrix:p.maximumColumnsInMatrix},g=t.getOptimalPanelSize(),p=n.getOptions().scale;g.scale(1/p);g=new e.common.Rect(0,0,g.width,g.height),p=new e.famdiagram.FamilyLayout(f,d);var T,y=s.getMatrixes();for(T in y)if(y.hasOwnProperty(T)){var k=f.logicalFamily.node(T);p.add(T,new e.famdiagram.MatrixLayout({items:y[T],isItemSelected:f.isItemSelected,cursorItemId:f.cursorItemId,getTemplateParams:f.getTemplateParams,hideParentConnection:k.hideParentConnection,hideChildrenConnection:k.hideChildrenConnection},d))}return u=p.measure(g),h={},p.arrange(this,function(e,t){h[e]=t}),!0},getItemsPositions:function(){return h},getItemPosition:function(e){return h[e]},getContentSize:function(){return u}}},e.famdiagram.LogicalFamilyTask=function(t){var n=null,i=null;return{process:function(o){var a,r,s,l,m=t.getItems(),c=e.common.family(),h=0;if(0<m.length)for(a=0,r=m.length;a<r;a+=1)null!=(s=m[a])&&(l=new e.famdiagram.FamilyItem({id:s.id,itemConfig:s,isActive:s.isActive}),c.add(s.parents,l.id,l),s=parseInt(s.id,10),h=Math.max(isNaN(s)?0:s,h));if(n=c,i=h,o&&!c.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return n},getMaximumId:function(){return i}}},e.famdiagram.NormalizeLogicalFamilyTask=function(t,n){var i=null,o=null,a=new e.famdiagram.FamilyNormalizer(!1);return{process:function(){var e=n.getLogicalFamily(),r=n.getMaximumId(),s={groupByType:(s=t.getOptions()).groupByType,alignBylevels:s.alignBylevels};e=e.clone(),r=a.normalize(s,e,r);return o=e,i=r,!0},getLogicalFamily:function(){return o},getMaximumId:function(){return i}}},e.famdiagram.OrderFamilyNodesTask=function(t,n,i,o){var a=null,r=null,s={},l={},m=null,c=null,h=null,u=new e.famdiagram.FamilyBalance,d=new e.famdiagram.FamilyMatrixesExtractor(!1),g=new e.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var e=i.getLogicalFamily(),g=i.getMaximumId(),p={},f={},T=[],y={enableMatrixLayout:(y=t.getOptions()).enableMatrixLayout,minimumMatrixSize:y.minimumMatrixSize,maximumColumnsInMatrix:y.maximumColumnsInMatrix};e=e.clone(),g=d.extract(y,e,p,f,T,g);return r=e,s=p,l=f,c=T,e={logicalFamily:e,maximumId:g,defaultItemConfig:o,itemsPositions:n.getPositions(),itemsGroups:n.getGroups()},e=u.balance(e),a=e.maximumId,m=e.treeLevels,c=c.concat(e.bundles),h=e.connectorStacks,!0},getLogicalFamily:function(){return r},getMatrixes:function(){return s},getNestedLayoutBottomConnectorIds:function(){return l},getMaximumId:function(){return a},getTreeLevels:function(){return m},getBundles:function(){return c},getConnectorsStacksSizes:function(e){return h[e]||g}}},e.famdiagram.RemoveLoopsTask=function(t,n){function i(t,n,i){var o,a,r,s,l,m,c,h,u;if(o=n.clone(),n.loopTopo(this,function(e){o.removeNode(e)}),o.hasNodes())for(s=0,l=t.length;s<l;s+=1)if(a=t[s],null!=o.node(a.id)){for(u=[],o.loopParents(this,a.id,function(e){return u.push(e),o.SKIP}),m=0,c=u.length;m<c;m+=1)o.removeRelation(u[m],a.id),n.removeRelation(u[m],a.id);for(i+=1,r=new e.famdiagram.FamilyItem({id:i,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake parent #"+i,description:"This is fake parent item was created by loops reversal."}}),n.add([],r.id,r),n.adopt([r.id],a.id),m=0,c=u.length;m<c;m+=1)i+=1,a=new e.famdiagram.FamilyItem({id:i,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+i,description:"This is fake child item was created by loops reversal."}}),n.add([r.id,u[m]],a.id,a);for(h=[],o.loopTopo(this,function(e){h.push(e)}),m=0,c=h.length;m<c;m+=1)o.removeNode(h[m])}return i}var o=null,a=null;return{process:function(e){var r=n.getNavigationFamily(),s=n.getMaximumId();s=i(t.getItems(),r=r.clone(),s);if(o=r,a=s,e&&!r.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return o},getMaximumId:function(){return a}}},e.famdiagram.UserDefinedNodesOrderTask=function(t){var n=null,i=null,o=new e.famdiagram.UserDefinedNodesOrder;return{process:function(){var e=t.getOptions();e=o.getUserDefinedPositions(e.items);return n=e.position,i=e.group,!0},getPositions:function(){return n},getGroups:function(){return i}}},e.famdiagram.Control=function(t,n){return e.orgdiagram.BaseControl(t,n,e.famdiagram.TaskManagerFactory,e.famdiagram.EventArgsFactory,{AnnotationLabelTemplate:e.common.AnnotationLabelTemplate,ButtonsTemplate:e.common.ButtonsTemplate,CheckBoxTemplate:e.common.CheckBoxTemplate,CursorTemplate:e.common.CursorTemplate,DotHighlightTemplate:e.common.DotHighlightTemplate,GroupTitleTemplate:e.common.GroupTitleTemplate,HighlightTemplate:e.common.HighlightTemplate,ItemTemplate:e.common.ItemTemplate,UserTemplate:e.common.UserTemplate,LabelAnnotationTemplate:e.common.LabelAnnotationTemplate})},e.famdiagram.EventArgsFactory=function(t,n,i,o){var a=new e.famdiagram.EventArgs,r=t.tasks.getTask("CombinedContextsTask"),s=t.tasks.getTask("AlignDiagramTask"),l=t.tasks.getTask("LogicalFamilyTask"),m=(n=r.getConfig(n),r.getConfig(i)),c=l.getLogicalFamily();return n&&null!=n.id&&(a.oldContext=n),m&&null!=m.id&&(a.context=m,c.loopParents(this,m.id,function(e,t,n){if(0<n)return c.BREAK;a.parentItems.push(r.getConfig(e))}),c.loopChildren(this,m.id,function(e,t,n){if(0<n)return c.BREAK;a.childrenItems.push(r.getConfig(e))}),l=e.common.getElementOffset(t.layout.mousePanel),t=e.common.getElementOffset(t.layout.element),i=s.getItemPosition(i),a.position=new e.common.Rect(i.actualPosition).translate(l.left,l.top).translate(-t.left,-t.top)),null!=o&&(a.name=o),a},e.famdiagram.getProcessDiagramConfig=function(){var t=function(){};return e.famdiagram.TaskManagerFactory(t,t,t).getProcessDiagramConfig()},e.famdiagram.TaskManagerFactory=function(t,n,i,o,a){var r=new e.common.TaskManager;return r.addDependency("options",t),r.addDependency("graphics",n),r.addDependency("getLayout",i),r.addDependency("setLayout",o),r.addDependency("templates",a),r.addDependency("defaultConfig",new e.famdiagram.Config),r.addDependency("defaultItemConfig",new e.famdiagram.ItemConfig),r.addDependency("defaultTemplateConfig",new e.famdiagram.TemplateConfig),r.addDependency("defaultButtonConfig",new e.famdiagram.ButtonConfig),r.addDependency("defaultPaletteItemConfig",new e.famdiagram.PaletteItemConfig),r.addDependency("defaultBackgroundAnnotationConfig",new e.famdiagram.BackgroundAnnotationConfig),r.addDependency("defaultConnectorAnnotationConfig",new e.famdiagram.ConnectorAnnotationConfig),r.addDependency("defaultHighlightPathAnnotationConfig",new e.famdiagram.HighlightPathAnnotationConfig),r.addDependency("defaultShapeAnnotationConfig",new e.famdiagram.ShapeAnnotationConfig),r.addDependency("defaultLabelAnnotationConfig",new e.famdiagram.LabelAnnotationConfig),r.addDependency("isFamilyChartMode",!0),r.addDependency("showElbowDots",!0),r.addDependency("null",null),r.addDependency("foreground",2),r.addDependency("background",1),r.addTask("OptionsTask",["options"],e.famdiagram.OptionsTask,"#000000"),r.addTask("LayoutOptionsTask",["getLayout","OptionsTask"],e.orgdiagram.LayoutOptionsTask,"#000000"),r.addTask("CurrentControlSizeTask",["LayoutOptionsTask","ItemsSizesOptionTask"],e.orgdiagram.CurrentControlSizeTask,"#000000"),r.addTask("CurrentScrollPositionTask",["LayoutOptionsTask"],e.orgdiagram.CurrentScrollPositionTask,"#000000"),r.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.orgdiagram.CalloutOptionTask,"#000080"),r.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ConnectorsOptionTask,"#000080"),r.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],e.famdiagram.ItemsOptionTask,"#000080"),r.addTask("ItemsContentOptionTask",["OptionsTask","defaultItemConfig"],e.orgdiagram.ItemsContentOptionTask,"#000080"),r.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],e.famdiagram.SpousesOptionTask,"#000080"),r.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],e.orgdiagram.ItemsSizesOptionTask,"#000080"),r.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.orgdiagram.LabelsOptionTask,"#000080"),r.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],e.orgdiagram.TemplatesOptionTask,"#000080"),r.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.OrientationOptionTask,"#000080"),r.addTask("VisualTreeOptionTask",["OptionsTask"],e.famdiagram.VisualTreeOptionTask,"#000080"),r.addTask("MinimizedItemsOptionTask",["OptionsTask"],e.orgdiagram.MinimizedItemsOptionTask,"#000080"),r.addTask("HideGrandParentsConnectorsOptionTask",["OptionsTask","defaultConfig"],e.famdiagram.HideGrandParentsConnectorsOptionTask,"#000080"),r.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],e.famdiagram.NormalizeOptionTask,"#000080"),r.addTask("OrderFamilyNodesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.famdiagram.OrderFamilyNodesOptionTask,"#000080"),r.addTask("LinePaletteOptionTask",["OptionsTask","defaultPaletteItemConfig"],e.famdiagram.LinePaletteOptionTask,"#000080"),r.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.CursorItemOptionTask,"#000080"),r.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.HighlightItemOptionTask,"#000080"),r.addTask("SelectedItemsOptionTask",["OptionsTask"],e.orgdiagram.SelectedItemsOptionTask,"#000080"),r.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.CursorSelectionPathModeOptionTask,"#000080"),r.addTask("NeighboursSelectionModeOptionTask",["OptionsTask","defaultConfig"],e.famdiagram.NeighboursSelectionModeOptionTask,"#000080"),r.addTask("SplitAnnotationsOptionTask",["OptionsTask"],e.orgdiagram.SplitAnnotationsOptionTask,"#00ffff"),r.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),r.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),r.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),r.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),r.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),r.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),r.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],e.orgdiagram.BackgroundAnnotationOptionTask,"#000080"),r.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ScaleOptionTask,"#000080"),r.addTask("UserDefinedNodesOrderTask",["OrderFamilyNodesOptionTask","defaultItemConfig"],e.famdiagram.UserDefinedNodesOrderTask,"#ff0000"),r.addTask("LogicalFamilyTask",["ItemsOptionTask"],e.famdiagram.LogicalFamilyTask,"#00ffff"),r.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],e.famdiagram.LabelAnnotationOptionTask,"#000080"),r.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],e.famdiagram.LabelAnnotationTemplateOptionTask,"#000080"),r.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],e.famdiagram.LabelAnnotationPlacementOptionTask,"#000080"),r.addTask("CombinedContextsTask",["ItemsContentOptionTask","LabelAnnotationOptionTask"],e.orgdiagram.CombinedContextsTask,"#00ffff"),r.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],e.famdiagram.AddLabelAnnotationsTask,"#ff0000"),r.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],e.famdiagram.RemoveLoopsTask,"#ff0000"),r.addTask("AddSpousesTask",["SpousesOptionTask","RemoveLoopsTask"],e.famdiagram.AddSpousesTask,"#ff0000"),r.addTask("HideGrandParentsConnectorsTask",["HideGrandParentsConnectorsOptionTask","AddSpousesTask"],e.famdiagram.HideGrandParentsConnectorsTask,"#ff0000"),r.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","HideGrandParentsConnectorsTask"],e.famdiagram.NormalizeLogicalFamilyTask,"#ff0000"),r.addTask("OrderFamilyNodesTask",["OrderFamilyNodesOptionTask","UserDefinedNodesOrderTask","NormalizeLogicalFamilyTask","defaultItemConfig"],e.famdiagram.OrderFamilyNodesTask,"#ff0000"),r.addTask("ReadTemplatesTask",["TemplatesOptionTask","templates"],e.orgdiagram.ReadTemplatesTask,"#00ffff"),r.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],e.orgdiagram.ActiveItemsTask,"#00ffff"),r.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],e.orgdiagram.ItemTemplateParamsTask,"#00ffff"),r.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],e.famdiagram.LabelAnnotationTemplateParamsTask,"#00ffff"),r.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],e.famdiagram.CombinedTemplateParamsTask,"#00ffff"),r.addTask("GroupTitleTemplateTask",["TemplatesOptionTask","templates"],e.orgdiagram.GroupTitleTemplateTask,"#00ffff"),r.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask","templates"],e.orgdiagram.CheckBoxTemplateTask,"#00ffff"),r.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask","templates"],e.orgdiagram.ButtonsTemplateTask,"#00ffff"),r.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask","templates"],e.orgdiagram.AnnotationLabelTemplateTask,"#00ffff"),r.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","OrderFamilyNodesTask","AlignDiagramTask"],e.orgdiagram.ConnectionsGraphTask,"#00ffff"),r.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],e.orgdiagram.HighlightItemTask,"#00ffff"),r.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],e.orgdiagram.CursorItemTask,"#00ffff"),r.addTask("CursorNeighboursTask",["CursorItemTask","NeighboursSelectionModeOptionTask","AddLabelAnnotationsTask","ActiveItemsTask"],e.famdiagram.CursorNeighboursTask,"#00ffff"),r.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],e.orgdiagram.SelectedItemsTask,"#00ffff"),r.addTask("SelectionPathItemsTask",["AddLabelAnnotationsTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],e.orgdiagram.SelectionPathItemsTask,"#00ffff"),r.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",["ForegroundConnectorAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff"),r.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),e.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff"),r.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask OrderFamilyNodesOptionTask OrderFamilyNodesTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),e.famdiagram.ItemsPositionsTask,"#ff0000"),r.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask ActiveItemsTask ItemsPositionsTask isFamilyChartMode".split(" "),e.orgdiagram.AlignDiagramTask,"#ff0000"),r.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],e.orgdiagram.CreateTransformTask,"#00ffff"),r.addTask("CenterOnCursorTask","LayoutOptionsTask CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),e.orgdiagram.CenterOnCursorTask,"#00ffff"),r.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],e.orgdiagram.PaletteManagerTask,"#00ffff"),r.addTask("ApplyLayoutChangesTask","graphics setLayout ItemsSizesOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),e.orgdiagram.ApplyLayoutChangesTask,"#00ffff"),r.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),r.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),r.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask".split(" "),e.orgdiagram.DrawBackgroundAnnotationTask,"#008000"),r.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),r.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),r.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),r.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),r.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),e.orgdiagram.DrawCursorTask,"#008000"),r.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),e.orgdiagram.DrawHighlightTask,"#008000"),r.addTask("DrawHighlightAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),e.orgdiagram.DrawHighlightAnnotationTask,"#008000"),r.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CenterOnCursorTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),e.orgdiagram.DrawTreeItemsTask,"#008000"),r.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask CombinedTemplateParamsTask AlignDiagramTask".split(" "),e.orgdiagram.DrawMinimizedItemsTask,"#008000"),r.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],e.orgdiagram.DrawConnectorsTask,"#008000"),r.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],e.orgdiagram.DrawItemLabelsTask,"#008000"),r},e.orgdiagram.TemplateConfig=function(){this.name=null,this.isActive=!0,this.itemSize=new e.common.Size(120,100),this.itemBorderWidth=1,this.minimizedItemShapeType=this.itemTemplate=null,this.minimizedItemSize=new e.common.Size(4,4),this.minimizedItemCornerRadius=null,this.minimizedItemLineWidth=1,this.minimizedItemBorderColor=null,this.minimizedItemLineType=0,this.minimizedItemFillColor=null,this.minimizedItemOpacity=1,this.highlightPadding=new e.common.Thickness(2,2,2,2),this.highlightBorderWidth=1,this.highlightTemplate=null,this.cursorPadding=new e.common.Thickness(3,3,3,3),this.cursorBorderWidth=2,this.onButtonsRender=this.buttons=this.cursorTemplate=null},e.orgdiagram.BackgroundAnnotationConfig=function(t){var n;switch(this.annotationType=4,this.items=[],this.includeChildren=!1,this.zOrderType=0,this.offset=new e.common.Thickness(18,18,18,18),this.lineWidth=2,this.opacity=1,this.fillColor=this.borderColor=null,this.lineType=0,this.selectItems=!1,arguments.length){case 1:if(null!==t)if(t instanceof Array)this.items=t;else if("object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}},e.orgdiagram.ButtonConfig=function(t,n,i){this.name=t,this.icon=n,this.text=!1,this.label=null,this.tooltip=i,this.size=new e.common.Size(16,16)},e.orgdiagram.Config=function(t){this.name=void 0!==t?t:"OrgDiagram",this.classPrefix="orgdiagram",this.graphicsType=this.navigationMode=0,this.pageFitMode=3,this.minimalVisibility=2,this.horizontalAlignment=this.orientationType=0,this.verticalAlignment=1,this.arrowsDirection=0,this.showExtraArrows=!1,this.extraArrowsMinimumSpace=30,this.connectorType=0,this.bevelSize=4,this.elbowType=0,this.elbowDotSize=4,this.emptyDiagramMessage="Diagram is empty.",this.items=[],this.annotations=[],this.highlightItem=this.cursorItem=null,this.highlightGravityRadius=40,this.selectedItems=[],this.hasSelectorCheckbox=0,this.selectCheckBoxLabel="Selected",this.selectionPathMode=1,this.templates=[],this.defaultTemplateName=null,this.hasButtons=0,this.buttons=[],this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=this.onButtonsRender=null,this.dotLevelShift=this.normalLevelShift=20,this.normalItemsInterval=this.lineLevelShift=10,this.dotItemsInterval=1,this.lineItemsInterval=2,this.cousinsIntervalMultiplier=5,this.itemTitleFirstFontColor="#ffffff",this.itemTitleSecondFontColor="#000080",this.minimizedItemShapeType=6,this.linesColor="#c0c0c0",this.linesWidth=1,this.linesType=0,this.highlightLinesColor="#ff0000",this.highlightLinesWidth=1,this.highlightLinesType=0,this.showCallout=!0,this.calloutMaximumVisibility=2,this.calloutPlacementOffset=100,this.defaultCalloutTemplateName=null,this.calloutfillColor="#000000",this.calloutBorderColor=null,this.calloutCornerRadius=this.calloutOffset=4,this.calloutPointerWidth="10%",this.calloutLineWidth=1,this.calloutOpacity=.2,this.leavesPlacementType=this.childrenPlacementType=2,this.placeAdvisersAboveChildren=this.placeAssistantsAboveChildren=!0,this.maximumColumnsInMatrix=6,this.buttonsPanelSize=28,this.checkBoxPanelSize=this.groupTitlePanelSize=24,this.groupTitleOrientation=this.groupTitlePlacementType=2,this.groupTitleVerticalAlignment=1,this.groupTitleHorizontalAlignment=0,this.groupTitleFontSize="12px",this.groupTitleFontFamily="Arial",this.groupTitleColor="#4169e1",this.groupTitleFontStyle=this.groupTitleFontWeight="normal",this.distance=3,this.scale=1,this.minimumScale=.5,this.maximumScale=2,this.showLabels=0,this.labelSize=new e.common.Size(80,24),this.labelOffset=1,this.labelOrientation=0,this.labelPlacement=1,this.labelFontSize="10px",this.labelFontFamily="Arial",this.labelColor="#000000",this.labelFontStyle=this.labelFontWeight="normal",this.enablePanning=!0,this.autoSizeMinimum=new e.common.Size(800,600),this.autoSizeMaximum=new e.common.Size(1024,768)},e.orgdiagram.ConnectorAnnotationConfig=function(t,n){var i;switch(this.annotationType=0,this.zOrderType=2,this.toItem=this.fromItem=null,this.connectorPlacementType=this.connectorShapeType=0,this.labelPlacementType=1,this.offset=new e.common.Thickness(0,0,0,0),this.lineWidth=2,this.color="#000000",this.lineType=0,this.selectItems=!0,this.label=null,this.labelSize=new e.common.Size(60,30),arguments.length){case 1:for(i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);break;case 2:this.fromItem=t,this.toItem=n}},e.orgdiagram.HighlightPathAnnotationConfig=function(e){var t;switch(this.zOrderType=this.annotationType=2,this.items=[],this.lineWidth=2,this.color="#ff0000",this.lineType=0,this.opacity=1,this.showArrows=!0,this.selectItems=!1,arguments.length){case 1:if(null!==e)if(e instanceof Array)this.items=e;else if("object"==typeof e)for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}},e.orgdiagram.ItemConfig=function(e,t,n,i,o){var a;switch(this.context=this.image=this.description=this.title=this.parent=this.id=null,this.itemTitleColor="#4169e1",this.groupTitle=this.minimizedItemShapeType=null,this.groupTitleColor="#4169e1",this.isActive=this.isVisible=!0,this.itemType=this.hasButtons=this.hasSelectorCheckbox=0,this.levelOffset=null,this.placeAdvisersAboveChildren=this.placeAssistantsAboveChildren=this.childrenPlacementType=this.adviserPlacementType=0,this.templateName=null,this.showCallout=0,this.label=this.calloutTemplateName=null,this.showLabel=0,this.labelSize=null,this.labelOrientation=3,this.labelPlacement=0,arguments.length){case 1:for(a in e)e.hasOwnProperty(a)&&(this[a]=e[a]);break;case 5:this.id=e,this.parent=t,this.title=n,this.description=i,this.image=o}},e.orgdiagram.ShapeAnnotationConfig=function(t){var n;switch(this.annotationType=1,this.zOrderType=0,this.items=[],this.shapeType=0,this.offset=new e.common.Thickness(0,0,0,0),this.lineWidth=2,this.cornerRadius="10%",this.opacity=1,this.fillColor=this.borderColor=null,this.lineType=0,this.selectItems=!1,this.label=null,this.labelSize=new e.common.Size(60,30),this.labelPlacement=0,this.labelOffset=4,arguments.length){case 1:if(null!==t)if(t instanceof Array)this.items=t;else if("object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}},e.orgdiagram.EventArgs=function(){this.name=this.position=this.parentItem=this.context=this.oldContext=null,this.cancel=!1},e.common.BaseConnectorBundle=function(){this.NORMAL_ITEM_WEIGHT=10010,this.LINE_ITEM_WEIGHT=1e4},e.common.BaseConnectorBundle.prototype.trace=function(){},e.common.BaseConnectorBundle.prototype.getId=function(e){var t="_"+e.nodeid;return e.nodeid+=1,t},e.common.BaseConnectorBundle.prototype.ConnectorEdge=function(e,t,n,i,o,a,r,s,l,m){this.polyline=n,this.from=e,this.to=t,this.weight=r||0,this.fromOffset=s||0,this.parentsArrowId=i,this.childrenArrowId=o,this.dotId=a,this.hasMiddle=l,this.middleParent=m},e.common.BaseConnectorBundle.prototype.ConnectorDestination=function(e){for(var t in this.bundleid=this.y=this.x=this.id=null,this.hasElbow=!1,this.visibility=this.elbowPoint2=this.elbowPoint1=null,this.isSquared=!0,e)e.hasOwnProperty(t)&&(this[t]=e[t])},e.common.BaseConnectorBundle.prototype.traceFork=function(t,n,i,o,a,r,s,l,m){var c,h,u,d,g,p,f=[];if(r){for(f=[],r=0,h=a.length;r<h&&((u=a[r]).x<o.x&&!u.isSquared);r+=1)f.push(u);for(0<(h=f.length)&&(u=(u=f[h-1]).x==o.x?o:new this.ConnectorDestination({id:u.bundleid,x:u.x,y:o.y}),this.traceAngularSegments(t,n,i,u,f,!1)),f=[],c=a.length-1;c>=r&&((u=a[c]).x>o.x&&!u.isSquared);c-=1)f.push(u);for(0<(h=f.length)&&(u=(u=f[h-1]).x==o.x?o:new this.ConnectorDestination({id:u.bundleid,x:u.x,y:o.y}),this.traceAngularSegments(t,n,i,u,f,!1)),f=r;f<=c;f+=1){if(u=a[f],2>(h=i.bevelSize)&&(h=0),n.hasGraphics)switch(i.elbowType){case 2:case 3:0<h&&Math.abs(o.x-u.x)>h&&Math.abs(o.y-u.y)>h&&(u.hasElbow=!0,u.elbowPoint1=new e.common.Point(u.x,o.y+(o.y>u.y?-h:h)),u.elbowPoint2=new e.common.Point(u.x+(o.x>u.x?h:-h),o.y))}d=new e.common.Polyline,u.hasElbow?(n.transform.transform3Points(u.elbowPoint2.x,u.elbowPoint2.y,u.elbowPoint1.x,u.elbowPoint2.y,u.elbowPoint1.x,u.elbowPoint1.y,!0,this,function(t,n,o,a,r,s){switch(i.elbowType){case 2:d.addSegment(new e.common.MoveSegment(t,n)),d.addSegment(new e.common.LineSegment(r,s));break;case 3:d.addSegment(new e.common.MoveSegment(t,n)),d.addSegment(new e.common.CubicArcSegment(t,n,o,a,r,s))}}),n.transform.transformPoints(u.elbowPoint1.x,u.elbowPoint1.y,u.x,u.y,!0,this,function(t,n,i,o){d.addSegment(new e.common.LineSegment(i,o))})):n.transform.transformPoints(u.x,o.y,u.x,u.y,!0,this,function(t,n,i,o){d.addSegment(new e.common.MoveSegment(t,n)),d.addSegment(new e.common.LineSegment(i,o))}),h=u.x==o.x?o.id:u.bundleid,g=4!==u.visibility,t.graph.addEdge(h,u.id,new this.ConnectorEdge(h,u.id,d,s&&g?u.id:null,!s&&g?u.id:null,null,g?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT,l))}for(r=Math.max(r-1,0),c=Math.min(c+1,a.length-1),u=o,h=o.id,f=r;f<=c;f+=1)p=(g=a[f]).bundleid,g.x>u.x&&(d=new e.common.Polyline,n.transform.transformPoints(u.x,o.y,null!=g.elbowPoint2?g.elbowPoint2.x:g.x,o.y,!0,this,function(t,n,i,o){d.addSegment(new e.common.MoveSegment(t,n)),d.addSegment(new e.common.LineSegment(i,o))}),t.graph.addEdge(h,p,new this.ConnectorEdge(h,p,d,null,null,h,Math.abs(g.x-u.x)/1e4,l,m,s?p:h)),u=g.elbowPoint2||g,h=p);for(u=o,h=o.id,f=c;f>=r;f-=1)p=(g=a[f]).bundleid,g.x<u.x&&(d=new e.common.Polyline,n.transform.transformPoints(u.x,o.y,null!=g.elbowPoint2?g.elbowPoint2.x:g.x,o.y,!0,this,function(t,n,i,o){d.addSegment(new e.common.MoveSegment(t,n)),d.addSegment(new e.common.LineSegment(i,o))}),t.graph.addEdge(h,p,new this.ConnectorEdge(h,p,d,null,null,h,Math.abs(g.x-u.x)/1e4,l,m,s?p:h)),u=g.elbowPoint2||g,h=p)}else this.traceAngularSegments(t,n,i,o,a,!0)},e.common.BaseConnectorBundle.prototype.traceAngularSegments=function(t,n,i,o,a,r){var s,l,m,c,h;for(s=0,l=a.length;s<l;s+=1){switch(c=a[s],h=new e.common.Polyline,n.transform.transformPoint(o.x,o.y,!0,this,function(t,n){h.addSegment(new e.common.MoveSegment(t,n))}),i.connectorType){case 1:n.transform.transformPoint(c.x,c.y,!0,this,function(t,n){h.addSegment(new e.common.LineSegment(t,n))});break;case 2:m=new e.common.Rect(o,c),r?o.x>m.x?n.transform.transform3Points(m.right(),m.verticalCenter(),m.x,m.verticalCenter(),m.x,m.bottom(),!0,this,function(t,n,i,o,a,r){h.addSegment(new e.common.CubicArcSegment(t,n,i,o,a,r))}):n.transform.transform3Points(m.x,m.verticalCenter(),m.right(),m.verticalCenter(),m.right(),m.bottom(),!0,this,function(t,n,i,o,a,r){h.addSegment(new e.common.CubicArcSegment(t,n,i,o,a,r))}):o.x>m.x?n.transform.transformPoints(m.x,m.y,m.x,m.bottom(),!0,this,function(t,n,i,o){h.addSegment(new e.common.QuadraticArcSegment(t,n,i,o))}):n.transform.transformPoints(m.right(),m.y,m.right(),m.bottom(),!0,this,function(t,n,i,o){h.addSegment(new e.common.QuadraticArcSegment(t,n,i,o))})}m=4!==c.visibility,t.graph.addEdge(o.id,c.id,new this.ConnectorEdge(o.id,c.id,h,null,m?c.id:null,m?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT))}},e.common.HorizontalConnectorBundle=function(e,t){this.fromItem=e,this.toItem=t},e.common.HorizontalConnectorBundle.prototype=new e.common.BaseConnectorBundle,e.common.HorizontalConnectorBundle.prototype.trace=function(t,n){var i=this.fromItem,o=this.toItem,a=n.treeItemsPositions[i],r=n.treeItemsPositions[o],s=new e.common.Polyline;a.actualPosition.x<r.actualPosition.x?n.transform.transformPoints(a.actualPosition.right(),a.horizontalConnectorsShift,r.actualPosition.x,r.horizontalConnectorsShift,!0,this,function(t,n,i,o){s.addSegment(new e.common.MoveSegment(t,n)),s.addSegment(new e.common.LineSegment(i,o))}):n.transform.transformPoints(a.actualPosition.x,a.horizontalConnectorsShift,r.actualPosition.right(),a.horizontalConnectorsShift,!0,this,function(t,n,i,o){s.addSegment(new e.common.MoveSegment(t,n)),s.addSegment(new e.common.LineSegment(i,o))}),r=4!==r.actualVisibility,a=4!==a.actualVisibility,t.graph.addEdge(i,o,new this.ConnectorEdge(i,o,s,r?o:null,a?i:null,r||a?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT))},e.common.MatrixConnectorBundle=function(e,t,n,i,o){this.isChildren=e,this.items=t,this.len=t.length,this.matrixNodeId=n,this.connectionId=i,this.matrixWidth=o,this.blocksCount=Math.ceil(this.matrixWidth/2),this.rowsCount=Math.ceil(this.len/this.matrixWidth)},e.common.MatrixConnectorBundle.prototype=new e.common.BaseConnectorBundle,e.common.MatrixConnectorBundle.prototype.trace=function(e,t,n){this.isChildren?this.traceChildrenLayout(e,t,n):this.traceParentsLayout(e,t,n)},e.common.MatrixConnectorBundle.prototype.traceChildrenLayout=function(t,n,i){for(var o,a=[],r=0;r<this.blocksCount;r+=1){for(var s=null,l=this.rowsCount-1;0<=l;l-=1){var m=this.getNodeIndex(r,l,!0,!0),c=null;o=null,m<this.len&&(c=this.items[m],o=n.treeItemsPositions[c]);var h=this.getNodeIndex(r,l,!1,!0),u=null;m=null;h<this.len&&(u=this.items[h],m=n.treeItemsPositions[u]);var d=null;null==d&&null!=o&&(d=new this.ConnectorDestination({id:this.getId(t),x:o.actualPosition.horizontalCenter()+o.rightMedianOffset,y:o.horizontalConnectorsShift})),null==d&&null!=m&&(d=new this.ConnectorDestination({id:this.getId(t),x:m.actualPosition.horizontalCenter()-m.leftMedianOffset,y:m.horizontalConnectorsShift})),null!=o&&(o=o.actualPosition,n.transform.transformPoints(o.right(),o.verticalCenter(),d.x,d.y,!0,this,function(n,i,o,a){var r=new e.common.Polyline;r.addSegment(new e.common.MoveSegment(n,i)),r.addSegment(new e.common.LineSegment(o,a)),t.graph.addEdge(c,d.id,new this.ConnectorEdge(c,d.id,r,null,c,null,10))})),null!=m&&(o=m.actualPosition,n.transform.transformPoints(o.left(),o.verticalCenter(),d.x,d.y,!0,this,function(n,i,o,a){var r=new e.common.Polyline;r.addSegment(new e.common.MoveSegment(n,i)),r.addSegment(new e.common.LineSegment(o,a)),t.graph.addEdge(u,d.id,new this.ConnectorEdge(u,d.id,r,null,u,null,10))})),null!=s&&null!=d&&n.transform.transformPoints(s.x,s.y,d.x,d.y,!0,this,function(n,i,o,a){var r=new e.common.Polyline;r.addSegment(new e.common.MoveSegment(n,i)),r.addSegment(new e.common.LineSegment(o,a)),t.graph.addEdge(s.id,d.id,new this.ConnectorEdge(s.id,d.id,r,null,null,null,0))}),null!=d&&(s=d)}null!=s&&a.push(new this.ConnectorDestination({id:s.id,bundleid:this.getId(t),x:s.x,y:s.y,isSquared:!0,visibility:4}))}o=n.treeItemsPositions[this.matrixNodeId].actualPosition,r=new this.ConnectorDestination({id:this.matrixNodeId,x:o.horizontalCenter(),y:o.top()}),this.traceFork(t,n,i,r,a,!0,!1,0,i.showExtraArrows)},e.common.MatrixConnectorBundle.prototype.traceParentsLayout=function(t,n,i){for(var o,a=[],r=0;r<=this.blocksCount;r+=1){for(var s=null,l=0;l<this.rowsCount;l+=1){var m=this.getNodeIndex(r,l,!0,!1),c=null;o=null,m<this.len&&(c=this.items[m],o=n.treeItemsPositions[c]);var h=this.getNodeIndex(r,l,!1,!1),u=null;m=null;h<this.len&&(u=this.items[h],m=n.treeItemsPositions[u]);var d=null;null==d&&null!=o&&(d=new this.ConnectorDestination({id:this.getId(t),x:o.actualPosition.horizontalCenter()+o.rightMedianOffset,y:o.horizontalConnectorsShift})),null==d&&null!=m&&(d=new this.ConnectorDestination({id:this.getId(t),x:m.actualPosition.horizontalCenter()-m.leftMedianOffset,y:m.horizontalConnectorsShift})),null!=o&&(o=o.actualPosition,n.transform.transformPoints(o.right(),o.verticalCenter(),d.x,d.y,!0,this,function(n,i,o,a){var r=new e.common.Polyline;r.addSegment(new e.common.MoveSegment(n,i)),r.addSegment(new e.common.LineSegment(o,a)),t.graph.addEdge(c,d.id,new this.ConnectorEdge(c,d.id,r,c,null,null,10))})),null!=m&&(o=m.actualPosition,n.transform.transformPoints(o.left(),o.verticalCenter(),d.x,d.y,!0,this,function(n,i,o,a){var r=new e.common.Polyline;r.addSegment(new e.common.MoveSegment(n,i)),r.addSegment(new e.common.LineSegment(o,a)),t.graph.addEdge(u,d.id,new this.ConnectorEdge(u,d.id,r,u,null,null,10))})),null!=s&&null!=d&&n.transform.transformPoints(s.x,s.y,d.x,d.y,!0,this,function(n,i,o,a){var r=new e.common.Polyline;r.addSegment(new e.common.MoveSegment(n,i)),r.addSegment(new e.common.LineSegment(o,a)),t.graph.addEdge(s.id,d.id,new this.ConnectorEdge(s.id,d.id,r,null,null,null,0))}),null!=d&&(s=d)}null!=s&&a.push(new this.ConnectorDestination({id:s.id,bundleid:this.getId(t),x:s.x,y:s.y,isSquared:!0,visibility:4}))}o=n.treeItemsPositions[this.matrixNodeId].actualPosition,r=new this.ConnectorDestination({id:this.connectionId,x:o.horizontalCenter(),y:o.bottom()}),this.traceFork(t,n,i,r,a,!0,!0,0,i.showExtraArrows)},e.common.MatrixConnectorBundle.prototype.getNodeIndex=function(e,t,n,i){var o=null;return i?(e=2*e+(n?0:1),this.matrixWidth>e&&(o=t*this.matrixWidth+e)):0<=(e=2*e+(n?-1:0))&&e<this.matrixWidth&&(o=t*this.matrixWidth+e),o},e.common.VerticalConnectorBundle=function(e,t){this.fromItems=e,this.toItems=t,this.childConnectorId={},this.fromStackSize=this.fromOffset=0},e.common.VerticalConnectorBundle.prototype=new e.common.BaseConnectorBundle,e.common.VerticalConnectorBundle.prototype.trace=function(t,n,i){var o,a,r,s,l,m,c,h,u,d=0===i.connectorType;if(o=[],0<this.fromItems.length){for(m=0,a=(r=this.fromItems).length;m<a;m+=1)s=r[m],l=n.treeItemsPositions[s],s=new this.ConnectorDestination({id:n.nestedLayoutBottomConnectorIds.hasOwnProperty(s)?n.nestedLayoutBottomConnectorIds[s]:s,bundleid:this.getId(t),x:l.actualPosition.horizontalCenter(),y:l.actualPosition.bottom(),isSquared:!0,visibility:l.actualVisibility}),o.push(s);o.sort(function(e,t){return e.x-t.x}),u=l.bottomConnectorShift-l.bottomConnectorInterval*(this.fromStackSize-this.fromOffset+1)}if(a=[],0<this.toItems.length){for(h=!1,r=this.toItems,m=0;m<r.length;m+=1){if(s=r[m],l=n.treeItemsPositions[s],c=!0,n.hasGraphics)switch(l.actualVisibility){case 2:case 3:c=d}s=new this.ConnectorDestination({id:s,bundleid:this.getId(t),x:l.actualPosition.horizontalCenter()+0,y:l.actualPosition.top(),isSquared:c,visibility:l.actualVisibility}),a.push(s),h=h||s.isSquared}a.sort(function(e,t){return e.x-t.x}),c=l.topConnectorShift}r=1==a.length?a[0].x:1==o.length?o[0].x:0<a.length&&0<o.length?(o[0].x+o[o.length-1].x+a[0].x+a[a.length-1].x)/4:0<a.length?(a[0].x+a[a.length-1].x)/2:(o[0].x+o[o.length-1].x)/2;var g=null;0<o.length&&(g=new this.ConnectorDestination({id:this.getId(t),x:r,y:u}),this.traceFork(t,n,i,g,o,!0,!0,this.fromOffset,i.showExtraArrows&&0<a.length));var p=null;0<a.length&&(p=new this.ConnectorDestination({id:this.getId(t),x:r,y:c}),null!=g&&p.y==g.y&&(p=g),this.traceFork(t,n,i,p,a,h,!1,0,i.showExtraArrows&&0<o.length)),null!=g&&null!=p&&g.id!=p.id&&n.transform.transformPoints(g.x,g.y,p.x,p.y,!0,this,function(n,i,o,a){var r=new e.common.Polyline;r.addSegment(new e.common.MoveSegment(n,i)),r.addSegment(new e.common.LineSegment(o,a)),t.graph.addEdge(g.id,p.id,new this.ConnectorEdge(g.id,p.id,r,null,null,null,0))})},e.orgdiagram.LevelVisibility=function(e,t){this.level=e,this.currentvisibility=t},e.orgdiagram.OrgItem=function(e){var t,n,i;this.id=null,this.isActive=this.isVisible=!0,this.hasVisibleChildren=!1,this.placeAssistantsAboveChildren=this.placeAdvisersAboveChildren=this.childrenPlacementType=this.adviserPlacementType=this.itemType=0,this.level=this.levelOffset=null,this.hideChildrenConnection=this.hideParentConnection=!1,this.childIndex=null;var o="id parent isVisible isActive itemType adviserPlacementType childrenPlacementType placeAdvisersAboveChildren placeAssistantsAboveChildren levelOffset".split(" ");for(t=0,n=o.length;t<n;t+=1)i=o[t],e.hasOwnProperty(i)&&(this[i]=e[i])},e.orgdiagram.Template=function(e,t,n,i,o){this.templateConfig=e,this.itemTemplate=t,this.highlightTemplate=n,this.dotHighlightTemplate=i,this.cursorTemplate=o},e.orgdiagram.TemplateParams=function(){this.template=null,this.hasGroupTitle=this.hasButtons=this.hasSelectorCheckbox=this.isActive=!1,this.buttons=[],this.onButtonsRender=null},e.orgdiagram.TreeItem=function(){this.visualAggregatorId=this.id=null,this.visualDepth=1,this.partners=[],this.visibility=1,this.actualItemType=null,this.relationDegree=this.gravity=this.connectorPlacement=0},e.orgdiagram.TreeItemPosition=function(t){if(this.partnerConnectorOffset=0,this.levelPosition=this.level=null,this.rightPadding=this.leftPadding=this.offset=0,this.actualVisibility=1,this.topConnectorShift=this.horizontalConnectorsShift=this.contentPosition=this.actualPosition=this.actualSize=null,this.topConnectorInterval=0,this.bottomConnectorShift=null,this.bottomConnectorInterval=0,this.rightMedianOffset=this.leftMedianOffset=null,null!=t)for(var n in t)if(t.hasOwnProperty(n))switch(n){case"actualPosition":this.actualPosition=new e.common.Rect(t.actualPosition);break;default:this[n]=t[n]}},e.orgdiagram.TreeLevelConnectorStackSize=function(){this.parentsStackSize=0},e.orgdiagram.TreeLevelPosition=function(e){if(this.actualVisibility=this.currentvisibility=1,this.currentOffset=this.levelSpace=this.connectorShift=this.topConnectorShift=this.horizontalConnectorsDepth=this.nextLevelShift=this.depth=this.shift=0,this.labels=[],this.labelsRect=null,this.showLabels=!0,this.hasFixedLabels=!1,null!=e)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},e.orgdiagram.TreeLevelPosition.prototype.setShift=function(e,t,n,i,o){return this.shift=e,this.levelSpace=t,this.topConnectorShift=-t/2-n,this.connectorShift=this.depth+i+(o+1)*(t/2),this.nextLevelShift=n+this.depth+i+t+o*t/2},e.orgdiagram.TreeLevelPosition.prototype.shiftDown=function(e){this.shift+=e},e.orgdiagram.TreeLevelPosition.prototype.toString=function(){return this.currentvisibility},e.orgdiagram.AlignDiagramTask=function(t,n,i,o,a,r,s,l){var m,c,h,u,d,g,p,f,T={treeItemsPositions:{},panelSize:null};return{process:function(){var y=new e.common.Size(s.getContentSize()),k=new e.common.Size(a.getOptimalPanelSize());switch(f=p=null,m=null!=r?r.getActiveItems():{},c=s.getItemsPositions(),h=n.getOptions(),u=t.getOptions(),d=i.getOptions(),g=o.getOptions(),u.orientationType){case 2:case 3:k.invert()}switch(k.scale(1/g.scale),T.panelSize=k,T.treeItemsPositions=c,h.pageFitMode){case 5:T.panelSize=new e.common.Size(y);break;default:if(T.panelSize=new e.common.Size(y),y.width<k.width){T.treeItemsPositions={};var v,w=y.width,C=k.width;if(l)v=(C-w)/2;else switch(d.horizontalAlignment){case 1:v=0;break;case 2:v=C-w;break;case 0:v=(C-w)/2}var b;w=T.treeItemsPositions;for(b in c)c.hasOwnProperty(b)&&((C=new e.orgdiagram.TreeItemPosition(c[b])).actualPosition.translate(v,0),w[b]=C);T.panelSize.width=k.width}y.height<k.height&&(T.panelSize.height=k.height)}switch(u.orientationType){case 2:case 3:T.panelSize.invert()}return!0},getItemPosition:function(e){return T.treeItemsPositions[e]},getItemsPositions:function(){return T.treeItemsPositions},getContentSize:function(){return T.panelSize},getTreeItemForMousePosition:function(t,n,i){var o,a=null,r=null,s=g.scale;if(null==p)for(o in p=e.common.SpatialIndex(function(){var e,t=[],n={};for(e in T.treeItemsPositions)if(T.treeItemsPositions.hasOwnProperty(e)){var i=T.treeItemsPositions[e];switch(i.actualVisibility){case 1:case 2:case 3:i=i.actualPosition,i=Math.max(i.width,i.height),n.hasOwnProperty(i)||(n[i]=!0,t.push(i))}}return t}()),T.treeItemsPositions)if(T.treeItemsPositions.hasOwnProperty(o)){var l=T.treeItemsPositions[o];if(m.hasOwnProperty(o))switch(l.actualVisibility){case 1:case 2:case 3:(l=new e.common.Rect(l.actualPosition)).context=o,p.addRect(l)}}o=p;var c;t/=s,n/=s,s=new e.common.Rect(t,n,0,0);return c=new e.common.Point(t,n),s.offset(i,i,i,i),o.loopArea(this,s,function(e){var i=e.context;if(e.contains(t,n))return a=i,!0;switch(T.treeItemsPositions[i].actualVisibility){case 2:case 3:e=c.distanceTo(e.horizontalCenter(),e.verticalCenter()),(null==r||e<r)&&(r=e,a=i)}}),a},getNextItem:function(t,n){var i,o;if(null==f)for(i in f=e.common.KeyboardNavigationManager(),T.treeItemsPositions)if(T.treeItemsPositions.hasOwnProperty(i)){var a=T.treeItemsPositions[i];if(m.hasOwnProperty(i))switch(a.actualVisibility){case 1:a=new e.common.Rect(a.actualPosition),f.addRect(a,i)}}switch(i=f,n){case 0:o=i.getItemAbove(t);break;case 1:o=i.getItemBelow(t);break;case 2:o=i.getItemOnLeft(t);break;case 3:o=i.getItemOnRight(t)}return o}}},e.orgdiagram.ApplyLayoutChangesTask=function(t,n,i,o,a,r){var s=null;return{process:function(){var e=t(),l=a.getOptions(),m=i.getOptions(),c=r.getContentSize(),h=o.getScrollPanelSize();return e.resize("placeholder",c.width,c.height),s=n({scale:l.scale,contentSize:c,scrollPanelSize:h,autoSize:5==m.pageFitMode,autoSizeMaximum:m.autoSizeMaximum,autoSizeMinimum:m.autoSizeMinimum}),!0},getOptimalPanelSize:function(){return new e.common.Size(s.width-25,s.height-25)}}},e.orgdiagram.CenterOnCursorTask=function(t,n,i,o,a,r,s){var l,m=null;return{process:function(){var c;c=t.getOptions();var h,u=o.getCursorTreeItem(),d=a.getItemPosition(u);u=new e.common.Size(a.getContentSize());return h=s.getOptions().scale,m=i.getPlaceholderOffset(),c.forceCenterOnCursor&&(l=r.getTransform(),null!=d&&((c=function(t){var n=!1;return l.transformRect(t.x,t.y,t.width,t.height,!0,this,function(t,i,o,a){n=new e.common.Rect(t,i,o,a)}),n}(d.actualPosition)).scale(h),u.scale(h),h=n.getScrollPanelSize(),m=new e.common.Point(Math.max(Math.min(c.horizontalCenter()-h.width/2,u.width-h.width),0),Math.max(Math.min(c.verticalCenter()-h.height/2,u.height-h.height),0)))),!0},getPlaceholderOffset:function(){return m}}},e.orgdiagram.CreateTransformTask=function(t,n){var i=null;return{process:function(){var o=t.getOptions(),a=new e.common.Size(n.getContentSize());return(i=new e.common.Transform).setOrientation(o.orientationType),i.size=new e.common.Size(a),!0},getTransform:function(){return i},getTreeItemForMousePosition:function(e,t,o){var a=null;return i.transformPoint(e,t,!1,this,function(e,t){a=n.getTreeItemForMousePosition(e,t,o)}),a},description:"Create oordiante system tranfromation object."}},e.orgdiagram.CurrentControlSizeTask=function(t,n){var i={scrollPanelSize:null},o={},a=new e.common.ObjectReader({scrollPanelSize:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!0),height:new e.common.ValueReader(["number"],!0)},!0)});return{process:function(){var e={isChanged:!1,hash:o},r=t.getOptions(),s=!1,l=n.getOptions();switch(i=a.read(i,r,"layout",e),l.pageFitMode){case 1:case 2:case 3:case 0:s=e.isChanged}return s},getScrollPanelSize:function(){return i.scrollPanelSize},getOptimalPanelSize:function(){return new e.common.Size(i.scrollPanelSize.width-25,i.scrollPanelSize.height-25)}}},e.orgdiagram.CurrentScrollPositionTask=function(t){var n={placeholderOffset:null},i={},o=new e.common.ObjectReader({placeholderOffset:new e.common.ObjectReader({x:new e.common.ValueReader(["number"],!0),y:new e.common.ValueReader(["number"],!0)},!0)});return{process:function(){var e={isChanged:!1,hash:i},a=t.getOptions();return n=o.read(n,a,"layout",e),e.isChanged},getPlaceholderOffset:function(){return n.placeholderOffset}}},e.orgdiagram.BackgroundAnnotationOptionTask=function(t,n){var i=[],o={},a=new e.common.ArrayReader(new e.common.ObjectReader({items:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0),includeChildren:new e.common.ValueReader(["boolean"],!1,n.includeChildren),zOrderType:new e.common.EnumerationReader(e.common.ZOrderType,!1,n.zOrderType),offset:new e.common.ObjectReader({left:new e.common.ValueReader(["number"],!1,n.offset.left),top:new e.common.ValueReader(["number"],!1,n.offset.top),right:new e.common.ValueReader(["number"],!1,n.offset.right),bottom:new e.common.ValueReader(["number"],!1,n.offset.bottom)},!1,n.offset),lineWidth:new e.common.ValueReader(["number"],!1,n.lineWidth),opacity:new e.common.ValueReader(["number"],!1,n.opacity),borderColor:new e.common.ValueReader(["string"],!1,n.borderColor),fillColor:new e.common.ValueReader(["string"],!1,n.fillColor),lineType:new e.common.EnumerationReader(e.common.LineType,!1,n.lineType),selectItems:new e.common.ValueReader(["boolean"],!1,n.selectItems)}),!1);return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getAnnotations(4,null),"annotations",e),e.isChanged},getAnnotations:function(){return i}}},e.orgdiagram.ConnectorAnnotationOptionTask=function(t,n,i){var o=[],a={},r=new e.common.ArrayReader(new e.common.ObjectReader({zOrderType:new e.common.EnumerationReader(e.common.ZOrderType,!1,n.zOrderType),fromItem:new e.common.ValueReader(["string","number"],!0),toItem:new e.common.ValueReader(["string","number"],!0),connectorShapeType:new e.common.EnumerationReader(e.common.ShapeType,!1,n.connectorShapeType),connectorPlacementType:new e.common.EnumerationReader(e.common.ConnectorPlacementType,!1,n.connectorPlacementType),labelPlacementType:new e.common.EnumerationReader(e.common.ConnectorLabelPlacementType,!1,n.labelPlacementType),offset:new e.common.ObjectReader({left:new e.common.ValueReader(["number"],!1,n.offset.left),top:new e.common.ValueReader(["number"],!1,n.offset.top),right:new e.common.ValueReader(["number"],!1,n.offset.right),bottom:new e.common.ValueReader(["number"],!1,n.offset.bottom)},!1,n.offset),lineWidth:new e.common.ValueReader(["number"],!1,n.lineWidth),color:new e.common.ValueReader(["string"],!1,n.color),lineType:new e.common.EnumerationReader(e.common.LineType,!1,n.lineType),selectItems:new e.common.ValueReader(["boolean"],!1,n.selectItems),label:new e.common.ValueReader(["string","object"],!1,n.label),labelSize:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,n.labelSize.width),height:new e.common.ValueReader(["number"],!1,n.labelSize.height)},!1,n.labelSize)}),!1);return{process:function(){var e={isChanged:!1,hash:a};return o=r.read(o,t.getAnnotations(0,i),"annotations",e),e.isChanged},getAnnotations:function(){return o}}},e.orgdiagram.HighlightPathAnnotationOptionTask=function(t,n,i){var o=[],a={},r=new e.common.ArrayReader(new e.common.ObjectReader({zOrderType:new e.common.EnumerationReader(e.common.ZOrderType,!1,n.zOrderType),lineWidth:new e.common.ValueReader(["number"],!1,n.lineWidth),opacity:new e.common.ValueReader(["number"],!1,n.opacity),color:new e.common.ValueReader(["string"],!1,n.color),lineType:new e.common.EnumerationReader(e.common.LineType,!1,n.lineType),items:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!1),selectItems:new e.common.ValueReader(["boolean"],!1,n.selectItems),showArrows:new e.common.ValueReader(["boolean"],!1,n.showArrows)},!1));return{process:function(){var e={isChanged:!1,hash:a};return o=r.read(o,t.getAnnotations(2,i),"annotations",e),e.isChanged},getAnnotations:function(){return o}}},e.orgdiagram.ShapeAnnotationOptionTask=function(t,n,i){var o=[],a={},r=new e.common.ArrayReader(new e.common.ObjectReader({zOrderType:new e.common.EnumerationReader(e.common.ZOrderType,!1,n.zOrderType),items:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0),shapeType:new e.common.EnumerationReader(e.common.ShapeType,!1,n.shapeType),offset:new e.common.ObjectReader({left:new e.common.ValueReader(["number"],!1,n.offset.left),top:new e.common.ValueReader(["number"],!1,n.offset.top),right:new e.common.ValueReader(["number"],!1,n.offset.right),bottom:new e.common.ValueReader(["number"],!1,n.offset.bottom)},!1,n.offset),lineWidth:new e.common.ValueReader(["number"],!1,n.lineWidth),cornerRadius:new e.common.ValueReader(["string"],!1,n.cornerRadius),opacity:new e.common.ValueReader(["number"],!1,n.opacity),borderColor:new e.common.ValueReader(["string"],!1,n.borderColor),fillColor:new e.common.ValueReader(["string"],!1,n.fillColor),lineType:new e.common.EnumerationReader(e.common.LineType,!1,n.lineType),selectItems:new e.common.ValueReader(["boolean"],!1,n.selectItems),label:new e.common.ValueReader(["string","object"],!1,n.label),labelSize:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,n.labelSize.width),height:new e.common.ValueReader(["number"],!1,n.labelSize.height)},!1,n.labelSize),labelPlacement:new e.common.EnumerationReader(e.common.PlacementType,!1,n.labelPlacement),labelOffset:new e.common.ValueReader(["number"],!1,n.labelOffset)},!1));return{process:function(){var e={isChanged:!1,hash:a};return o=r.read(o,t.getAnnotations(1,i),"annotations",e),e.isChanged},getAnnotations:function(){return o}}},e.orgdiagram.SplitAnnotationsOptionTask=function(t){var n={};return{process:function(){var i,o,a,r,s,l=t.getOptions().annotations,m={};if(e.common.isArray(l))for(i=0,o=l.length;i<o;i+=1){switch(r=(a=l[i]).annotationType){case 1:case 0:case 2:switch(a.zOrderType){case 1:s=1;break;default:s=2}break;default:s=null}null!=r&&(r=1e3*r+(s||0),m.hasOwnProperty(r)||(m[r]=[]),m[r].push(a))}return n=m,!0},getAnnotations:function(e,t){return n[1e3*e+(t||0)]}}},e.orgdiagram.CursorItemOptionTask=function(t,n){var i={},o=new e.common.ObjectReader({cursorItem:new e.common.ValueReader(["string","number"],!0),navigationMode:new e.common.EnumerationReader(e.common.NavigationMode,!1,n.navigationMode)});return{process:function(){var e={isChanged:!1};return i=o.read(i,t.getOptions(),"options",e),e.isChanged},getCursorItem:function(){return i.cursorItem},hasCursorEnabled:function(){switch(i.navigationMode){case 0:case 1:return!0}return!1},description:"Checks currenct cursor item option."}},e.orgdiagram.CursorSelectionPathModeOptionTask=function(t,n){var i={},o=new e.common.ObjectReader({selectionPathMode:new e.common.EnumerationReader(e.common.SelectionPathMode,!1,n.selectionPathMode)});return{process:function(){var e={isChanged:!1};return i=o.read(i,t.getOptions(),"options",e),e.isChanged},getSelectionPathMode:function(){return i.selectionPathMode},description:"Checks cursor selection path option."}},e.orgdiagram.HighlightItemOptionTask=function(t,n){var i={},o=new e.common.ObjectReader({highlightItem:new e.common.ValueReader(["string","number"],!0),navigationMode:new e.common.EnumerationReader(e.common.NavigationMode,!1,n.navigationMode),highlightGravityRadius:new e.common.ValueReader(["number"],!1,n.highlightGravityRadius)});return{process:function(){var e={isChanged:!1};return i=o.read(i,t.getOptions(),"options",e),e.isChanged},getHighlightItem:function(){return i.highlightItem},hasHighlightEnabled:function(){switch(i.navigationMode){case 0:case 3:return!0}return!1},getGravityRadius:function(){return i.highlightGravityRadius},description:"Checks highlight item option."}},e.orgdiagram.SelectedItemsOptionTask=function(t){var n={},i={},o=new e.common.ObjectReader({selectedItems:new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0)});return{process:function(){var e={isChanged:!1,hash:i},a=t.getOptions();return n=o.read(n,a,"options",e),e.isChanged},getSelectedItems:function(){return n.selectedItems},description:"Checks user selected items option."}},e.orgdiagram.CalloutOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({calloutMaximumVisibility:new e.common.EnumerationReader(e.common.Visibility,!1,n.calloutMaximumVisibility),showCallout:new e.common.ValueReader(["boolean"],!1,n.showCallout),calloutPlacementOffset:new e.common.ValueReader(["number"],!1,n.calloutPlacementOffset),orientationType:new e.common.EnumerationReader(e.common.OrientationType,!1,n.orientationType),defaultTemplateName:new e.common.ValueReader(["string"],!0),defaultCalloutTemplateName:new e.common.ValueReader(["string"],!0),calloutfillColor:new e.common.ValueReader(["string"],!1,n.calloutfillColor),calloutBorderColor:new e.common.ValueReader(["string"],!0),calloutOffset:new e.common.ValueReader(["number"],!1,n.calloutOffset),calloutCornerRadius:new e.common.ValueReader(["string"],!1,n.calloutCornerRadius),calloutPointerWidth:new e.common.ValueReader(["string"],!1,n.calloutPointerWidth),calloutLineWidth:new e.common.ValueReader(["number"],!1,n.calloutLineWidth),calloutOpacity:new e.common.ValueReader(["number"],!1,n.calloutOpacity),items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),showCallout:new e.common.EnumerationReader(e.common.Enabled,!1,n.showCallout),calloutTemplateName:new e.common.ValueReader(["string"],!0),templateName:new e.common.ValueReader(["string"],!0)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i},getItemOptions:function(e){return o["options-items"][e]},description:"Checks item callout options."}},e.orgdiagram.ConnectorsOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({arrowsDirection:new e.common.EnumerationReader(e.common.GroupByType,!1,n.arrowsDirection),showExtraArrows:new e.common.ValueReader(["boolean"],!1,n.showExtraArrows),extraArrowsMinimumSpace:new e.common.ValueReader(["number"],!1,n.extraArrowsMinimumSpace),connectorType:new e.common.EnumerationReader(e.common.ConnectorType,!1,n.hasOwnProperty("connectorType")?n.connectorType:0),showNeigboursConnectorsHighlighted:new e.common.EnumerationReader(e.common.ConnectorType,!1,!!n.hasOwnProperty("showNeigboursConnectorsHighlighted")&&n.showNeigboursConnectorsHighlighted),elbowType:new e.common.EnumerationReader(e.common.ElbowType,!1,n.elbowType),bevelSize:new e.common.ValueReader(["number"],!1,n.bevelSize),elbowDotSize:new e.common.ValueReader(["number"],!1,n.elbowDotSize),linesColor:new e.common.ValueReader(["string"],!1,n.linesColor),linesWidth:new e.common.ValueReader(["number"],!1,n.linesWidth),linesType:new e.common.EnumerationReader(e.common.LineType,!1,n.linesType),highlightLinesColor:new e.common.ValueReader(["string"],!1,n.highlightLinesColor),highlightLinesWidth:new e.common.ValueReader(["number"],!1,n.highlightLinesWidth),highlightLinesType:new e.common.EnumerationReader(e.common.LineType,!1,n.highlightLinesType)});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i},description:"Checks connector lines drawing options."}},e.orgdiagram.ItemsContentOptionTask=function(t,n){var i={},o={},a={},r=new e.common.ObjectReader({items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),title:new e.common.ValueReader(["string"],!0),description:new e.common.ValueReader(["string"],!0),image:new e.common.ValueReader(["string"],!0),context:new e.common.ValueReader(["string","number","object"],!0),itemTitleColor:new e.common.ValueReader(["string"],!1,n.itemTitleColor),groupTitle:new e.common.ValueReader(["string"],!1,n.groupTitle),groupTitleColor:new e.common.ValueReader(["string"],!1,n.groupTitleColor)}),!0,"id",!0,!0)});return{process:function(){var e={isChanged:!1,hash:o,sourceHash:a};return i=r.read(i,t.getOptions(),"options",e),e.isChanged},getItems:function(){return i.items},getConfig:function(e){return a["options-items"][e]},description:"Checks items configuration options effecting their placement in layout."}},e.orgdiagram.ItemsOptionTask=function(t,n){var i={},o={},a={},r=new e.common.ObjectReader({items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),parent:new e.common.ValueReader(["string","number"],!0),itemType:new e.common.EnumerationReader(e.orgdiagram.ItemType,!1,n.itemType),adviserPlacementType:new e.common.EnumerationReader(e.common.AdviserPlacementType,!1,n.adviserPlacementType),childrenPlacementType:new e.common.EnumerationReader(e.common.ChildrenPlacementType,!1,n.childrenPlacementType),placeAdvisersAboveChildren:new e.common.EnumerationReader(e.common.Enabled,!1,n.placeAdvisersAboveChildren),placeAssistantsAboveChildren:new e.common.EnumerationReader(e.common.Enabled,!1,n.placeAssistantsAboveChildren),isVisible:new e.common.ValueReader(["boolean"],!1,n.isVisible),isActive:new e.common.ValueReader(["boolean"],!1,n.isActive),levelOffset:new e.common.ValueReader(["number"],!0)}),!0,"id",!0,!0)});return{process:function(){var e={isChanged:!1,hash:o,sourceHash:a};return i=r.read(i,t.getOptions(),"options",e),e.isChanged},getItems:function(){return i.items},getConfig:function(e){return a["options-items"][e]},description:"Checks items configuration options effecting their placement in layout."}},e.orgdiagram.ItemsSizesOptionTask=function(t,n,i,o){var a={},r={},s=new e.common.ObjectReader({defaultTemplateName:new e.common.ValueReader(["string"],!0),defaultLabelAnnotationTemplate:new e.common.ValueReader(["string"],!0),hasSelectorCheckbox:new e.common.EnumerationReader(e.common.Enabled,!1,n.hasSelectorCheckbox),hasButtons:new e.common.EnumerationReader(e.common.Enabled,!1,n.hasButtons),buttonsPanelSize:new e.common.ValueReader(["number"],!1,n.buttonsPanelSize),groupTitlePanelSize:new e.common.ValueReader(["number"],!1,n.groupTitlePanelSize),groupTitlePlacementType:new e.common.EnumerationReader(e.common.AdviserPlacementType,!1,n.groupTitlePlacementType),checkBoxPanelSize:new e.common.ValueReader(["number"],!1,n.checkBoxPanelSize),selectCheckBoxLabel:new e.common.ValueReader(["string"],!1,n.selectCheckBoxLabel),buttons:new e.common.ArrayReader(new e.common.ObjectReader({name:new e.common.ValueReader(["string"],!0),icon:new e.common.ValueReader(["string"],!0),text:new e.common.ValueReader(["boolean"],!1,!1),tooltip:new e.common.ValueReader(["string"],!0),size:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,o.size.width),height:new e.common.ValueReader(["number"],!1,o.size.height)},!1,o.size)}),!0,"name"),onButtonsRender:new e.common.FunctionReader,pageFitMode:new e.common.EnumerationReader(e.common.PageFitMode,!1,n.pageFitMode),minimalVisibility:new e.common.EnumerationReader(e.common.Visibility,!1,n.minimalVisibility),selectionPathMode:new e.common.EnumerationReader(e.common.SelectionPathMode,!1,n.selectionPathMode),autoSizeMinimum:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,n.autoSizeMinimum.width),height:new e.common.ValueReader(["number"],!1,n.autoSizeMinimum.height)},!1,n.autoSizeMinimum),autoSizeMaximum:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,n.autoSizeMaximum.width),height:new e.common.ValueReader(["number"],!1,n.autoSizeMaximum.height)},!1,n.autoSizeMaximum),scale:new e.common.ValueReader(["number"],!1,n.scale),maximumScale:new e.common.ValueReader(["number"],!1,n.maximumScale),minimumScale:new e.common.ValueReader(["number"],!1,n.minimumScale),normalLevelShift:new e.common.ValueReader(["number"],!1,n.normalLevelShift),dotLevelShift:new e.common.ValueReader(["number"],!1,n.dotLevelShift),lineLevelShift:new e.common.ValueReader(["number"],!1,n.lineLevelShift),normalItemsInterval:new e.common.ValueReader(["number"],!1,n.normalItemsInterval),dotItemsInterval:new e.common.ValueReader(["number"],!1,n.dotItemsInterval),lineItemsInterval:new e.common.ValueReader(["number"],!1,n.lineItemsInterval),cousinsIntervalMultiplier:new e.common.ValueReader(["number"],!1,n.cousinsIntervalMultiplier),verticalAlignment:new e.common.EnumerationReader(e.common.VerticalAlignmentType,!1,n.verticalAlignment),items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),groupTitle:new e.common.ValueReader(["string","number"],!0),isVisible:new e.common.ValueReader(["boolean","number"],!1,i.isVisible),isActive:new e.common.ValueReader(["boolean","number"],!1,i.isActive),hasSelectorCheckbox:new e.common.EnumerationReader(e.common.Enabled,!1,i.hasSelectorCheckbox),hasButtons:new e.common.EnumerationReader(e.common.Enabled,!1,i.hasButtons),templateName:new e.common.ValueReader(["string"],!0)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:r};return a=s.read(a,t.getOptions(),"options",e),e.isChanged},getItemOptions:function(e){return r["options-items"][e]},getOptions:function(){return a},description:"Checks items size options."}},e.orgdiagram.LabelsOptionTask=function(t,n,i){var o={},a={},r=new e.common.ObjectReader({showLabels:new e.common.EnumerationReader(e.common.Enabled,!1,n.showLabels),labelOffset:new e.common.ValueReader(["number"],!1,n.labelOffset),labelFontSize:new e.common.ValueReader(["string"],!1,n.labelFontSize),labelFontFamily:new e.common.ValueReader(["string"],!1,n.labelFontFamily),labelFontStyle:new e.common.ValueReader(["string"],!1,n.labelFontStyle),labelFontWeight:new e.common.ValueReader(["string"],!1,n.labelFontWeight),labelColor:new e.common.ValueReader(["string"],!1,n.labelColor),labelSize:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,n.labelSize.width),height:new e.common.ValueReader(["number"],!1,n.labelSize.height)},!1,n.labelSize),labelOrientation:new e.common.EnumerationReader(e.text.TextOrientationType,!1,n.labelOrientation),labelPlacement:new e.common.EnumerationReader(e.common.PlacementType,!1,n.labelPlacement),arrowsDirection:new e.common.EnumerationReader(e.common.GroupByType,!1,n.arrowsDirection),items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),label:new e.common.ValueReader(["string","number","object"],!0),showLabel:new e.common.EnumerationReader(e.common.Enabled,!1,i.showLabel),labelSize:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,0),height:new e.common.ValueReader(["number"],!1,0)},!0),labelOrientation:new e.common.EnumerationReader(e.text.TextOrientationType,!1,i.labelOrientation),labelPlacement:new e.common.EnumerationReader(e.common.PlacementType,!1,i.labelPlacement)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:a};return o=r.read(o,t.getOptions(),"options",e),e.isChanged},getItemOptions:function(e){return a["options-items"][e]},getItemsOptions:function(){return a["options-items"]},getOptions:function(){return o},description:"Checks items labels options."}},e.orgdiagram.LayoutOptionsTask=function(e){var t={};return{process:function(){return t=e(),!0},getOptions:function(){return t},description:"Raw layout options."}},e.orgdiagram.MinimizedItemsOptionTask=function(t){var n={},i={},o=new e.common.ObjectReader({minimizedItemShapeType:new e.common.EnumerationReader(e.common.ShapeType,!0),items:new e.common.ArrayReader(new e.common.ObjectReader({id:new e.common.ValueReader(["string","number"],!0),minimizedItemShapeType:new e.common.EnumerationReader(e.common.ShapeType,!0),itemTitleColor:new e.common.ValueReader(["string"],!0)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:i};return n=o.read(n,t.getOptions(),"options",e),e.isChanged},getItemOptions:function(e){return i["options-items"][e]},getOptions:function(){return n},description:"Checks minimized items drawing options."}},e.orgdiagram.OptionsTask=function(e){return{process:function(){return!0},getOptions:e,description:"Raw options."}},e.orgdiagram.OrientationOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({orientationType:new e.common.EnumerationReader(e.common.OrientationType,!1,n.orientationType)});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i},description:"Checks diagram orientation options."}},e.orgdiagram.ScaleOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({scale:new e.common.ValueReader(["number"],!1,n.scale),minimumScale:new e.common.ValueReader(["number"],!1,n.minimumScale),maximumScale:new e.common.ValueReader(["number"],!1,n.maximumScale)});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i},description:"Checks control scale options."}},e.orgdiagram.TemplatesOptionTask=function(t,n,i,o){var a={},r={},s=new e.common.ObjectReader({groupTitleVerticalAlignment:new e.common.EnumerationReader(e.common.VerticalAlignmentType,!1,n.groupTitleVerticalAlignment),groupTitleHorizontalAlignment:new e.common.EnumerationReader(e.common.HorizontalAlignmentType,!1,n.groupTitleHorizontalAlignment),groupTitleOrientation:new e.common.EnumerationReader(e.text.TextOrientationType,!1,n.groupTitleOrientation),groupTitleFontSize:new e.common.ValueReader(["string"],!1,n.groupTitleFontSize),groupTitleFontFamily:new e.common.ValueReader(["string"],!1,n.groupTitleFontFamily),groupTitleColor:new e.common.ValueReader(["string"],!1,n.groupTitleColor),groupTitleFontWeight:new e.common.ValueReader(["string"],!1,n.groupTitleFontWeight),groupTitleFontStyle:new e.common.ValueReader(["string"],!1,n.groupTitleFontStyle),itemTitleFirstFontColor:new e.common.ValueReader(["string"],!1,n.itemTitleFirstFontColor),itemTitleSecondFontColor:new e.common.ValueReader(["string"],!1,n.itemTitleSecondFontColor),selectCheckBoxLabel:new e.common.ValueReader(["string"],!1,n.selectCheckBoxLabel),onItemRender:new e.common.FunctionReader,onCursorRender:new e.common.FunctionReader,onHighlightRender:new e.common.FunctionReader,templates:new e.common.ArrayReader(new e.common.ObjectReader({name:new e.common.ValueReader(["string"],!0),isActive:new e.common.ValueReader(["boolean"],!1,o.isActive),itemSize:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,o.itemSize.width),height:new e.common.ValueReader(["number"],!1,o.itemSize.height)},!1,o.itemSize),itemBorderWidth:new e.common.ValueReader(["number"],!1,o.itemBorderWidth),itemTemplate:new e.common.ValueReader(["string","object"],!0),minimizedItemShapeType:new e.common.EnumerationReader(e.common.ShapeType,!0),minimizedItemSize:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,o.minimizedItemSize.width),height:new e.common.ValueReader(["number"],!1,o.minimizedItemSize.height)},!1,o.minimizedItemSize),minimizedItemCornerRadius:new e.common.ValueReader(["number"],!0),minimizedItemLineWidth:new e.common.ValueReader(["number"],!1,o.minimizedItemLineWidth),minimizedItemBorderColor:new e.common.ValueReader(["string"],!0),minimizedItemLineType:new e.common.EnumerationReader(e.common.LineType,!1,o.minimizedItemLineType),minimizedItemFillColor:new e.common.ValueReader(["string"],!0),minimizedItemOpacity:new e.common.ValueReader(["number"],!1,o.minimizedItemOpacity),highlightPadding:new e.common.ObjectReader({left:new e.common.ValueReader(["number"],!1,o.highlightPadding.left),top:new e.common.ValueReader(["number"],!1,o.highlightPadding.top),right:new e.common.ValueReader(["number"],!1,o.highlightPadding.right),bottom:new e.common.ValueReader(["number"],!1,o.highlightPadding.bottom)},!1,o.highlightPadding),highlightBorderWidth:new e.common.ValueReader(["number"],!1,o.highlightBorderWidth),highlightTemplate:new e.common.ValueReader(["string","object"],!0),cursorPadding:new e.common.ObjectReader({left:new e.common.ValueReader(["number"],!1,o.cursorPadding.left),top:new e.common.ValueReader(["number"],!1,o.cursorPadding.top),right:new e.common.ValueReader(["number"],!1,o.cursorPadding.right),bottom:new e.common.ValueReader(["number"],!1,o.cursorPadding.bottom)},!1,o.cursorPadding),cursorBorderWidth:new e.common.ValueReader(["number"],!1,o.cursorBorderWidth),cursorTemplate:new e.common.ValueReader(["string","object"],!0),buttons:new e.common.ArrayReader(new e.common.ObjectReader({name:new e.common.ValueReader(["string"],!0),icon:new e.common.ValueReader(["string"],!0),text:new e.common.ValueReader(["boolean"],!1,!1),tooltip:new e.common.ValueReader(["string"],!0),size:new e.common.ObjectReader({width:new e.common.ValueReader(["number"],!1,i.size.width),height:new e.common.ValueReader(["number"],!1,i.size.height)},!1,i.size)}),!0,"name"),onButtonsRender:new e.common.FunctionReader}),!0,"name")});return{process:function(){var e={isChanged:!1,hash:r};return a=s.read(a,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return a},description:"Checks items template options."}},e.orgdiagram.VisualTreeOptionTask=function(t,n){var i={},o={},a=new e.common.ObjectReader({leavesPlacementType:new e.common.EnumerationReader(e.common.ChildrenPlacementType,!1,n.leavesPlacementType),childrenPlacementType:new e.common.EnumerationReader(e.common.ChildrenPlacementType,!1,n.childrenPlacementType),placeAdvisersAboveChildren:new e.common.ValueReader(["boolean"],!1,n.placeAdvisersAboveChildren),placeAssistantsAboveChildren:new e.common.ValueReader(["boolean"],!1,n.placeAssistantsAboveChildren),maximumColumnsInMatrix:new e.common.ValueReader(["number"],!1,n.maximumColumnsInMatrix),horizontalAlignment:new e.common.EnumerationReader(e.common.HorizontalAlignmentType,!1,n.horizontalAlignment)});return{process:function(){var e={isChanged:!1,hash:o};return i=a.read(i,t.getOptions(),"options",e),e.isChanged},getOptions:function(){return i},description:"Checks items layout options."}},e.orgdiagram.CollinearVectorBundle=function(){var t=new e.common.Rect,n=[],i=[];return{addVector:function(e,o){n.push(e),i.push(o),t.addRect(e.from.x,e.from.y),t.addRect(e.to.x,e.to.y)},resolve:function(){if(1==n.length)i[0](0,1,1);else{var o,a,r,s=e.common.pile();if(t.width>t.height)for(o=0,a=n.length;o<a;o+=1)r=n[o],s.add(r.from.x,r.to.x,i[o]);else for(o=0,a=n.length;o<a;o+=1)r=n[o],s.add(r.from.y,r.to.y,i[o]);s.resolve(this,function(e,t,n,i,o,a){n(i,o,a)})}}}},e.orgdiagram.ConnectorAnnotationOffsetResolver=function(){var t={};return{getOffset:function(n,i){var o=n.getLineKey();t.hasOwnProperty(o)||(t[o]=new e.orgdiagram.CollinearVectorBundle),t[o].addVector(n,i)},resolve:function(){for(var e in t)t.hasOwnProperty(e)&&t[e].resolve()}}},e.orgdiagram.DrawBackgroundAnnotationTask=function(t,n,i,o,a,r){function s(t,n,i){var o,a,s,m,h,u,d,g,p,f,T,y;n=0;for(o=t.length;n<o;n+=1)if(null!=(T=t[n]).items&&0<T.items.length){for((m=new e.common.MergedRectangles(l)).transform=c,h=new e.orgdiagram.BackgroundAnnotationConfig,a=0,s=(p=["opacity","lineWidth","borderColor","fillColor","lineType"]).length;a<s;a+=1)m[f=p[a]]=T.hasOwnProperty(f)?T[f]:h[f];for(l.activate("placeholder",2),u=[],g={},a=0,s=T.items.length;a<s;a+=1)h=T.items[a],null!=(y=r.getItemPosition(h))&&(g[h]=!0,(d=new e.common.Rect(y.actualPosition)).offset(T.offset),u.push(d),T.includeChildren&&i.loopChildren(this,h,function(t){g[t]||(g[t]=!0,y=r.getItemPosition(t),(d=new e.common.Rect(y.actualPosition)).offset(T.offset),u.push(d))}));m.draw(u)}}var l,m,c;return{process:function(){var e,i=o.getAnnotations();return(l=t()).reset("placeholder",2),0<i.length&&(m=r.getItemsPositions(),c=n.getTransform(),e=a.getNavigationFamily(),s(i,m,e)),!1}}},e.orgdiagram.DrawConnectorAnnotationTask=function(t,n,i,o,a,r,s,l){var m,c,h,u;return{process:function(){switch(m=t(),c=n.getTransform(),o.getOptions(),h=s.getTemplate(),u=new e.common.Size(r.getContentSize()),l){case 1:m.reset("placeholder",4);break;case 2:m.reset("placeholder",14)}return function(t,n){var i,o,a,r,s,d,g,p,f,T=new e.common.PolylinesBuffer,y=e.orgdiagram.ConnectorAnnotationOffsetResolver(),k=0;switch(l){case 1:m.activate("placeholder",4);break;case 2:m.activate("placeholder",14)}for(i=0,o=t.length;i<o;i+=1)p=t[i],k=Math.max(k,p.lineWidth);for(i=0,o=t.length;i<o;i+=1)if(null!=(p=t[i]).fromItem&&null!=p.toItem&&(a=n(p.fromItem),s=n(p.toItem),null!=a&&null!=s)){switch(r=a.actualPosition,d=s.actualPosition,p.connectorPlacementType){case 0:g=new e.common.ConnectorOffbeat;break;case 1:g=new e.common.ConnectorStraight}var v;c.transformRect(0,0,p.labelSize.width,p.labelSize.height,!1,this,function(t,n,i,o){v=new e.common.Size(i,o)});var w=null;c.transformRect(0,0,u.width,u.height,!1,this,function(t,n,i,o){w=new e.common.Size(i,o)}),s=new e.common.PaletteItem({lineColor:p.color,lineWidth:p.lineWidth,lineType:p.lineType}),a=!e.common.isNullOrEmpty(p.label),r=new e.common.Rect(r).offset(p.offset),d=new e.common.Rect(d).offset(p.offset),g.draw(T,s,r,d,3*p.lineWidth,6*k,v,w,p.connectorShapeType,4,p.labelPlacementType,a,y,function(t,n){!e.common.isNullOrEmpty(n.label)&&null!=t&&(c.transformRect(t.x,t.y,t.width,t.height,!0,this,function(n,i,o,a){t=new e.common.Rect(n,i,o,a)}),(f=new e.common.RenderEventArgs).context=n,m.template(t.x,t.y,0,0,0,0,t.width,t.height,h.template(),h.getHashCode(),h.render,f,null))},p)}y.resolve(),T.transform(c,!0),m.polylinesBuffer(T)}(a.getAnnotations(),r.getItemPosition),!1}}},e.orgdiagram.DrawConnectorsTask=function(t,n,i,o,a){return{process:function(){var r=t(),s=n.getGraph(),l=i.getOptions(),m=a.getPaletteManager();r.reset("placeholder",6),r.activate("placeholder",6);var c=new e.common.PolylinesBuffer,h=Math.round(l.elbowDotSize/2),u={},d={};return s.loopNodes(this,null,function(t){s.loopNodeEdges(this,t,function(n,i){if(!u.hasOwnProperty(n)){var a=null;1>=i.fromOffset?a=m.getPalette(1):(m.selectPalette(i.fromOffset),a=m.getPalette(0));var r=c.getPolyline(a);if(o&&null!=i.dotId&&0!=l.elbowType&&!d.hasOwnProperty(i.dotId)){a=c.getPolyline(r.arrowPaletteItem);var s=i.dotId==i.from?i.polyline.getStartPoint():i.polyline.getEndPoint();a.addSegment(new e.common.DotSegment(s.x-h,s.y-h,2*h,2*h,h)),d[i.dotId]=!0}a=null,null!=i.parentsArrowId&&1==l.arrowsDirection?a=i.parentsArrowId:null!=i.childrenArrowId&&2==l.arrowsDirection&&(a=i.childrenArrowId),null==a?(a=i.polyline.clone(),i.hasMiddle&&0!=l.arrowsDirection&&(s=!0,s=i.from==i.middleParent?2==l.arrowsDirection:1==l.arrowsDirection,a.addOffsetArrow(s,l.linesWidth,.4,l.extraArrowsMinimumSpace,function(e){e.mergeTo(c.getPolyline(r.arrowPaletteItem))})),i.from==t?a.mergeTo(r):r.addInverted(a)):(a==i.to?i.polyline.clone().mergeTo(r):r.addInverted(i.polyline.clone()),r.addArrow(l.linesWidth,function(e){e.mergeTo(c.getPolyline(e.paletteItem))}))}}),u[t]=!0}),r.polylinesBuffer(c),!1}}},e.orgdiagram.DrawCursorTask=function(t,n,i,o,a,r,s,l){function m(t){var n;if(c.activate("placeholder",11),null!=(d=a.getItemPosition(t))){var i=d.actualPosition,s=new e.common.Rect(d.contentPosition),m=r.getTemplateParams(t).template,u=m.templateConfig,d=u.cursorPadding;s.offset(d.left,d.top,d.right,d.bottom),(n=new e.common.RenderEventArgs).context=o.getConfig(t),n.isCursor=!0,n.isSelected=l.isSelected(t),n.templateName=u.name,h.transformRect(i.x,i.y,i.width,i.height,!0,this,function(e,t,i,o){c.template(e,t,i,o,s.x,s.y,s.width,s.height,m.cursorTemplate.template(),m.cursorTemplate.getHashCode(),m.cursorTemplate.render,n,{borderWidth:u.cursorBorderWidth})})}}var c,h;return{process:function(){var e=s.getCursorTreeItem();return(c=t()).reset("placeholder",11),null!=e&&(h=n.getTransform(),m(e)),!1}}},e.orgdiagram.DrawHighlightAnnotationTask=function(t,n,i,o,a,r,s,l,m,c,h,u){function d(t){var n,c,d,y,k,v,w=!0,C=l.getItemPosition(t),b=C.actualPosition;switch(C.actualVisibility){case 2:case 3:case 1:switch((n=r.getItemOptions(t)).showCallout){case 2:case 1:w=!1;break;default:w=f.showCallout}w?(g.activate("placeholder",12),p.transformRect(b.x,b.y,b.width,b.height,!0,this,function(r,p,w,b){p=new e.common.Rect(r,p,w,b),r=new e.common.Point(p.horizontalCenter(),p.verticalCenter()),w=o.getOptions().scale,b=new e.common.Point(m.getPlaceholderOffset());var P=new e.common.Rect(l.getContentSize()),O=new e.common.Size(i.getOptimalPanelSize());if(b.scale(1/w),O.scale(1/w),w=new e.common.Rect(b.x,b.y,Math.min(O.width,P.width),Math.min(O.height,P.height)),C.actualVisibility>=f.calloutMaximumVisibility&&4!=C.actualVisibility||!w.overlaps(p)){switch(k=e.common.isNullOrEmpty(n.calloutTemplateName)?e.common.isNullOrEmpty(n.templateName)?e.common.isNullOrEmpty(f.defaultCalloutTemplateName)?f.defaultTemplateName:f.defaultCalloutTemplateName:n.templateName:n.calloutTemplateName,p=(v=s.getTemplate(k,s.DefaultWidgetTemplateName)).templateConfig.itemSize,b=new e.common.Rect(r.x,r.y,p.width,p.height),f.orientationType){case 0:case 1:b.y-=p.height/4,b.x=r.x<w.horizontalCenter()?b.x+f.calloutPlacementOffset:b.x-(f.calloutPlacementOffset+p.width);break;default:b.x-=p.width/4,b.y=r.y<w.verticalCenter()?b.y+f.calloutPlacementOffset:b.y-(f.calloutPlacementOffset+p.height)}b.x<w.x?b.x=w.x+5:b.right()>w.right()&&(b.x-=b.right()-w.right()+5),b.y<w.y?b.y=w.y+5:b.bottom()>w.bottom()&&(b.y-=b.bottom()-w.bottom()+5),d=b,(c=new e.common.Rect(d)).addRect(r.x,r.y),c.offset(50),r.x-=c.x,r.y-=c.y,d.x-=c.x,d.y-=c.y,(y=new e.common.RenderEventArgs).context=a.getConfig(t),y.isCursor=h.getCursorTreeItem()==t,y.isSelected=u.isSelected(t),y.templateName=v.templateConfig.name,g.show("calloutplaceholder"),g.activate("calloutplaceholder",15),g.position("calloutplaceholder",c.x,c.y,c.width,c.height),g.template(d.x,d.y,d.width,d.height,0,0,d.width,d.height,v.itemTemplate.template(),v.itemTemplate.getHashCode(),v.itemTemplate.render,y,null),T.pointerPlacement=0,T.cornerRadius=f.calloutCornerRadius,T.offset=f.calloutOffset,T.opacity=f.calloutOpacity,T.lineWidth=f.calloutLineWidth,T.pointerWidth=f.calloutPointerWidth,T.borderColor=f.calloutBorderColor,T.fillColor=f.calloutfillColor,T.draw(r,d)}else g.hide("calloutplaceholder")})):g.hide("calloutplaceholder");break;case 4:g.hide("calloutplaceholder")}}var g,p,f,T=new e.common.Callout(t());return{process:function(){var e=c.getHighlightTreeItem();return(g=t()).reset("calloutplaceholder",15),null!==e&&(p=n.getTransform(),f=r.getOptions(),d(e)),!1}}},e.orgdiagram.DrawHighlightPathAnnotationTask=function(t,n,i,o,a){function r(t,n,i,o){var r,s,l,m,c,h,u,d,g,p,f,T,y;if(0<i.length){switch(f=new e.common.PolylinesBuffer,a){case 1:t.activate("placeholder",5);break;case 2:t.activate("placeholder",7)}var k={};for(r=0,s=i.length;r<s;r+=1)if(null!=(p=i[r]).items&&0<p.items.length&&(c=(d=p.items.slice(0))[0],o.hasNode(c)))for(l=1,m=d.length;l<m;l+=1)h=d[l],o.hasNode(h)&&(k.hasOwnProperty(c)?k[c].push(h):k[c]=[h],c=h);var v={};for(T in k)v[T]={},k.hasOwnProperty(T)&&o.getShortestPath(this,T,k[T],function(e){return e.weight},function(e,t){v[T][t]=e});for(r=0,s=i.length;r<s;r+=1)if(p=i[r],l=new e.common.PaletteItem({lineColor:null!=p.color?p.color:n.highlightLinesColor,lineWidth:null!=p.lineWidth?p.lineWidth:n.highlightLinesWidth,lineType:null!=p.lineType?p.lineType:n.highlightLinesType,fillColor:null,opacity:p.opacity}),k=f.getPolyline(l),null!=p.items&&0<p.items.length&&(c=(d=p.items.slice(0))[0],o.hasNode(c)))for(l=1,m=d.length;l<m;l+=1)if(h=d[l],o.hasNode(h)){for(c=(u=v[c][h]||[]).length-2;0<=c;c-=1)T=u[c+1],y=u[c],(g=o.edge(T,y)).from==T?g.polyline.clone().mergeTo(k):k.addInverted(g.polyline.clone()),p.showArrows&&(y==g.parentsArrowId||y==g.childrenArrowId)&&k.addArrow(p.lineWidth,function(e){e.mergeTo(f.getPolyline(e.paletteItem))});c=h}t.polylinesBuffer(f)}}return{process:function(){var e=o.getGraph(),s=n.getOptions(),l=i.getAnnotations(),m=t();switch(a){case 1:m.reset("placeholder",5);break;case 2:m.reset("placeholder",7)}return r(m,s,l,e),!1}}},e.orgdiagram.DrawHighlightTask=function(t,n,i,o,a,r,s,l,m){function c(t){var n;h.activate("placeholder",8);var i=a.getItemPosition(t),s=i.actualPosition,c=r.getTemplateParams(t).template,d=c.templateConfig,g=d.highlightPadding;(n=new e.common.RenderEventArgs).context=o.getConfig(t),n.isCursor=l.getCursorTreeItem()==t,n.isSelected=m.isSelected(t),n.templateName=d.name,u.transformRect(s.x,s.y,s.width,s.height,!0,this,function(t,o,a,r){var s=new e.common.Rect(0,0,Math.round(a),Math.round(r));s.offset(g.left,g.top,g.right,g.bottom),1==i.actualVisibility?h.template(t,o,a,r,s.x,s.y,s.width,s.height,c.highlightTemplate.template(),c.highlightTemplate.getHashCode(),c.highlightTemplate.render,n,{borderWidth:d.highlightBorderWidth}):h.template(Math.round(t),Math.round(o),Math.round(a),Math.round(r),Math.round(s.x),Math.round(s.y),Math.round(s.width),Math.round(s.height),c.dotHighlightTemplate.template(),c.dotHighlightTemplate.getHashCode(),c.dotHighlightTemplate.render,n,{borderWidth:d.highlightBorderWidth})})}var h,u;return{process:function(){var e=s.getHighlightTreeItem();return(h=t()).reset("placeholder",8),null!=e&&(u=n.getTransform(),c(e)),!1}}},e.orgdiagram.DrawItemLabelsTask=function(t,n,i,o,a){function r(t,n){var i=[];if(0==n.showLabels||1==n.showLabels)for(var o in t.treeItemsPositions)if(t.treeItemsPositions.hasOwnProperty(o)){var a=n.itemsOptions[o],r=t.treeItemsPositions[o],s=r.actualPosition;null!=a&&t.transform.transformRect(s.x,s.y,s.width,s.height,!0,this,function(t,o,s,l){var m;switch(r.actualVisibility){case 1:0==n.showLabels&&((c=new e.common.Label(t,o,s,l)).weight=1e4,c.labelType=1,i.push(c));break;case 2:case 3:var c;c=a;var h,u,d,g,p=r,f=null;if(!e.common.isNullOrEmpty(c.label)){var T;switch(T=3,c.showLabel){case 0:switch(n.showLabels){case 0:switch(p.actualVisibility){case 3:case 2:T=0}break;case 1:T=2}break;case 1:T=2}switch(T){case 0:g=p.leftPadding+p.rightPadding;break;case 2:g=1e4;break;case 3:g=0}if(3!=T){switch(d=null!=c.labelSize?c.labelSize:n.labelSize,p=3!=c.labelOrientation?c.labelOrientation:3!=n.labelOrientation?n.labelOrientation:0,f=0!=c.labelPlacement?c.labelPlacement:0!=n.labelPlacement?n.labelPlacement:1,p){case 0:h=d.width,u=d.height;break;case 1:case 2:u=d.width,h=d.height}var y,k;switch(d=n.labelOffset,f){case 0:case 1:switch(y=new e.common.Rect(t+s/2-h/2,o-d-u,h,u),p){case 0:k=0,m=2;break;case 1:m=k=1;break;case 2:k=2,m=1}break;case 2:case 11:switch(y=new e.common.Rect(t+s+d,o-d-u,h,u),p){case 0:k=1,m=2;break;case 1:k=1,m=0;break;case 2:m=k=2}break;case 3:switch(y=new e.common.Rect(t+s+d,o+l/2-u/2,h,u),p){case 0:m=k=1;break;case 1:m=k=0;break;case 2:k=0,m=2}break;case 4:case 12:switch(y=new e.common.Rect(t+s+d,o+l+d,h,u),p){case 0:k=1,m=0;break;case 1:k=2,m=0;break;case 2:k=1,m=2}break;case 5:switch(y=new e.common.Rect(t+s/2-h/2,o+l+d,h,u),p){case 0:m=k=0;break;case 1:k=2,m=1;break;case 2:m=k=1}break;case 6:case 10:switch(y=new e.common.Rect(t-h-d,o+l+d,h,u),p){case 0:k=2,m=0;break;case 1:m=k=2;break;case 2:k=1,m=0}break;case 7:switch(y=new e.common.Rect(t-h-d,o+l/2-u/2,h,u),p){case 0:k=2,m=1;break;case 1:k=0,m=2;break;case 2:m=k=0}break;case 8:case 9:switch(y=new e.common.Rect(t-h-d,o-d-u,h,u),p){case 0:m=k=2;break;case 1:k=1,m=2;break;case 2:k=2,m=0}}t=k,(f=new e.common.Label(y)).labelType=T,f.weight=g,f.text=c.label,f.labelOrientation=p,f.horizontalAlignmentType=t,f.verticalAlignmentType=m}}null!=(c=f)&&i.push(c)}})}0==n.showLabels&&e.common.getCrossingRectangles(this,i,function(e,t){if(e.isActive&&t.isActive)switch(e.labelType){case 1:switch(t.labelType){case 0:t.isActive=!1;break;case 2:t.isActive=!1}break;case 2:switch(t.labelType){case 1:e.isActive=!1;break;case 0:t.isActive=!1}break;case 0:switch(t.labelType){case 1:e.isActive=!1;break;case 0:e.weight<=t.weight?e.isActive=!1:t.isActive=!1;break;case 2:e.isActive=!1}}}),t.graphics.activate("placeholder",10),o={fontSize:n.labelFontSize,fontFamily:n.labelFontFamily,fontStyle:n.labelFontStyle,fontWeight:n.labelFontWeight,fontColor:n.labelColor};s=0;for(var l=i.length;s<l;s+=1){var m=i[s];if(m.isActive)switch(m.labelType){case 0:case 2:t.graphics.text(m.x,m.y,m.width,m.height,m.text,m.labelOrientation,m.horizontalAlignmentType,m.verticalAlignmentType,o)}}}return{process:function(){var e=o.getOptions(),i={graphics:t(),transform:n.getTransform(),treeItemsPositions:a.getItemsPositions()};e={showLabels:e.showLabels,labelFontSize:e.labelFontSize,labelFontFamily:e.labelFontFamily,labelFontStyle:e.labelFontStyle,labelFontWeight:e.labelFontWeight,labelColor:e.labelColor,itemsOptions:o.getItemsOptions(),labelSize:e.labelSize,labelOrientation:e.labelOrientation,labelPlacement:e.labelPlacement,labelOffset:e.labelOffset};return i.graphics.reset("placeholder",10),r(i,e),!1}}},e.orgdiagram.DrawMinimizedItemsTask=function(t,n,i,o,a,r){var s,l,m,c,h=!1;return{process:function(){return s=t(),l=n.getTransform(),m=o.getOptions(),c=r.getItemsPositions(),s.reset("placeholder",9),function(){var t,n,i,r,u,d,g,p,f,T,y=new e.common.PolylinesBuffer,k={},v=new e.common.Marker;for(T in c)c.hasOwnProperty(T)&&(d=(u=c[T]).actualPosition,g=o.getItemOptions(T),l.transformRect(d.x,d.y,d.width,d.height,!0,this,function(o,s,l,c){switch(u.actualVisibility){case 2:p=a.getTemplateParams(T),f=p.template.templateConfig,i=n=t=null,null!=g&&(n=t=g.itemTitleColor,i=g.minimizedItemShapeType),t=t||f.minimizedItemBorderColor||"#000080",n=n||f.minimizedItemFillColor||"#000080",null==i&&(i=null!==f.minimizedItemShapeType?f.minimizedItemShapeType:m.minimizedItemShapeType),r=null===f.minimizedItemCornerRadius?f.minimizedItemSize.width:f.minimizedItemCornerRadius,null==i||6==i?y.getPolyline(new e.common.PaletteItem({lineColor:t,lineWidth:f.minimizedItemLineWidth,lineType:f.minimizedItemLineType,fillColor:n,opacity:f.minimizedItemOpacity})).addSegment(new e.common.DotSegment(o,s,l,c,r)):v.draw(y,i,new e.common.Rect(o,s,l,c),new e.common.PaletteItem({lineColor:t,lineWidth:f.minimizedItemLineWidth,lineType:f.minimizedItemLineType,fillColor:n,opacity:f.minimizedItemOpacity}));break;default:h&&(t="#ff0000",k.hasOwnProperty(t)||(k[t]=new e.common.PaletteItem({lineColor:t,lineWidth:1,lineType:0,fillColor:t,opacity:1})),y.getPolyline(k[t]).addSegment(new e.common.DotSegment(o-1,s-1,2,2,1)))}}));s.activate("placeholder",9),s.polylinesBuffer(y)}(),!1}}},e.orgdiagram.DrawShapeAnnotationTask=function(t,n,i,o,a,r,s,l){var m,c,h,u;return{process:function(){switch(m=t(),c=n.getTransform(),h=o.getOptions(),u=s.getTemplate(),l){case 1:m.reset("placeholder",3);break;case 2:m.reset("placeholder",13)}return function(t,n){var i,o,a,r,s,d,g,p,f,T,y,k;switch(l){case 1:i=m.activate("placeholder",3);break;case 2:i=m.activate("placeholder",13)}for(o=0,a=t.length;o<a;o+=1)if(null!=(y=t[o]).items&&0<y.items.length){for(p=new e.common.Rect,r=0,s=y.items.length;r<s;r+=1)null!=(g=n(y.items[r]))&&p.addRect(g.actualPosition);if(!p.isEmpty()){for(d=new e.common.Shape(m),g=new e.orgdiagram.ShapeAnnotationConfig,r=0,s=(f="opacity cornerRadius shapeType offset lineWidth borderColor fillColor lineType labelSize labelOffset labelPlacement zOrderType".split(" ")).length;r<s;r+=1)T=f[r],d[T]=y.hasOwnProperty(T)?y[T]:g[T];d.position=p,d.orientationType=h.orientationType,d.panelSize=i.size,d.labelTemplate=u,d.hasLabel=null!=y.templateName||null!=y.label,(k=new e.common.RenderEventArgs).context=y,k.templateName=d.labelTemplate,c.transformRect(p.x,p.y,p.width,p.height,!0,this,function(t,n,i,o){t=new e.common.Rect(t,n,i,o),d.draw(t,k)})}}}(a.getAnnotations(),r.getItemPosition),!1}}},e.orgdiagram.DrawTreeItemsTask=function(t,n,i,o,a,r,s,l,m,c,h,u,d,g){var p,f,T,y,k,v,w;return{process:function(){return f=t(),y=a.getOptions(),p=s.getItemsPositions(),T=n.getTransform(),k=g.getTemplate(),v=d.getTemplate(),w=u.getTemplate(),f.reset("placeholder",12),f.reset("placeholder",16),function(){var t,n,a,u,d=c.getCursorTreeItem();if(a=null,null!=l){a=o.getOptions().scale;var g=new e.common.Point(l.getPlaceholderOffset()),C=new e.common.Rect(s.getContentSize()),b=new e.common.Size(i.getOptimalPanelSize());g.scale(1/a),b.scale(1/a),a=new e.common.Rect(g.x,g.y,Math.min(b.width,C.width),Math.min(b.height,C.height))}for(var P in u=a,p)p.hasOwnProperty(P)&&(a=(n=p[P]).actualPosition,1==n.actualVisibility&&T.transformRect(a.x,a.y,a.width,a.height,!0,this,function(i,o,a,s){var l=new e.common.Rect(i,o,a,s);if(null==u||u.overlaps(l)){var c=m.getTemplateParams(P);if(l=c.template,(t=new e.common.RenderEventArgs).id=P,t.context=r.getConfig(P),t.isCursor=P==d,t.isSelected=h.isSelected(P),t.templateName=l.templateConfig.name,t.template=c.template,t.isActive=c.isActive,t.hasSelectorCheckbox=c.hasSelectorCheckbox,t.hasButtons=c.hasButtons,t.hasGroupTitle=c.hasGroupTitle,t.buttons=c.buttons,t.onButtonsRender=c.onButtonsRender,f.activate("placeholder",12),f.template(i,o,a,s,n.contentPosition.x,n.contentPosition.y,n.contentPosition.width,n.contentPosition.height,l.itemTemplate.template(),l.itemTemplate.getHashCode(),l.itemTemplate.render,t,{borderWidth:l.templateConfig.itemBorderWidth}),c.hasGroupTitle){var g=0;switch(y.groupTitlePlacementType){case 2:case 0:g=2;break;case 3:g=a-(y.groupTitlePanelSize-4)}f.template(i,o,a,s,g,n.contentPosition.y,y.groupTitlePanelSize-4,n.contentPosition.height+2,w.template(),w.getHashCode(),w.render,t,null)}if(c.hasSelectorCheckbox&&(f.activate("placeholder",16),f.template(i,o,a,s,n.contentPosition.x,s-(y.checkBoxPanelSize-4),n.contentPosition.width,y.checkBoxPanelSize-4,v.template(),v.getHashCode(),v.render,t,null)),c.hasButtons){switch(f.activate("placeholder",16),c=0,y.groupTitlePlacementType){case 2:case 0:c=a-(y.buttonsPanelSize-4);break;case 3:c=2}f.template(i,o,a,s,c,n.contentPosition.y,y.buttonsPanelSize-4,Math.max(n.contentPosition.height,s-n.contentPosition.y),k.template(),l.templateConfig.name+k.getHashCode(),k.render,t,null)}}}))}(),!1}}},e.orgdiagram.ActiveItemsTask=function(t,n){function i(e,t){var i,o,a=[];for(i=0,o=t.length;i<o;i+=1){var r=t[i],s=n.getTemplate(r.templateName,e.defaultTemplateName,n.DefaultWidgetTemplateName).templateConfig;r.isActive&&s.isActive&&a.push(r.id)}return a}var o=[],a={},r=new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:a},n=t.getOptions();return o=r.read(o,i(n,n.items),"items",e),e.isChanged},getActiveItems:function(){return a.items}}},e.orgdiagram.AnnotationLabelTemplateTask=function(e,t){var n=null;return{process:function(){return!1},getTemplate:function(){return null==n&&(n=new t.AnnotationLabelTemplate),n}}},e.orgdiagram.ButtonsTemplateTask=function(e,t){var n=null;return{process:function(){return!1},getTemplate:function(){return null==n&&(n=new t.ButtonsTemplate),n}}},e.orgdiagram.CheckBoxTemplateTask=function(e,t){var n=null;return{process:function(){return n=null,!0},getTemplate:function(){var i;return null==n&&(i=e.getOptions(),n=new t.CheckBoxTemplate(i.selectCheckBoxLabel)),n}}},e.orgdiagram.GroupTitleTemplateTask=function(e,t){var n=null;return{process:function(){return n=null,!0},getTemplate:function(){var i;return null==n&&(i=e.getOptions(),n=new t.GroupTitleTemplate(i)),n}}},e.orgdiagram.ItemTemplateParamsTask=function(t,n,i){function o(e,t,n){var i=!1;switch(t){case 0:switch(n){case 0:i=e;break;case 1:i=!0;break;case 2:i=!1}break;case 1:i=!0;break;case 2:i=!1}return i}var a={};return{process:function(){var r,s,l=t.getOptions(),m=0<l.buttons.length||null!=l.onButtonsRender,c=n.getCursorItem(),h=l.items;for(a={},r=0,s=h.length;r<s;r+=1){var u=h[r],d=new e.orgdiagram.TemplateParams,g=c==u.id,p=i.getTemplate(u.templateName,l.defaultTemplateName,i.DefaultWidgetTemplateName),f=p.templateConfig,T=(T=null!=f.buttons&&0<f.buttons.length)||null!=f.onButtonsRender;d.template=p,d.isActive=u.isActive&&f.isActive,d.isActive&&(d.hasSelectorCheckbox=o(g,u.hasSelectorCheckbox,l.hasSelectorCheckbox),d.hasButtons=(m||T)&&o(g,u.hasButtons,l.hasButtons),d.hasButtons&&(d.buttons=T?f.buttons:l.buttons,d.onButtonsRender=f.onButtonsRender||l.onButtonsRender)),d.hasGroupTitle=!e.common.isNullOrEmpty(u.groupTitle),a[u.id]=d}return!0},getTemplateParams:function(e){return a[e]}}},e.common.LabelAnnotationTemplate=function(){var e=["div",{class:["bp-item","bp-label-annotation"]}];return{template:function(){return e},getHashCode:function(){return"defaultLabelAnnotationTemplate"},render:function(e,t){t.element.innerHTML=t.context.title}}},e.orgdiagram.ReadTemplatesTask=function(t,n){var i={};return{process:function(){var o,a,r,s=t.getOptions(),l=s.templates;for(i={},r=new e.orgdiagram.TemplateConfig,i.DefaultWidgetTemplate=new e.orgdiagram.Template(r,new n.ItemTemplate(s,r),new n.HighlightTemplate(s,r),new n.DotHighlightTemplate(s,r),new n.CursorTemplate(s,r)),(o=new e.orgdiagram.TemplateConfig).name="DefaultWidgetLabelAnnotationTemplate",o.isActive=!1,o.itemSize=new e.common.Size(100,20),o.minimizedItemSize=new e.common.Size(0,0),o.minimizedItemCornerRadius=o.minimizedItemSize.width/2,r=o,i.DefaultWidgetLabelAnnotationTemplate=new e.orgdiagram.Template(r,new n.LabelAnnotationTemplate,null,new n.DotHighlightTemplate(s,r),null),o=0,a=l.length;o<a;o+=1)r=l[o],i[r.name]=new e.orgdiagram.Template(r,e.common.isNullOrEmpty(r.itemTemplate)?new n.ItemTemplate(s,r):new n.UserTemplate(s,r.itemTemplate,s.onItemRender),e.common.isNullOrEmpty(r.highlightTemplate)?new n.HighlightTemplate(s,r):new n.UserTemplate(s,r.highlightTemplate,s.onHighlightRender),new n.DotHighlightTemplate(s,r),e.common.isNullOrEmpty(r.cursorTemplate)?new n.CursorTemplate(s,r):new n.UserTemplate(s,r.cursorTemplate,s.onCursorRender));return!0},getTemplate:function(e,t,n){return i[e]||i[t]||i[n]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}},e.orgdiagram.CombinedNormalVisibilityItemsTask=function(t,n,i,o,a,r,s,l,m,c,h,u){var d=[],g={},p=[n,i,o,a,r,s,l,m,c,h,u],f=new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:g},n=t.getOptions();return d=f.read(d,function(e){var t,n,i,o,a,r,s=[],l={};for(t=0,n=e.length;t<n;t+=1)for(a=(i=e[t]).getItems(),i=0,o=a.length;i<o;i+=1)r=a[i],l.hasOwnProperty(r)||(s.push(r),l[r]=!0);return s}(p),"items",e),0!=n.pageFitMode&&1!=n.minimalVisibility||(e.isChanged=!1),e.isChanged},isItemSelected:function(e){return g.items.hasOwnProperty(e)}}},e.orgdiagram.CursorItemTask=function(e,t){var n=null;return{process:function(){var i=e.getCursorItem(),o=null!=t?t.getActiveItems():{};return n=null!=i&&o.hasOwnProperty(i)?i:null,!0},getCursorTreeItem:function(){return n},getItems:function(){return null!=n?[n]:[]}}},e.orgdiagram.CursorNeighboursTask=function(e,t){var n=[];return{process:function(){var i=t.getNavigationFamily(),o=e.getCursorTreeItem();return n=function(e,t){var n=[];return null!==e&&t.loopNeighbours(this,e,function(e,t){return 0===t.visibility&&n.push(e),!0}),n}(o,i),!0},getItems:function(){return n}}},e.orgdiagram.HighlightItemTask=function(e,t){var n=null;return{process:function(){var i=e.getHighlightItem(),o=null!=t?t.getActiveItems():{};return n=null!=i&&o.hasOwnProperty(i)?i:null,!0},getHighlightTreeItem:function(){return n}}},e.orgdiagram.NormalVisibilityItemsByAnnotationTask=function(t){var n=[],i={},o=new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:i},a=t.getAnnotations();return n=o.read(n,function(e){var t,n,i,o,a,r,s=[],l={};for(t=0,n=e.length;t<n;t+=1)if((i=e[t]).selectItems)for(a=i.items,i=0,o=a.length;i<o;i+=1)null!=(r=a[i])&&!l.hasOwnProperty(r)&&(s.push(r),l[r]=!0);return s}(a),"items",e),e.isChanged},getItems:function(){return n}}},e.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask=function(t){var n=[],i={},o=new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:i},a=t.getAnnotations();return n=o.read(n,function(e){var t,n,i,o=[],a={};for(t=0,n=e.length;t<n;t+=1)(i=e[t]).selectItems&&(null!=i.fromItem&&!a.hasOwnProperty(i.fromItem)&&(o.push(i.fromItem),a[i.fromItem]=!0),null!=i.toItem&&!a.hasOwnProperty(i.toItem)&&(o.push(i.toItem),a[i.toItem]=!0));return o}(a),"items",e),e.isChanged},getItems:function(){return n}}},e.orgdiagram.SelectedItemsTask=function(t){var n=[],i={},o=new e.common.ArrayReader(new e.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:i},a=t.getSelectedItems();return n=o.read(n,function(e){var t,n,i,o=[],a={};for(t=0,n=e.length;t<n;t+=1)null!=(i=e[t])&&!a.hasOwnProperty(i)&&(o.push(i),a[i]=!0);return o}(a),"items",e),e.isChanged},getItems:function(){return n},isSelected:function(e){return i.items.hasOwnProperty(e)}}},e.orgdiagram.SelectionPathItemsTask=function(e,t,n,i){var o=[];return{process:function(){var a=i.getSelectionPathMode(),r=e.getNavigationFamily(),s=t.getCursorTreeItem(),l=n.getItems().slice(0);return l.push(s),o=function(e,t,n){var i,o,a,r=[],s={};for(o=0,a=e.length;o<a;o+=1)switch(i=e[o],n){case 1:t.loopParents(this,i,function(e,n){if(null!=s[e])return t.SKIP;4!=n.visibility&&r.push(e),s[e]=!0})}return r}(l,r,a),!0},getItems:function(){return o}}},e.orgdiagram.CombinedContextsTask=function(e,t){return{process:function(){return!0},getConfig:function(n){return e.getConfig(n)||null!=t&&t.getConfig(n)}}},e.orgdiagram.ConnectionsGraphTask=function(t,n,i,o,a){var r={graph:null,nodeid:0};return{process:function(){for(var s=t().activate("placeholder",6),l=o.getBundles(),m=o.getNestedLayoutBottomConnectorIds(),c=i.getOptions(),h={graph:e.common.graph(),nodeid:0},u=(s={treeItemsPositions:a.getItemsPositions(),nestedLayoutBottomConnectorIds:m,transform:n.getTransform(),hasGraphics:s.hasGraphics},c={connectorType:c.connectorType,showExtraArrows:c.showExtraArrows,bevelSize:c.bevelSize,elbowType:c.elbowType},m=0,l.length);m<u;m+=1)l[m].trace(h,s,c);return r=h,!0},getGraph:function(){return r.graph}}},e.orgdiagram.ItemsPositionsTask=function(t,n,i,o,a,r,s,l,m,c,h){var u,d,g,p,f,T,y,k,v,w,C,b,P;function O(t,n){var i,o;for(p=[],g.loopLevels(this,function(){var t=new e.orgdiagram.TreeLevelPosition;t.currentvisibility=1,p.push(t)}),i=0;i<=n;i+=1)o=t[i],p[o.level].currentvisibility=o.currentvisibility;I(),M(),x(),i=C.lineLevelShift;var a,r,s,m,c=o=0;switch(a=8*v.linesWidth,v.arrowsDirection){case 1:o=a,c=0;break;case 2:o=0,c=a}for(a=0,r=p.length;a<r;a+=1)s=p[a],m=l.getConnectorsStacksSizes(a),i+=s.setShift(i,A(s.actualVisibility),c,o,m.parentsStackSize);return new e.common.Rect(0,0,Math.round(function(){var e,t,n=0;for(e=0,t=p.length;e<t;e+=1)n=Math.max(n,p[e].currentOffset);return n+=C.normalItemsInterval}()),Math.round(function(){var e=p[p.length-1];return e.shift+e.nextLevelShift}()))}function S(e,t){var n=!1;switch(C.pageFitMode){case 1:t.width>=e.width&&(n=!0);break;case 2:t.height>=e.height&&(n=!0);break;case 3:t.height>=e.height&&t.width>=e.width&&(n=!0)}return n}function I(){var t=c.getCursorTreeItem();u={},g.loopLevels(this,function(n){var i=p[n];g.loopLevelItems(this,n,function(n,o){var a,r,s,l=new e.orgdiagram.TreeItemPosition,c=h.isItemSelected(n)?1:o.visibility,d=m.getTemplateParams(n),g=(c=0===c?i.currentvisibility:c,t==n),p=C,f=k.orientationType;switch(c){case 1:if(a=d.template.templateConfig,r=new e.common.Size(a.itemSize),s=new e.common.Rect(0,0,r.width,r.height),g&&(r.height+=a.cursorPadding.top+a.cursorPadding.bottom,r.width+=a.cursorPadding.left+a.cursorPadding.right,s.x=a.cursorPadding.left,s.y=a.cursorPadding.top),d.hasSelectorCheckbox&&(r.height+=p.checkBoxPanelSize),d.hasButtons)switch(r.width+=p.buttonsPanelSize,p.groupTitlePlacementType){case 3:s.x+=p.buttonsPanelSize}if(d.hasGroupTitle)switch(r.width+=p.groupTitlePanelSize,p.groupTitlePlacementType){case 3:break;default:s.x+=p.groupTitlePanelSize}break;case 2:a=d.template.templateConfig,r=new e.common.Size(a.minimizedItemSize);break;case 3:case 4:r=new e.common.Size}switch(f){case 2:case 3:r.invert()}l.actualVisibility=c,l.actualSize=r,l.contentPosition=s,u[n]=l})})}function x(){var e,t;g.loopLevels(this,function(n){var i=p[n];switch(i.shift=0,i.depth=0,i.actualVisibility=4,t=e=null,g.loopLevelItems(this,n,function(n){switch(n=u[n],i.depth=Math.max(i.depth,n.actualSize.height),n.actualVisibility){case 2:case 3:case 4:t=t?Math.min(t,n.actualSize.height):n.actualSize.height;break;default:e=e?Math.min(e,n.actualSize.height):n.actualSize.height}i.actualVisibility=Math.min(i.actualVisibility,n.actualVisibility)}),null==e&&(e=i.depth),null!=t&&t>e&&(e=t),C.verticalAlignment){case 0:i.horizontalConnectorsDepth=e/2;break;case 1:i.horizontalConnectorsDepth=i.depth/2;break;case 2:i.horizontalConnectorsDepth=i.depth-e/2}})}function A(e){var t=0;switch(e){case 1:t=C.normalLevelShift;break;case 2:t=C.dotLevelShift;break;case 3:case 4:t=C.lineLevelShift}return t}function M(){var e,t;for(e=0,t=p.length;e<t;e+=1)p[e].currentOffset=0;f.loopPostOrder(this,function(e,t){var n,i,o,a,r,s,l,m,c=u[e],h=c.actualVisibility,d=g.getLevelIndex(e);d=p[d],h=P[0===h?d.currentvisibility:h]/2;if(n=8*v.linesWidth,c.leftPadding=h+(0<d.currentOffset?h*t.relationDegree*C.cousinsIntervalMultiplier:0),c.rightPadding=h,0!=v.arrowsDirection&&(8&t.connectorPlacement&&(c.leftPadding+=n),2&t.connectorPlacement&&(c.rightPadding+=n)),c.offset=d.currentOffset+c.leftPadding,d.currentOffset=c.offset+c.actualSize.width+c.rightPadding,f.hasChildren(e))if(0<(c=function(e){var t,n,i,o=(o=u[e.id]).offset+o.actualSize.width/2,a=null;if(null===e.visualAggregatorId)switch(t=null,f.loopChildren(this,e.id,function(e,n){if(1&(t=n).connectorPlacement)return!0}),n=u[t.id],i=null,f.loopChildrenReversed(this,e.id,function(e,t){if(1&(i=t).connectorPlacement)return!0}),e=u[i.id],w.horizontalAlignment){case 1:a=n.offset+n.actualSize.width/2;break;case 2:a=e.offset+e.actualSize.width/2;break;case 0:a=(n.offset+e.offset+e.actualSize.width)/2}else e=u[e.visualAggregatorId],a=e.offset+e.actualSize.width/2;return o-a}(t)))R(t,c);else if(0>c&&(L(t,c=-c),i=null,o={},r=null,null!==(d=f.parent(t.id))&&(f.loopChildrenReversed(this,d.id,function(e,n){if(n===t)i=[];else if(null!==i){var s,l,m,c,h,d=null,g=[];for(void 0===(s=y[n.id])&&(s=[]),(s=s.slice()).splice(0,0,n.id),l=0,m=s.length;l<m;l+=1)c=u[s[l]],g[l]=c.offset+c.actualSize.width+c.rightPadding;for(s=[],void 0===(l=T[t.id])&&(l=[]),(l=l.slice()).splice(0,0,t.id),m=0,c=l.length;m<c;m+=1)h=u[l[m]],s[m]=h.offset-h.leftPadding;for(l=Math.min(g.length,s.length),m=0;m<l&&(c=s[m]-g[m],d=null!==d?Math.min(d,c):c,!(0>=c));m+=1);if(a=Math.floor(d),o[n.id]=a,!(0<a))return r=n,!0;i.splice(0,0,n)}}),0<i.length))){if(h=null,null!==r)for((s=(s=[r]).concat(i)).push(t),h=[[r]],d=1,n=s.length;d<n;d+=1)l=s[d-1],m=s[d],2==l.gravity||1==m.gravity?h[h.length-1].push(m):h.push([m]);else(h=[i.slice(0)])[h.length-1].push(t);if(0<h.length)for(d=(i=h[h.length-1]).length-2;0<=d;d-=1)m=i[d],a=o[m.id],L(m,c=Math.min(a,c)),R(m,c);for(s=c/(h.length-1),n=h.length-2;0<n;n-=1)for(d=(l=h[n]).length-1;0<=d;d-=1)m=l[d],a=o[m.id],L(m,c=Math.min(n*s,Math.min(a,c))),R(m,c)}})}function L(e,t){var n=u[e.id];n.offset+=t;var i=p[g.getLevelIndex(e.id)];i.currentOffset=Math.max(i.currentOffset,n.offset+n.actualSize.width+n.rightPadding)}function R(e,t){var n,i;f.loopLevels(this,e.id,function(e){return(n=u[e]).offset+=t,(i=p[g.getLevelIndex(e)]).currentOffset=Math.max(i.currentOffset,n.offset+n.actualSize.width),!0})}return u={},d=null,{process:function(){var m;m=C=o.getOptions();var c=[];return c[1]=m.normalItemsInterval,c[2]=m.dotItemsInterval,c[3]=m.lineItemsInterval,c[4]=m.lineItemsInterval,P=c,k=i.getOptions(),v=a.getOptions(),w=r.getOptions(),g=l.getTreeLevels(),f=s.getVisualTree(),T=s.getLeftMargins(),y=s.getRightMargins(),p=[],u={},m=t.getOptimalPanelSize(),b=n.getOptions(),m.scale(1/b.scale),m=new e.common.Rect(0,0,m.width,m.height),d=function(t){var n,i,o,a,r,s=new e.common.Rect(0,0,0,0);switch(k.orientationType){case 2:case 3:t.invert()}if(!g.isEmpty())switch(C.pageFitMode){case 0:case 5:s=O(n=[new e.orgdiagram.LevelVisibility(0,1)],0);break;default:switch(n=[new e.orgdiagram.LevelVisibility(0,1)],i=[],C.minimalVisibility){case 2:i.push(2);break;case 0:case 3:case 4:i.push(2),i.push(3)}if(g.loopLevelsReversed(this,function(t){var o;for(o=0;o<i.length;o+=1)n.push(new e.orgdiagram.LevelVisibility(t,i[o]))}),(o=O(n,n.length-1)).addRect(t),o.offset(0,0,5,5),r=a=t=null,!S(s=O(n,0),o)&&(t=0,S(s=O(n,n.length-1),o))){for(r=a=n.length-1;1<a-t;)r=Math.floor((a+t)/2),S(s=O(n,r),o)?a=r:t=r;a!==r&&(s=O(n,a))}}return s}(m),function(){var t=null;g.loopLevels(this,function(n){var i=p[n];g.loopLevelItems(this,n,function(n){var o,a,r,s,l,m;switch(o=(n=u[n]).actualSize,s=t,a=0,n.actualVisibility){case 1:switch(C.verticalAlignment){case 0:a=0;break;case 1:a=(i.depth-o.height)/2;break;case 2:a=i.depth-o.height}break;case 2:case 3:case 4:a=i.horizontalConnectorsDepth-o.height/2}o=new e.common.Rect(n.offset,i.shift+a,o.width,o.height),a=i.shift+i.horizontalConnectorsDepth,r=null!=s?s.shift+s.connectorShift:null,s=null!=s?s.levelSpace/2:null,l=i.shift+i.connectorShift,m=i.levelSpace/2,n.actualPosition=o,n.horizontalConnectorsShift=a,n.topConnectorShift=r,n.topConnectorInterval=s,n.bottomConnectorShift=l,n.bottomConnectorInterval=m}),t=i})}(),!0},getItemsPositions:function(){return u},getItemPosition:function(e){return u[e]},getContentSize:function(){return d}}},e.orgdiagram.OrgTreeTask=function(t){var n,i;return i=n=null,{process:function(){return function(t){var o,a,r,s,l,m,c=0,h=e.common.tree();for(s=0,l=t.length;s<l;s+=1)null!=(r=t[s]).id&&(o=new e.orgdiagram.OrgItem(r),m=parseInt(r.id,10),c=Math.max(isNaN(m)?0:m,c),h.add(r.parent,o.id,o));c+=1,(t=new e.orgdiagram.ItemConfig).id=c,t.title="internal root",t.isVisible=!1,t.isActive=!1,(a=new e.orgdiagram.OrgItem(t)).hideParentConnection=!0,a.hideChildrenConnection=!0,h.add(null,a.id,a),h.loopLevels(this,function(e,t,n){if(0<n)return h.BREAK;a.id!=e&&(h.adopt(a.id,e),t.itemType=0)}),function(e){e.loopLevels(this,function(t,n){var i=!0;return n.isVisible?e.SKIP:(e.loopChildren(this,t,function(e,t){if(0!=t.itemType)return i=!1,!0}),i?(n.hideChildrenConnection=!0,void e.loopChildren(this,t,function(e,t){t.hideParentConnection=!0})):e.SKIP)})}(h),n=h,i=c}(t.getItems()),!0},getOrgTree:function(){return n},getMaximumId:function(){return i}}},e.orgdiagram.PaletteManagerTask=function(t,n){var i;return{process:function(){var o=[];return null!=n&&(o=n.getOptions().linesPalette),i=new e.common.PaletteManager(t.getOptions(),o),!0},getPaletteManager:function(){return i}}},e.orgdiagram.VisualTreeLevelsTask=function(t){var n=null,i=null,o=null,a=new e.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var a=t.getVisualTree();return n=e.common.TreeLevels(),a.loopLevels(this,function(e,t,i){n.addItem(i,e,t)}),function(t,n,i,o){var a,r,s,l,m,c,h,u,d,g,p={};i.loopLevels(this,function(f){var T=new e.orgdiagram.TreeLevelConnectorStackSize;if(n[f]=T,h=[],i.loopLevelItems(this,f,function(n,a){var r=[];if(!p.hasOwnProperty(n)&&(4&a.connectorPlacement&&r.push(n),0<(r=r.concat(a.partners)).length)){c=new e.common.VerticalConnectorBundle(r,[]);for(var s=0,l=r.length;s<l;s+=1)p[r[s]]=c;o.loopChildren(this,n,function(e,t){1&t.connectorPlacement&&c.toItems.push(e)}),1<r.length&&h.push(c),(1<c.fromItems.length||0<c.toItems.length)&&t.push(c)}8&a.connectorPlacement&&(c=new e.common.HorizontalConnectorBundle(n,i.getPrevItem(n)),t.push(c)),2&a.connectorPlacement&&(c=new e.common.HorizontalConnectorBundle(n,i.getNextItem(n)),t.push(c))}),0<h.length){for(g=e.common.pile(),a=0,r=h.length;a<r;a+=1){for(c=h[a],d=u=null,s=0,l=c.fromItems.length;s<l;s+=1)m=i.getItemPosition(c.fromItems[s]),u=null!=u?Math.min(u,m):m,d=null!=d?Math.max(d,m):m;g.add(u,d,c)}T.parentsStackSize=g.resolve(this,function(e,t,n,i,o){n.fromOffset=i+1,n.fromStackSize=o})}})}(i=[],o=[],n,a),!0},getTreeLevels:function(){return n},getBundles:function(){return i},getConnectorsStacksSizes:function(e){return o[e]||a},getNestedLayoutBottomConnectorIds:function(){return{}}}},e.orgdiagram.VisualTreeTask=function(t,n,i,o){function a(e,t,n){var i,a,p,f,y,k,v,w,C,b,P,O,S,I,x,A,M,L,R={},z={},B={};e.loopPostOrder(this,function(e,t,n,i){t.hasVisibleChildren=t.isVisible||t.hasVisibleChildren,null!=i&&(i.hasVisibleChildren=i.hasVisibleChildren||t.hasVisibleChildren)}),e.loopLevels(this,function(r,l){var p,v,C;if(!o&&!l.hasVisibleChildren)return e.SKIP;switch((p=n.node(r))||(p=d({visibility:4,connectorPlacement:0,parentId:null,actualItemType:0},l),n.add(null,r,p)),M=A=0,null!=(k=n.indexOf(r))&&(A=k,M=n.countSiblings(r)-k-1),v=[],e.loopChildren(this,r,function(e,t){if(o||t.hasVisibleChildren){switch(i=d({parentId:r,actualItemType:t.itemType},t),p.actualItemType){case 7:case 8:case 6:switch(i.actualItemType){case 7:case 8:case 6:i.actualItemType=2;break;case 0:i.actualItemType=1}}switch(i.actualItemType){case 5:g(p,i),i.connectorPlacement=5,C=d({visibility:4}),n.add(C.id,i.id,i),i=C;case 8:case 2:if(a=n.parent(r),2&p.connectorPlacement)f=c(n,T.navigationFamily,p),n.add(a.id,i.id,i,f+1),i.connectorPlacement=6,i.gravity=2;else if(8&p.connectorPlacement)y=h(n,T.navigationFamily,p),n.add(a.id,i.id,i,y),i.connectorPlacement=12,i.gravity=1;else switch(t.adviserPlacementType){case 2:f=c(n,T.navigationFamily,p),n.add(a.id,i.id,i,f+1),i.connectorPlacement=6,i.gravity=2;break;default:y=h(n,T.navigationFamily,p),n.add(a.id,i.id,i,y),i.connectorPlacement=12,i.gravity=1}switch(i.actualItemType){case 8:null!=p.parentId?g(n.node(p.parentId),i):g(p,i,!0);break;case 2:g(p,i)}break;case 4:g(p,i),i.connectorPlacement=5,C=d({visibility:4}),n.add(C.id,i.id,i),i=C;case 1:var s;s=p;var l,m=t.levelOffset||0,u=null;!1;for(var k=0;k<=m;)null==(u=null==u?s:n.node(u.visualAggregatorId)).visualAggregatorId&&(l=d({visibility:4,visualAggregatorId:null,connectorPlacement:5}),n.insert(u.id,l.id,l),u.visualAggregatorId=l.id),k+=1;switch(s=u,t.adviserPlacementType){case 2:n.add(s.id,i.id,i,0),i.connectorPlacement=6,i.gravity=2;break;default:n.add(s.id,i.id,i),i.connectorPlacement=12,i.gravity=1}1==i.actualItemType&&g(p,i);break;case 0:s=t.levelOffset||0,null==v[s]?v[s]=[i]:v[s].push(i),g(p,i);break;case 7:case 6:if(a=n.parent(r),2&p.connectorPlacement)n.add(a.id,i.id,i,A),i.connectorPlacement=6,i.gravity=2;else if(8&p.connectorPlacement)n.add(a.id,i.id,i,n.countChildren(a.id)-M),i.connectorPlacement=12,i.gravity=1;else{switch(t.adviserPlacementType){case 2:n.add(a.id,i.id,i,A),i.gravity=2;break;default:n.add(a.id,i.id,i,n.countChildren(a.id)-M),i.gravity=1}switch(i.actualItemType){case 6:i.connectorPlacement=5;break;case 7:i.connectorPlacement=4}}null!=p.parentId?g(n.node(p.parentId),i):g(p,i,!0)}}}),p.actualItemType){case 7:case 8:case 6:break;default:L=[],null!=(a=n.parent(r))&&n.loopChildrenRange(this,a.id,A,n.countChildren(a.id)-M,function(t,n){if(n.id==r)L.push(n);else switch(n.actualItemType){case 7:case 8:case 6:e.parentid(n.id)==r&&L.push(n)}}),1<L.length&&(B[r]=L)}R[r]=[],z[r]=[];var b=[];if(0<v.length){a=s(n,p);for(var P=0;P<v.length-1;P+=1){if(null!=(G=v[P])){var O=u(n,a,4==p.visibility&&0===p.connectorPlacement);b.push([O]);var S=0;switch(t.horizontalAlignment){case 0:S=Math.ceil(G.length/2)-1;break;case 1:S=-1;break;case 2:S=G.length-1}for(k=S;0<=k;k-=1)w=G[k],n.add(a.id,w.id,w,0),w.connectorPlacement=5,w.gravity=2;for(k=S+1;k<G.length;k+=1)w=G[k],n.add(a.id,w.id,w),w.connectorPlacement=5,w.gravity=1;a=O}}S=p,P=v[v.length-1];var I,x,D,V,F,E,N,H,W=l.childrenPlacementType,G=R[r],_=(O=z[r],4==S.visibility&&0===S.connectorPlacement);switch(t.horizontalAlignment){case 0:case 1:I=3;break;case 2:I=2}switch(0===W&&(W=function(e,t){var n=!1,i=!0;return e.loopChildren(this,t.id,function(t,o){if(n=!0,0===o.itemType&&e.hasChildren(t))return i=!1,!0}),n&&i}(e,S)?0===t.leavesPlacementType?3:t.leavesPlacementType:0===t.childrenPlacementType?2:t.childrenPlacementType),S=s(n,S),3==W&&3>P.length&&(W=2),W){case 2:for(x=0,V=P.length;x<V;x+=1)W=P[x],D=e.node(W.id),n.add(S.id,W.id,W),W.connectorPlacement=(D.hideParentConnection?0:1)|(D.hideChildrenConnection?0:4),0===x&&(W.relationDegree=1);break;case 3:for(V=Math.min(t.maximumColumnsInMatrix,Math.ceil(Math.sqrt(P.length))),F=Math.ceil(P.length/V),E=Math.ceil(V/2),N=0;N<E;N+=1)for(I=S,H=0;H<F;H+=1)W=m(P,2*N,H,V),x=m(P,2*N+1,H,V),void 0===G[H]&&(G[H]=[],O[H]=[]),null!==W&&(0===N&&(W.relationDegree=1),n.add(I.id,W.id,W),W.connectorPlacement=4|(_?0:2),W.gravity=2,O[H].push(W)),null===W&&null===x||(D=d({visibility:4,connectorPlacement:_?0:5}),n.add(I.id,D.id,D),G[H].push(D)),null!==x&&(n.add(I.id,x.id,x),x.connectorPlacement=4|(_?0:8),x.gravity=1,O[H].push(x)),I=D;2<V&&(S.visualAggregatorId=null);break;case 1:for(x=0,V=P.length;x<V;x+=1){switch(W=P[x],D=d({visibility:4,connectorPlacement:_?0:5}),I){case 2:n.add(S.id,W.id,W),n.add(S.id,D.id,D),W.connectorPlacement=4|(_?0:2),W.gravity=2;break;case 3:n.add(S.id,D.id,D),n.add(S.id,W.id,W),W.connectorPlacement=4|(_?0:8),W.gravity=1}G[x]=[D],O[x]=[W],S=D}break;default:throw"Children placement is undefined!"}R[r]=R[r].concat(b),z[r]=z[r].concat(v.slice(0,v.length-1))}}),e.loopPostOrder(this,function(e,i,o,a){i=n.node(e);var s,m,c=null!=B[o];if(null!=i){if(o=z[e],s=R[e],null!=a){switch(m=c,a.placeAssistantsAboveChildren){case 0:t.placeAssistantsAboveChildren&&(m=!0);break;case 1:m=!0}if(m&&(0<(P=function(e,t){var n=0;return null!=t.visualAggregatorId&&e.loopLevels(this,t.id,function(i,o,a){if(t.visualAggregatorId==i)return e.SKIP;n=a+1}),n}(n,i))&&(i.visualDepth=P+1,null!==i.visualAggregatorId)))for(p=n.node(i.visualAggregatorId),m=n.hasChildren(p.id),k=0;k<P-1;k+=1)p=u(n,p,!m)}if(null!=a){switch(m=c,a.placeAdvisersAboveChildren){case 0:t.placeAdvisersAboveChildren&&(m=!0);break;case 1:m=!0}if(m){var h,d;a=0;if(null!==(c=n.parent(i.id))){for(m=n.indexOf(i.id),h=1;null!=(d=n.getChild(c.id,m+h))&&8&d.connectorPlacement;)a=Math.max(a,l(n,d)),h+=1;for(h=1;null!=(d=n.getChild(c.id,m-h))&&2&d.connectorPlacement;)a=Math.max(a,l(n,d)),h+=1}if(1<(P=a))for(i.visualDepth+=P-1,m=n.hasChildren(e),p=i,k=0;k<P-1;k+=1)p=u(n,p,!m)}}for(O=[],k=0,v=o.length;k<v;k+=1)for(x=o[k],C=O[k]=0,b=x.length;C<b;C+=1)O[k]=Math.max(O[k],l(n,x[C]));for(k=0,v=O.length;k<v;k+=1)if(1<(S=O[k]))for(C=0,b=s[k].length;C<b;C+=1)if(I=s[k][C],n.hasChildren(I.id))for(P=S;1<P;)I=u(n,I,!1),P-=1;null!=B[e]&&r(n,i,B[e])}})}function r(e,t,n){var i,o,a,r,l,m,h=0,p=[];for(o=0,a=n.length;o<a;o+=1)i=n[o],h=Math.max(h,i.visualDepth);for(o=0,a=n.length;o<a;o+=1){for(l=s(e,i=n[o]),r=1,m=i;null!=m.visualAggregatorId;)(m=e.node(m.visualAggregatorId)).connectorPlacement=5,r+=1;for(;r<h;)l=u(e,l,!1),r+=1;p.push(s(e,l).id)}if(m=s(e,t),e.hasChildren(m.id)){if(l=n[Math.floor(n.length/2)],1<n.length&&0==n.length%2)for(o=e.parent(l.id),a=c(e,T.navigationFamily,l),r=e.getChild(o.id,a).gravity||e.getChild(o.id,a+1).gravity,l=d({visibility:4,connectorPlacement:10&l.connectorPlacement,gravity:r}),e.add(o.id,l.id,l,a+1),r=1;r<h;)(l=u(e,l,!1)).connectorPlacement=0,r+=1;for(o=0,a=n.length;o<a;o+=1)i=n[o],T.navigationFamily.loopChildren(this,t.id,function(e,n){switch(n.actualItemType){case 5:case 2:case 4:case 1:break;default:t.id!=i.id&&g(i,n)}return T.navigationFamily.SKIP});l=s(e,l),e.moveChildren(m.id,l.id)}l.partners=p}function s(e,t){for(var n=t;null!=n.visualAggregatorId;)n=e.node(n.visualAggregatorId);return n}function l(e,t){var n=0;return e.loopLevels(this,t.id,function(e,t,i){n=i+1}),n+1}function m(e,t,n,i){return 0<i%2&&(t===i-1?t=e.length:t===i&&(t=i-1)),(t=n*i+t)>e.length-1?null:e[t]}function c(e,t,n){var i=null,o={},a=e.parent(n.id);return e.loopChildrenReversed(this,a.id,function(e,a,r){if(null===i)e==n.id&&(i=-1,o[n.id]=!0,t.loopChildren(this,n.id,function(e,n,i){if(0<i)return t.BREAK;o[e]=!0}));else{if(!o.hasOwnProperty(e))return i=r,!0;t.loopChildren(this,a.id,function(e,n,i){if(0<i)return t.BREAK;o[e]=!0})}}),i}function h(e,t,n){var i=null,o={},a=e.parent(n.id);return e.loopChildren(this,a.id,function(e,a,r,s){if(null===i)e==n.id&&(i=s+1,o[n.id]=!0,t.loopChildren(this,n.id,function(e,n,i){if(0<i)return t.BREAK;o[e]=!0}));else{if(!o.hasOwnProperty(e))return i=r,!0;t.loopChildren(this,e,function(e,n,i){if(0<i)return t.BREAK;o[e]=!0})}}),i}function u(e,t,n){return n=d({visibility:4,visualAggregatorId:t.visualAggregatorId,connectorPlacement:4==t.visibility&&0===t.connectorPlacement||n?0:5}),e.insert(t.id,n.id,n),t.visualAggregatorId=n.id,n}function d(t,n){var i,o=new e.orgdiagram.TreeItem;for(i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);return null!=n?(o.id=n.id,o.visibility=n.isVisible?0:4):(p+=1,o.id=p),o}function g(e,t,n){var i=[];n||4==e.visibility||!f.hasOwnProperty(e.id)?(n||i.push(e.id),T.navigationFamily.loopParents(this,e.id,function(e,t){if(4!=t.visibility&&(i.push(e),f.hasOwnProperty(e)))return T.navigationFamily.SKIP})):i.push(e.id),null!=T.navigationFamily.node(t.id)?T.navigationFamily.adopt(i,t.id):T.navigationFamily.add(i,t.id,t)}var p,f,T={visualTree:null,leftMargins:{},rightMargins:{},navigationFamily:null};return{process:function(){var o=t.getOrgTree(),r=i.getOptions();return f=null!=n?n.getActiveItems():{},T.visualTree=e.common.tree(),T.navigationFamily=e.common.family(),p=t.getMaximumId(),o.hasNodes()&&a(o,r,T.visualTree),T.leftMargins={},T.rightMargins={},function(e,t,n){e.loop(this,function(e){t[e]=[],n[e]=[]}),e.loopPostOrder(this,function(e,i,o){i=t[o];var a,r=n[o],s=t[e],l=n[e];if(null!=o){for(i[0]||(i[0]=e),o=0,a=s.length;o<a;o+=1)i[o+1]||(i[o+1]=s[o]);for(r[0]=e,o=0,a=l.length;o<a;o+=1)r[o+1]=l[o]}})}(T.visualTree,T.leftMargins,T.rightMargins),!0},getVisualTree:function(){return T.visualTree},getNavigationFamily:function(){return T.navigationFamily},getConnectionsFamily:function(){return T.connectionsFamily},getLeftMargins:function(){return T.leftMargins},getRightMargins:function(){return T.rightMargins}}},e.common.AnnotationLabelTemplate=function(){var t=["div",{type:"checkbox",name:"checkbox",class:["bp-item","bp-corner-all","bp-connector-label"]}];return{template:function(){return t},getHashCode:function(){return"defaultAnnotationLabelTemplate"},render:function(t,n){var i=n.context;e.common.isArray(i.label)?(n.element.innerHTML="",n.element.appendChild(e.common.JsonML.toHTML(i.label))):n.element.innerHTML=i.label}}},e.common.ButtonsTemplate=function(){var t=["div",{style:{position:"absolute"}}];return{template:function(){return t},getHashCode:function(){return"defaultButtonsTemplate"},render:function(t,n){var i,o,a,r=0,s=n.buttons;switch(n.renderingMode){case 0:for(a=0;a<s.length;a+=1)o=["button",{style:{position:"absolute",top:r+"px",left:"0px"},class:["orgdiagrambutton","bp-button"],"data-buttonname":(i=s[a]).name},["span",{style:{width:i.size.width+"px",height:i.size.height+"px"},class:["bp-icon",i.icon]}]],n.element.appendChild(e.common.JsonML.toHTML(o)),r+=10+i.size.height}}}},e.common.CheckBoxTemplate=function(e){var t=["div",["label",["nobr",["input",{type:"checkbox",name:"checkbox",class:"bp-selectioncheckbox"}]," ",["span",{name:"selectiontext",class:"bp-selectiontext"},e]]]];return{template:function(){return t},getHashCode:function(){return"defaultCheckBoxTemplate"},render:function(e,t){var n=t.element.firstChild.firstChild.firstChild;n.checked=t.isSelected,n.setAttribute("data-id",t.id),t.element.firstChild.firstChild.childNodes[2].setAttribute("data-id",t.id)}}},e.common.CursorTemplate=function(e,t){var n=["div",{style:{width:t.itemSize.width+t.cursorPadding.left+t.cursorPadding.right+"px",height:t.itemSize.height+t.cursorPadding.top+t.cursorPadding.bottom+"px",borderWidth:t.cursorBorderWidth+"px"},class:["bp-item","bp-corner-all","bp-cursor-frame"]}];return{template:function(){return n},getHashCode:function(){return"defaultCursorTemplate"},render:function(){}}},e.common.DotHighlightTemplate=function(e,t){var n,i=t.minimizedItemCornerRadius;return null==i&&(i=Math.max(t.highlightPadding.left+t.minimizedItemSize.width+t.highlightPadding.right,t.highlightPadding.top+t.minimizedItemSize.height+t.highlightPadding.bottom)+t.highlightBorderWidth),n=["div",{style:{borderWidth:t.highlightBorderWidth+"px",MozBorderRadius:i+"px",WebkitBorderRadius:i+"px","-khtml-border-radius":i+"px",borderRadius:i+"px"},class:["bp-item","bp-highlight-dot-frame"]}],{template:function(){return n},getHashCode:function(){return"defaultDotHighlightTemplate"},render:function(){}}},e.common.GroupTitleTemplate=function(t){var n={style:{fontSize:t.groupTitleFontSize,fontFamily:t.groupTitleFontFamily,fontWeight:t.groupTitleFontWeight,fontStyle:t.groupTitleFontStyle},class:["bp-item","bp-corner-all","bp-grouptitle-frame"]},i=t.groupTitleVerticalAlignment,o="";switch(t.groupTitleOrientation){case 1:o="rotate(-90deg)";break;case 2:o="rotate(90deg)"}var a=t.groupTitleFontSize,r=t.groupTitleFontFamily,s=t.groupTitleFontWeight,l=t.groupTitleFontStyle,m=null;switch(t.groupTitleHorizontalAlignment){case 0:m="center";break;case 1:m="left";break;case 2:m="right"}switch(o={fontSize:a,fontFamily:r,fontWeight:s,fontStyle:l,position:"absolute",padding:0,margin:0,textAlign:m,lineHeight:1,"-webkit-transform-origin":"center center","-moz-transform-origin":"center center","-o-transform-origin":"center center","-ms-transform-origin":"center center","-webkit-transform":o,"-moz-transform":o,"-o-transform":o,"-ms-transform":o,transform:o},i){case 0:i=["div",{style:o,class:["bp-title-content","bp-item","bp-corner-all"]}];break;default:switch(o.borderCollapse="collapse",o={style:o},a=null,i){case 1:a="middle";break;case 0:a="top";break;case 2:a="bottom"}i=["table",o,["tbody",["tr",["td",{style:{verticalAlign:a,padding:0},class:"bp-title-content"}]]]]}var c=["div",n,i];return{template:function(){return c},getHashCode:function(){return"defaultGroupTitleTemplate"},render:function(n,i){var o=i.context,a=o.groupTitleColor||t.groupTitleColor,r={},s=i.width,l=i.height;switch(r.left=Math.round(s/2-l/2)+"px",r.top=Math.round(l/2-s/2)+"px",r.width=l+"px",r.height=s+"px",r.maxWidth=r.width,r.maxHeight=r.height,e.common.JsonML.applyStyles(i.element.firstChild,r),o=(o=o.groupTitle||"").replace(RegExp("\n","g"),"<br/>"),t.groupTitleVerticalAlignment){case 0:r=i.element.firstChild;break;default:(r=i.element.firstChild.firstChild.firstChild.firstChild).style.borderCollapse="collapse"}r.style.color=e.common.highestContrast(a,t.itemTitleSecondFontColor,t.itemTitleFirstFontColor),r.textContent=o,e.common.JsonML.applyStyles(i.element,{backgroundColor:a})}}},e.common.HighlightTemplate=function(e,t){var n=["div",{style:{borderWidth:t.highlightBorderWidth+"px"},class:["bp-item","bp-corner-all","bp-highlight-frame"]}];return{template:function(){return n},getHashCode:function(){return"defaultHighlightTemplate"},render:function(){}}},e.common.ItemTemplate=function(t,n){var i,o=new e.common.Size(n.itemSize);return o.width-=2*n.itemBorderWidth,o.height-=2*n.itemBorderWidth,i=["div",{style:{borderWidth:n.itemBorderWidth+"px"},class:["bp-item","bp-corner-all","bt-item-frame"]},["div",{name:"titleBackground",style:{top:"2px",left:"2px",width:o.width-4+"px",height:"18px"},class:["bp-item","bp-corner-all","bp-title-frame"]},["div",{name:"title",style:{top:"1px",left:"4px",width:o.width-4-8+"px",height:"16px"},class:["bp-item","bp-title"]}]],["div",{name:"photoBorder",style:{top:"24px",left:"2px",width:"50px",height:"60px"},class:["bp-item","bp-photo-frame"]},["img",{name:"photo",alt:"",style:{width:"50px",height:"60px"}}]],["div",{name:"description",style:{top:"24px",left:"56px",width:o.width-4-56+"px",height:"74px"},class:["bp-item","bp-description"]}]],{template:function(){return i},getHashCode:function(){return"defaultItemTemplate"},render:function(n,i){var o=i.context,a=null!=o.itemTitleColor?o.itemTitleColor:"#4169e1",r=e.common.highestContrast(a,t.itemTitleSecondFontColor,t.itemTitleFirstFontColor),s=(c=i.element).firstChild,l=c.childNodes[1].firstChild,m=s.firstChild,c=c.childNodes[2];e.common.JsonML.applyStyles(s,{backgroundColor:a}),l.src=o.image,l.alt=o.title,e.common.JsonML.applyStyles(m,{color:r}),m.textContent=o.title,c.textContent=o.description}}},e.common.UserTemplate=function(t,n,i){var o=e.common.hashCode(JSON.stringify(n));return{template:function(){return n},getHashCode:function(){return o},render:function(n,o){if(null!=i)i(n,o);else{var a=o.context,r=null!=a.itemTitleColor?a.itemTitleColor:"#4169e1",s=e.common.highestContrast(r,t.itemTitleSecondFontColor,t.itemTitleFirstFontColor);e.common.getElementsByName(this,o.element,"photo",function(e){e.src=a.image,e.alt=a.title}),e.common.getElementsByName(this,o.element,"titleBackground",function(t){e.common.JsonML.applyStyles(t,{background:r})}),e.common.getElementsByName(this,o.element,"title",function(t){e.common.JsonML.applyStyles(t,{color:s}),t.textContent=a.title}),e.common.getElementsByName(this,o.element,"description",function(e){e.textContent=a.description})}}}},e.orgdiagram.BaseControl=function(t,n,i,o,a){function r(n,o){switch(null==o&&(o=!0),n){case 1:s(o,R);break;case 2:var r=R;L.layout.forceCenterOnCursor=!1,L.tasks.process("HighlightItemOptionTask",null,r),L.graphics.end();break;default:g(L.layout),d(L.layout);var b=L.layout,P=(r=L.name,e.common.getInnerSize(b.element)),O=(P=new e.common.Rect(0,0,P.width,P.height),new e.common.Rect(P)),S=e.common.getFixOfPixelALignment(t);e.common.JsonML.appendDOM(b.element,e.common.JsonML.toHTML(["div",{tabindex:0,style:{position:"relative",overflow:"auto","-webkit-overflow-scrolling":"touch",top:"0px",left:"0px",width:P.width+"px",height:P.height+"px",padding:"0px",marginBottom:"0px",marginRight:"0px",marginLeft:S.width+"px",marginTop:S.height+"px"},class:r,$:function(e){b.scrollPanel=e}},["div",{style:e.common.mergeObjects({position:"absolute",overflow:"hidden"},O.getCSS()),class:r,$:function(e){b.mousePanel=e}},["div",{style:e.common.mergeObjects({position:"absolute",overflow:"hidden"},O.getCSS()),class:["placeholder",r],$:function(e){b.placeholder=e}},["div",{style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",width:"0px",height:"0px"},class:["calloutplaceholder",r],$:function(e){b.calloutPlaceholder=e}}]]]])),(r=L.layout).mousePanel.addEventListener("mousemove",p),r.mousePanel.addEventListener("click",T),r.mousePanel.addEventListener("dblclick",y),r.mousePanel.addEventListener("change",f),r.scrollPanel.addEventListener("keydown",k),r.scrollPanel.addEventListener("scroll",l),L.options.enablePanning&&e.common.isChrome()&&(r.scrollPanel.draggable=!0,r.scrollPanel.addEventListener("dragstart",v),r.scrollPanel.addEventListener("drag",C),r.scrollPanel.addEventListener("dragend",C),r.scrollPanel.addEventListener("dragover",w)),L.tasks=i(m,c,h,u,a),L.graphics=e.common.createGraphics(L.options.graphicsType,L.layout.element),L.graphics.debug=R,s(!0,R)}}function s(t,n){var i;L.layout.forceCenterOnCursor=t,L.tasks.process("OptionsTask",null,n),L.graphics.end(),t&&(i=(i=L.tasks.getTask("CenterOnCursorTask")).getPlaceholderOffset(),L.layout.scrollPanel.scrollLeft=i.x,L.layout.scrollPanel.scrollTop=i.y),i=e.common.getFixOfPixelALignment(L.layout.element),e.common.JsonML.applyStyles(L.layout.scrollPanel,{top:"0px",left:"0px",marginBottom:"0px",marginRight:"0px",marginLeft:i.width+"px",marginTop:i.height+"px"})}function l(){null==z&&(z=window.setTimeout(function(){var e=R;L.layout.forceCenterOnCursor=!1,L.tasks.process("LayoutOptionsTask",null,e),L.graphics.end(),window.clearTimeout(z),z=null},200))}function m(){return L.options}function c(){return L.graphics}function h(){var t=L.layout,n=e.common.getInnerSize(t.element),i=new e.common.Point(t.scrollPanel.scrollLeft,t.scrollPanel.scrollTop);return{forceCenterOnCursor:t.forceCenterOnCursor,scrollPanelSize:n,placeholderOffset:i}}function u(t){var n=L.layout,i=new e.common.Size(t.contentSize);i.scale(1*t.scale),e.common.JsonML.applyStyles(n.mousePanel,i.getCSS()),e.common.JsonML.applyStyles(n.placeholder,t.contentSize.getCSS());var o="scale("+t.scale+","+t.scale+")";return e.common.JsonML.applyStyles(n.placeholder,{"transform-origin":"0 0",transform:o,"-ms-transform":o,"-webkit-transform":o,"-o-transform":o,"-moz-transform":o}),o=new e.common.Size(t.scrollPanelSize),t.autoSize&&((o=new e.common.Size(i.width+25,i.height+25)).cropBySize(t.autoSizeMaximum),o.addSize(t.autoSizeMinimum),e.common.JsonML.applyStyles(n.element,o.getCSS())),e.common.JsonML.applyStyles(n.scrollPanel,o.getCSS()),o}function d(){if(null!=L.layout.scrollPanel){var e=L.layout.scrollPanel.parentNode;null!=e&&e.removeChild(L.layout.scrollPanel)}}function g(e){null!=e.mousePanel&&(e.mousePanel.removeEventListener("mousemove",p),e.mousePanel.removeEventListener("click",T),e.mousePanel.removeEventListener("dblclick",y),e.mousePanel.removeEventListener("change",f)),null!=e.scrollPanel&&(e.scrollPanel.removeEventListener("keydown",k),e.scrollPanel.removeEventListener("scroll",l),e.scrollPanel.removeEventListener("dragstart",v),e.scrollPanel.removeEventListener("drag",C),e.scrollPanel.removeEventListener("dragend",C),e.scrollPanel.removeEventListener("dragover",w))}function p(t){var n=e.common.getElementOffset(L.layout.mousePanel),i=t.pageX-n.left,o=(n=t.pageY-n.top,L.tasks.getTask("CreateTransformTask")),a=L.tasks.getTask("HighlightItemOptionTask");a.hasHighlightEnabled()&&b(t,i=o.getTreeItemForMousePosition(i,n,a.getGravityRadius()))}function f(t){var n=t.target,i=n.getAttribute("data-id");if(null!=i){var a=(L.options.selectedItems||[]).slice(),r=o(L,null,i,void 0),s=e.common.indexOf(a,i);O("onSelectionChanging",t,r),r.cancel||(0<=s?a.splice(s,1):a.push(i),L.options.selectedItems=a,0>s?n.setAttribute("checked","checked"):n.removeAttribute("checked"),O("onSelectionChanged",t,r))}}function T(t){var n=e.common.getElementOffset(L.layout.mousePanel),i=t.pageX-n.left,a=t.pageY-n.top,r=L.tasks.getTask("CreateTransformTask"),s=(n=L.tasks.getTask("CursorItemOptionTask"),L.tasks.getTask("HighlightItemOptionTask"));i=r.getTreeItemForMousePosition(i,a,s.getGravityRadius()),a=t.target;null!==i&&(e.common.hasClass(a,L.name+"button")||e.common.hasClass(a.parentNode,L.name+"button")?(n=(n=e.common.hasClass(a,L.name+"button")?a:a.parentNode).getAttribute("data-buttonname"),O("onButtonClick",t,a=o(L,null,i,n))):"checkbox"===a.getAttribute("name")||"selectiontext"===a.getAttribute("name")||(O("onMouseClick",t,a=o(L,null,i,void 0)),!a.cancel&&n.hasCursorEnabled()&&(P(t,i),L.layout.scrollPanel.focus())))}function y(e){var t;null!==(t=L.tasks.getTask("HighlightItemTask").getHighlightTreeItem())&&O("onMouseDblClick",e,t=o(L,null,t,void 0))}function k(e){var t=L.tasks.getTask("HighlightItemTask"),n=L.tasks.getTask("HighlightItemOptionTask"),i=L.tasks.getTask("CursorItemTask"),o=L.tasks.getTask("CursorItemOptionTask"),a=L.tasks.getTask("AlignDiagramTask"),r=L.tasks.getTask("CreateTransformTask").getTransform(),s=null,l=null,m=L.layout;if(n.hasHighlightEnabled()&&o.hasCursorEnabled()?null===(s=t.getHighlightTreeItem())&&(s=i.getCursorTreeItem()):n.hasHighlightEnabled()?s=t.getHighlightTreeItem():o.hasCursorEnabled()&&(s=i.getCursorTreeItem()),null!=s){switch(e.which){case 13:o.hasCursorEnabled()&&(P(e,s),e.preventDefault(),m.scrollPanel.focus());break;case 40:l=1;break;case 38:l=0;break;case 37:l=2;break;case 39:l=3}if(null!=l){for(i=!1;!i;)i=!0,l=r.getOrientation(l),null!=(t=a.getNextItem(s,l))&&(e.preventDefault(),n.hasHighlightEnabled()?b(e,t):o.hasCursorEnabled()&&P(e,t));m.scrollPanel.focus()}}}function v(t){var n=L.layout.scrollPanel;S=new e.common.Point(t.clientX,t.clientY),I=new e.common.Point(n.scrollLeft,n.scrollTop),A=A||new Image,t.dataTransfer.setDragImage(A,0,0)}function w(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function C(t){x=new e.common.Point(I.x-(t.clientX-S.x),I.y-(t.clientY-S.y)),null==M&&(M=window.setTimeout(function(){var e=L.layout.scrollPanel;e.scrollLeft=x.x,e.scrollTop=x.y,window.clearTimeout(M),M=null},50))}function b(e,t){var n,i=!0;return null!==t?t!==L.options.highlightItem&&(n=o(L,L.options.highlightItem,t,void 0),L.options.highlightItem=t,O("onHighlightChanging",e,n),n.cancel?i=!1:(s(!1,!1),O("onHighlightChanged",e,n))):null!==L.options.highlightItem&&(n=o(L,L.options.highlightItem,null,void 0),L.options.highlightItem=null,O("onHighlightChanging",e,n),n.cancel?i=!1:(s(!1,!1),O("onHighlightChanged",e,n))),i}function P(e,t){var n;t!==L.options.cursorItem&&(n=o(L,L.options.cursorItem,t,void 0),L.options.cursorItem=t,O("onCursorChanging",e,n),n.cancel||(s(!0,R),O("onCursorChanged",e,n)))}function O(e,t,n){null!=(e=L.options[e])&&e(t,n)}var S,I,x,A,M,L={name:"orgdiagram",options:n,tasks:null,graphics:null,mouse:null,layout:{element:t,scrollPanel:null,mousePanel:null,placeholder:null,calloutPlaceholder:null,forceCenterOnCursor:!0}},R=!1,z=null;return r(),{destroy:function(){g(L.layout),d(L.layout),L.tasks=null,L.graphics=null},setOptions:function(e){for(var t in e)e.hasOwnProperty(t)&&(L.options[t]=e[t])},getOptions:m,setOption:function(e,t){return L.options[e]=t},getOption:function(e){return L.options[e]},update:r}},e.orgdiagram.Control=function(t,n){return e.orgdiagram.BaseControl(t,n,e.orgdiagram.TaskManagerFactory,e.orgdiagram.EventArgsFactory,{AnnotationLabelTemplate:e.common.AnnotationLabelTemplate,ButtonsTemplate:e.common.ButtonsTemplate,CheckBoxTemplate:e.common.CheckBoxTemplate,CursorTemplate:e.common.CursorTemplate,DotHighlightTemplate:e.common.DotHighlightTemplate,GroupTitleTemplate:e.common.GroupTitleTemplate,HighlightTemplate:e.common.HighlightTemplate,ItemTemplate:e.common.ItemTemplate,UserTemplate:e.common.UserTemplate,LabelAnnotationTemplate:e.common.LabelAnnotationTemplate})},e.orgdiagram.EventArgsFactory=function(t,n,i,o){var a=new e.orgdiagram.EventArgs,r=t.tasks.getTask("CombinedContextsTask"),s=t.tasks.getTask("AlignDiagramTask"),l=(n=r.getConfig(n),r.getConfig(i));return n&&null!=n.id&&(a.oldContext=n),l&&null!=l.id&&(a.context=l,null!==l.parent&&(a.parentItem=r.getConfig(l.parent)),r=e.common.getElementOffset(t.layout.mousePanel),t=e.common.getElementOffset(t.layout.element),i=s.getItemPosition(i),a.position=new e.common.Rect(i.actualPosition).translate(r.left,r.top).translate(-t.left,-t.top)),null!=o&&(a.name=o),a},e.orgdiagram.getProcessDiagramConfig=function(){var t=function(){};return e.orgdiagram.TaskManagerFactory(t,t,t).getProcessDiagramConfig()},e.orgdiagram.TaskManagerFactory=function(t,n,i,o,a){var r=new e.common.TaskManager;return r.addDependency("options",t),r.addDependency("graphics",n),r.addDependency("getLayout",i),r.addDependency("setLayout",o),r.addDependency("templates",a),r.addDependency("defaultConfig",new e.orgdiagram.Config),r.addDependency("defaultItemConfig",new e.orgdiagram.ItemConfig),r.addDependency("defaultTemplateConfig",new e.orgdiagram.TemplateConfig),r.addDependency("defaultButtonConfig",new e.orgdiagram.ButtonConfig),r.addDependency("defaultBackgroundAnnotationConfig",new e.orgdiagram.BackgroundAnnotationConfig),r.addDependency("defaultConnectorAnnotationConfig",new e.orgdiagram.ConnectorAnnotationConfig),r.addDependency("defaultHighlightPathAnnotationConfig",new e.orgdiagram.HighlightPathAnnotationConfig),r.addDependency("defaultShapeAnnotationConfig",new e.orgdiagram.ShapeAnnotationConfig),r.addDependency("isFamilyChartMode",!1),r.addDependency("showElbowDots",!1),r.addDependency("null",null),r.addDependency("foreground",2),r.addDependency("background",1),r.addTask("OptionsTask",["options"],e.orgdiagram.OptionsTask,"#000000"),r.addTask("LayoutOptionsTask",["getLayout","OptionsTask"],e.orgdiagram.LayoutOptionsTask,"#000000"),r.addTask("CurrentControlSizeTask",["LayoutOptionsTask","ItemsSizesOptionTask"],e.orgdiagram.CurrentControlSizeTask,"#000000"),r.addTask("CurrentScrollPositionTask",["LayoutOptionsTask"],e.orgdiagram.CurrentScrollPositionTask,"#000000"),r.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.orgdiagram.CalloutOptionTask,"#000080"),r.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ConnectorsOptionTask,"#000080"),r.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],e.orgdiagram.ItemsOptionTask,"#000080"),r.addTask("ItemsContentOptionTask",["OptionsTask","defaultItemConfig"],e.orgdiagram.ItemsContentOptionTask,"#000080"),r.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],e.orgdiagram.ItemsSizesOptionTask,"#000080"),r.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.orgdiagram.LabelsOptionTask,"#000080"),r.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],e.orgdiagram.TemplatesOptionTask,"#000080"),r.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.OrientationOptionTask,"#000080"),r.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.VisualTreeOptionTask,"#000080"),r.addTask("MinimizedItemsOptionTask",["OptionsTask"],e.orgdiagram.MinimizedItemsOptionTask,"#000080"),r.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.CursorItemOptionTask,"#000080"),r.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.HighlightItemOptionTask,"#000080"),r.addTask("SelectedItemsOptionTask",["OptionsTask"],e.orgdiagram.SelectedItemsOptionTask,"#000080"),r.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.CursorSelectionPathModeOptionTask,"#000080"),r.addTask("SplitAnnotationsOptionTask",["OptionsTask"],e.orgdiagram.SplitAnnotationsOptionTask,"#00ffff"),r.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),r.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),r.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),r.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),r.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),r.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),r.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],e.orgdiagram.BackgroundAnnotationOptionTask,"#000080"),r.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ScaleOptionTask,"#000080"),r.addTask("CombinedContextsTask",["ItemsContentOptionTask"],e.orgdiagram.CombinedContextsTask,"#00ffff"),r.addTask("OrgTreeTask",["ItemsOptionTask"],e.orgdiagram.OrgTreeTask,"#ff0000"),r.addTask("ReadTemplatesTask",["TemplatesOptionTask","templates"],e.orgdiagram.ReadTemplatesTask,"#00ffff"),r.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],e.orgdiagram.ActiveItemsTask,"#00ffff"),r.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],e.orgdiagram.ItemTemplateParamsTask,"#00ffff"),r.addTask("GroupTitleTemplateTask",["TemplatesOptionTask","templates"],e.orgdiagram.GroupTitleTemplateTask,"#00ffff"),r.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask","templates"],e.orgdiagram.CheckBoxTemplateTask,"#00ffff"),r.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask","templates"],e.orgdiagram.ButtonsTemplateTask,"#00ffff"),r.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask","templates"],e.orgdiagram.AnnotationLabelTemplateTask,"#00ffff"),r.addTask("VisualTreeTask",["OrgTreeTask","ActiveItemsTask","VisualTreeOptionTask","isFamilyChartMode"],e.orgdiagram.VisualTreeTask,"#ff0000"),r.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],e.orgdiagram.VisualTreeLevelsTask,"#ff0000"),r.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],e.orgdiagram.ConnectionsGraphTask,"#00ffff"),r.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],e.orgdiagram.HighlightItemTask,"#00ffff"),r.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],e.orgdiagram.CursorItemTask,"#00ffff"),r.addTask("CursorNeighboursTask",["CursorItemTask","VisualTreeTask"],e.orgdiagram.CursorNeighboursTask,"#00ffff"),r.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],e.orgdiagram.SelectedItemsTask,"#00ffff"),r.addTask("SelectionPathItemsTask",["VisualTreeTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],e.orgdiagram.SelectionPathItemsTask,"#00ffff"),r.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",["ForegroundConnectorAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff"),r.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],e.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff"),r.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),e.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff"),r.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask VisualTreeTask VisualTreeLevelsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),e.orgdiagram.ItemsPositionsTask,"#ff0000"),r.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask ActiveItemsTask ItemsPositionsTask isFamilyChartMode".split(" "),e.orgdiagram.AlignDiagramTask,"#ff0000"),r.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],e.orgdiagram.CreateTransformTask,"#00ffff"),r.addTask("CenterOnCursorTask","LayoutOptionsTask CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),e.orgdiagram.CenterOnCursorTask,"#00ffff"),r.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],e.orgdiagram.PaletteManagerTask,"#00ffff"),r.addTask("ApplyLayoutChangesTask","graphics setLayout ItemsSizesOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),e.orgdiagram.ApplyLayoutChangesTask,"#008000"),r.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask".split(" "),e.orgdiagram.DrawBackgroundAnnotationTask,"#008000"),r.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),r.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),r.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),r.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),r.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),r.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),r.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),e.orgdiagram.DrawCursorTask,"#008000"),r.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),e.orgdiagram.DrawHighlightTask,"#008000"),r.addTask("DrawHighlightAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),e.orgdiagram.DrawHighlightAnnotationTask,"#008000"),r.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CenterOnCursorTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),e.orgdiagram.DrawTreeItemsTask,"#008000"),r.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask ItemTemplateParamsTask AlignDiagramTask".split(" "),e.orgdiagram.DrawMinimizedItemsTask,"#008000"),r.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],e.orgdiagram.DrawConnectorsTask,"#008000"),r.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],e.orgdiagram.DrawItemLabelsTask,"#008000"),r},e.common.binarySearch=function(e,t,n,i){var o,a,r,s=null,l=(n=n||0,i||e.length-1);if(0<e.length&&(s={index:n,item:r=e[n]},0<(i=t(r,n))))if(o=Math.abs(i),0<=(i=t(r=e[l],l)))s={index:l,item:r};else for(o>(i=Math.abs(i))&&(o=i,s={index:l,item:r});n+1<l;){if(0===(i=t(r=e[a=Math.round((n+l)/2)],a))){s={index:a,item:r};break}0<i?n=a:l=a,o>(i=Math.abs(i))&&(o=i,s={index:a,item:r})}return s},e.common.family=function(t){function n(e,t,n,i){var o;if(null!=i&&null!=(t=t[n]))for(o in t)if(t.hasOwnProperty(o)&&i.call(e,o,t[o]))break}function i(e,t){var n=!1;return null!=S[e]&&null!=S[e][t]&&(delete S[e][t],I[e]-=1,delete x[t][e],A[t]-=1,I[e]||(delete S[e],delete I[e]),x[t]||(delete x[t],delete A[t],null==P.null&&(P.null={},O.null=0),P.null[t]=!0,O.null+=1),n=!0),n}function o(e,t){var n;if(null!=t)for(n in M)if(M.hasOwnProperty(n)&&t.call(e,n,M[n]))break}function a(e,t,i,o){for(var a,r,s={},l=0,m=!0;m;){for(r in a={},m=!1,i)if(i.hasOwnProperty(r)&&!s[r])switch(s[r]=!0,o.call(e,r,M[r],l)){case 1:a={},m=!1;break;case 2:break;default:n(this,t,r,function(e){s[e]||(m=a[e]=!0)})}i=a,l+=1}}function r(e,t,n){null!=n&&null!=t&&null!=M[t]&&null!=S[t]&&a(e,S,S[t],n)}function s(e,t,n){null!=n&&null!=t&&null!=M[t]&&null!=x[t]&&a(e,x,x[t],n)}function l(e,t,i,o,a,r){var s,l,m,c;if(null!=r){for(s in t=[],l={},M)M.hasOwnProperty(s)&&(l[s]=i[s]||0,l[s]||t.push(s));for(c=0;0<t.length;){for(m=[],i=0,a=t.length;i<a;i+=1){if(s=t[i],r.call(e,s,M[s],c)){m=[];break}c+=1,n(this,o,s,function(e){l[e]-=1,0===l[e]&&m.push(e)})}t=m}}}function m(e,t){l(e,x,A,S,I,t)}function c(e,t){l(e,S,I,x,A,t)}function h(e,t,n,i,o,a,r,s,l){var m,c,h=!1;if(null!=M[e]&&null!=r[e]){if(h=!0,l)for(l=0,m=t.length;l<m;l+=1)c=t[l],(null==M[c]||null==r[e][c])&&(h=!1);if(h&&(null!=i&&(M[n]=i),null!=M[n]))for(o[n]||(o[n]={},a[n]=0),r[n]||(r[n]={},s[n]=0),o[n][e]||(o[n][e]=!0,a[n]+=1),r[e][n]||(r[e][n]=!0,s[e]+=1),l=0,m=t.length;l<m;l+=1)n!=(c=t[l])&&(null!=r[e][c]&&(delete r[e][c],s[e]-=1),null!=o[c][e]&&(delete o[c][e],a[c]-=1),o[c][n]||(o[c][n]=!0,a[c]+=1),r[n][c]||(r[n][c]=!0,s[n]+=1))}return h}function u(e,t,n,i){return h(e,t,n,i,x,A,S,I,!0)}function d(){this.key=this.id="",this.children=[],this.childrenHash={},this.processed=!1}function g(e){this.items=[],this.difference=this.weight=0,0<arguments.length&&(this.difference=e)}function p(t){var i,o,a,r,s,l,m,c,h=e.common.graph(),u={};for(i in t)t.hasOwnProperty(i)&&n(this,S,i,function(e){if(!u.hasOwnProperty(e))for(u[e]=!0,o=[],n(this,x,e,function(e){o.push(e)}),a=0,s=o.length;a<s-1;a+=1)if(l=o[a],t.hasOwnProperty(l))for(r=a+1;r<s;r+=1)if(m=o[r],t.hasOwnProperty(m)){c=Math.abs(t[l].children.length-t[m].children.length);var i=h.edge(l,m);null==i&&(i=new g(c),h.addEdge(l,m,i)),i.items.push(e),i.weight+=1}});return h}function f(e,t){this.parentid=e,this.childid=t,this.key=e+","+t}function T(e,t){this.from=e,this.to=t,this.distance=0}function y(e){return I[e]||0}function k(e){return A[e]||0}function v(e){var t=null;e=S[e]||{};for(t in e)if(e.hasOwnProperty(t))return t;return null}function w(e){var t=null;e=x[e]||{};for(t in e)if(e.hasOwnProperty(t))return t;return null}function C(e,t){this.parentid=e,this.childid=t,this.ids=[],this.nodes=[]}function b(){return e.common.family({roots:P,rootsCount:O,children:S,childrenCount:I,parents:x,parentsCount:A,nodes:M})}var P={},O={},S={},I={},x={},A={},M={};return e.common.isObject(t)&&(P=e.common.cloneObject(t.roots,!1),O=e.common.cloneObject(t.rootsCount,!0),S=e.common.cloneObject(t.children,!1),I=e.common.cloneObject(t.childrenCount,!0),x=e.common.cloneObject(t.parents,!1),A=e.common.cloneObject(t.parentsCount,!0),M=e.common.cloneObject(t.nodes,!0)),{add:function(e,t,i){var o,a,r={};if(e&&0!==e.length||(e=[null]),null==M[t]&&null!=i){for(M[t]=i,i=0,o=e.length;i<o;i+=1)null==r[a=e[i]]&&a!=t&&(r[a]=!0,null!=M[a]?(null==x[t]&&(x[t]={},A[t]=0),x[t][a]||(x[t][a]=!0,A[t]+=1),null==S[a]&&(S[a]={},I[a]=0),S[a][t]||(S[a][t]=!0,I[a]+=1)):(null==P[a]&&(P[a]={},O[a]=0),P[a][t]||(P[a][t]=!0,O[a]+=1)));null!=P[t]&&(S[t]=P[t],I[t]=O[t],delete P[t],delete O[t],n(this,S,t,function(e){null==x[e]&&(x[e]={},A[e]=0),x[e][t]||(x[e][t]=!0,A[e]+=1)}))}},adopt:function(e,t){var n,i,o;if(null==M[t])throw"Child should be in hierarchy!";for(n=0,i=e.length;n<i;n+=1){if(o=e[n],null==x[t]&&(x[t]={},A[t]=0),o==t||null==M[o])throw"Item cannot be parent of itself and parent should exist in the structure!";x[t][o]||(x[t][o]=!0,A[t]+=1),null==S[o]&&(S[o]={},I[o]=0),S[o][t]||(S[o][t]=!0,I[o]+=1)}},bundleChildren:u,bundleParents:function(e,t,n,i){return h(e,t,n,i,S,I,x,A,!0)},optimizeReferences:function(t){var i,o,a,s,l,m,c={},u={},g={};l=0;var f,T=10;if(null!=t){for(i in M)l+=1,M.hasOwnProperty(i)&&(o=new d,n(this,S,i,function(e){o.children.push(e),o.childrenHash[e]=!0}),o.children.sort(),o.id=i,o.key=o.children.join(","),g[o.id]=o);for(T=Math.pow(10,l.toString().length);!e.common.isEmptyObject(g);){for(i in a={},f={},s=p(g),g)g.hasOwnProperty(i)&&((l=g[i]).processed||(m=s.getSpanningTree(i,function(e){return e.weight*T+T-e.difference})).loopLevels(this,function(e,n){g[e].processed=!0,m.loopChildren(this,e,function(i,o){var l,m,p,T,y,k,v=s.edge(e,i),w=null;if(g[i].processed=!0,1<v.weight){if(m=v.items.join(","),c.hasOwnProperty(m))w=c[m];else{for(l=t(),M[l.id]=l,(w=new d).id=l.id,w.key=m,m=0,p=v.items.length;m<p;m+=1)k=v.items[m],w.children.push(k),w.childrenHash[k]=!0,f[k]=!0;w.children.sort(),c[w.key]=w,u[w.id]=w,a[w.id]=w,f[w.id]=w,T=w.children.slice(0),r(this,n.replacementItem||e,function(e){return!w.childrenHash[e]&&null!=u[e]&&(y=!0,r(this,e,function(e){return w.childrenHash[e]?f.hasOwnProperty(e)?void 0:2:(y=!1,1)}),y&&T.push(e)),2}),h(n.replacementItem||e,T,w.id,l,x,A,S,I,!1),1>=(I[e]||0)&&null==n.replacementItem&&(n.replacementItem=w.id)}w.id!=i&&(T=w.children.slice(0),r(this,o.replacementItem||i,function(e){return null!=u[e]&&!w.childrenHash[e]&&(y=!0,r(this,e,function(e){return w.childrenHash[e]?(f.hasOwnProperty(e),2):(y=!1,1)}),y&&T.push(e)),2}),h(o.replacementItem||i,T,w.id,null,x,A,S,I,!1),1>=(I[i]||0)&&null==o.replacementItem)&&(o.replacementItem=w.id)}})}));g=a}}},eliminateManyToMany:function(e){var t,i;for(t in S)S.hasOwnProperty(t)&&1<(I[t]||0)&&n(this,S,t,function(n){1<(A[n]||0)&&(i=e(),u(t,[n],i.id,i))})},groupBy:function(e,t,n){if(null!=n){var i,o={};for(i in M){var a=I[i]||0;if(1>=(A[i]||0)&&1>=a){a=w(i);var r=v(i),s=a+" * "+r;o.hasOwnProperty(s)||(o[s]=new C(a,r)),o[s].ids.push(i),o[s].nodes.push(M[i])}}for(s in o)if(o.hasOwnProperty(s)&&((i=o[s]).ids.length>=t&&n.call(e,i.parentid,i.childid,i.ids,i.nodes)))break}},getPlanarFamily:function(t){var n,i,o=new e.common.family;return t.loopLevels(this,function(a){var s=new e.common.LinkedHashItems,l={},m={},c=[];t.loopLevelItems(this,a,function(e){if(r(this,e,function(n){var i=t.getItemPosition(n),o=new f(e,n);m[o.key]=o;var a=[];s.isEmpty()?s.add(i,[o]):(s.iterateBack(function(t,n){if(n<i)return s.insertAfter(n,i,[o]),!0;if(n==i)return t.push(o),!0;for(var r=0,l=t.length;r<l;r+=1){var m=t[r];m.parentid!=e&&a.push(m)}}),s.startKey()>i&&s.unshift(i,[o])),l[o.key]=a;n=0;for(var r=a.length;n<r;n+=1)l[a[n].key].push(o);return 2}),1==y(e)){var n=v(e);1==k(n)&&(n=new f(e,n),c.push(n.key))}});var h,u;a=[];for(u in l){var d=(h=l[u]).length;null!=a[d]?a[d].push(u):a[d]=[u]}d={},a.unshift(c);for(var g=0,p=a.length;g<p;g+=1){var T=a[g];if(null!=T)for(n=0,i=T.length;n<i;n+=1)if(u=T[n],!d.hasOwnProperty(u)){d[u]=!0,h=m[u],null==o.node(h.parentid)&&o.add(null,h.parentid,{}),null==o.node(h.childid)?o.add([h.parentid],h.childid,{}):o.adopt([h.parentid],h.childid),h=l[u],u=0;for(var w=h.length;u<w;u+=1)d[h[u].key]=!0}}}),o},getFamilyWithoutGrandParentsRelations:function(){var t,i=new e.common.family,a={},r=[],s=0;for(t in x)x.hasOwnProperty(t)&&n(this,x,t,function(e){var n=a[t];null==n&&(n={},a[t]=n),n.hasOwnProperty(e)||(n=new T(t,e,s),r.push(n),a[t][e]=n)});for(;0<r.length;){for(var l=[],m=(s=s+1,0),c=r.length;m<c;m+=1){var h=r[m];t=h.to,x.hasOwnProperty(t)&&n(this,x,t,function(e){var n=a[h.from];if(null==n&&(n={},a[h.from]=n),n.hasOwnProperty(e))n[e].distance=s;else{var i=new T(t,e,s);l.push(i),n[e]=i}})}r=l}return o(this,function(e,t){var o=[];n(this,x,e,function(t){0===a[e][t].distance&&o.push(t)}),i.add(o,e,t)}),i},getGraph:function(){var t,i=e.common.graph();for(t in S)S.hasOwnProperty(t)&&n(this,S,t,function(e){var n=i.edge(t,e);null==n&&(n=new g({}),i.addEdge(t,e,n))});return i},removeNode:function(e){null!=M[e]&&(n(this,S,e,function(t){delete x[t][e],A[t]-=1,A[t]||(delete x[t],delete A[t],null==P.null&&(P.null={},O.null=0),P.null[t]||(P.null[t]=!0,O.null+=1))}),n(this,x,e,function(t){delete S[t][e],I[t]-=1,I[t]||(delete S[t],delete I[t])}),null!=P.null&&null!=P.null[e]&&(delete P.null[e],O.null-=1,O.null||(delete P.null,delete O.null)),delete S[e],delete I[e],delete x[e],delete A[e],delete M[e])},removeRelation:function(e,t){var n=!1;return null!=M[e]&&null!=M[t]&&(n=i(e,t)||i(t,e)),n},node:function(e){return M[e]},loop:o,loopLevels:function(e,t,i){function o(){this.items={},this.minimumLevel=null}function a(e,t,n){var i=I[t];i||(i=new o,I[t]=i),i.addItemToLevel(e,n),A=null==A?n:Math.min(A,n),O[e]=n,b[e]=!0}var r,s,l,h,u,d,g,p,f,T,y,k,v,w=[],C={},b={},P=[],O={},I={},A=null;if(l=t?m:c,o.prototype.addItemToLevel=function(e,t){var n=this.items[t];n?n.push(e):(n=[e],this.items[t]=n),this.minimumLevel=null==this.minimumLevel?t:Math.min(this.minimumLevel,t)},null!=i){for(l(this,function(e,t,n){w.push(e),C[e]=n}),l=0,d=w.length;l<d;l+=1)if(r=w[l],null==b[r])for(P.push(r),a(r,l,0);0<P.length;){for(T=f=p=null,y=!t,k=[],r=0,h=P.length;r<h;r+=1)u=P[r],g=O[u],v=!1,t?(n(this,x,u,function(e){var t;!b[e]&&(v=!0,t=C[e],null==p||!y||p<t||p==t&&T>g-1)&&(p=t,f=e,T=g-1,y=!0)}),n(this,S,u,function(e){var t;!b[e]&&(v=!0,t=C[e],null==p||!y&&(p>t||p==t&&T<g+1))&&(p=t,f=e,T=g+1,y=!1)})):(n(this,S,u,function(e){var t;!b[e]&&(v=!0,t=C[e],null==p||y||p<t||p==t&&T<g+1)&&(p=t,f=e,T=g+1,y=!1)}),n(this,x,u,function(e){var t;!b[e]&&(v=!0,t=C[e],null==p||y&&(p>t||p==t&&T>g-1))&&(p=t,f=e,T=g-1,y=!0)})),v&&k.push(u);null!=f&&(k.push(f),a(f,l,T)),P=k}for(P=!0,t=A;P;){for(s in r={},P=!1,I)if(I.hasOwnProperty(s)&&null!=(h=(l=I[s]).items[l.minimumLevel-A+t]))for(r[s]=l,P=!0,l=0,d=h.length;l<d;l+=1)if(u=h[l],i.call(e,u,M[u],t-A))return P=!1,!0;I=r,t+=1}}},loopTopo:m,loopTopoReversed:c,loopChildren:r,loopParents:s,findLargestRoot:function(){var e,t,n=null,i={},o={};return e=null,c(this,function(a,r){i.hasOwnProperty(a)||(i[a]={},o[a]=0),i[a][a]=!0,o[a]+=1,t=!0,s(this,r.id,function(e){var n,r;if(t=!1,i.hasOwnProperty(e)||(i[e]={},o[e]=0),o[e]||1!=A[a])for(r in n=i[a])n.hasOwnProperty(r)&&(i[e][r]=!0,o[e]+=1);else i[e]=i[a],o[e]=o[a];return 2}),t&&(!e||o[a]>e)&&(e=o[a],n=a)}),n},loopRoots:function(e,t){var n,i,o,a,r,l,m,h,u,d=null,g=0,p={},f={},T={},y={};for(r in c(this,function(e,t){p.hasOwnProperty(e)||(p[e]={},f[e]=0),p[e][e]=!0,f[e]+=1,i=!0,s(this,t.id,function(t){var n,o;if(i=!1,p.hasOwnProperty(t)||(p[t]={},f[t]=0),f[t]||1!=A[e])for(o in n=p[e])n.hasOwnProperty(o)&&!p[t][o]&&(p[t][o]=!0,f[t]+=1);else p[t]=p[e],f[t]=f[e];return 2}),i&&(T[e]=!0,g+=1)}),l={},T)if(T.hasOwnProperty(r))for(a in n=p[r])n.hasOwnProperty(a)&&(l[a]||(l[a]=[]),l[a].push(r.toString()));for(;0<g;){for(o in n=null,T)T.hasOwnProperty(o)&&(!n||f[o]<n)&&(n=f[o],d=o);if(null!=d){for(a in null!=t&&t.call(e,d,M[d]),n=p[d])if(n.hasOwnProperty(a)&&!y[a]){for(h=0,u=(r=l[a]).length;h<u;h+=1)m=r[h],f[m]-=1;y[a]=!0}delete T[d],g-=1}}},hasNodes:function(){return!e.common.isEmptyObject(M)},hasCommonChild:function(e){var t,i,o,a,r,s,l,m=!1;for(t={},a=o=0,r=e.length;a<r;a+=1)s=e[a],null!=M[s]&&!t[s]&&(t[s]=!0,o+=1);for(s in i={},t)t.hasOwnProperty(s)&&n(this,S,s,function(e){i[e]=i[e]?i[e]+1:1});for(l in i)if(i.hasOwnProperty(l)&&null!=x[l]&&(A[l]||0)==i[l]&&i[l]==o){m=!0;break}return m},loopNeighbours:function(e,t,n){var i={};null!=n&&(r(this,t,function(t,o){return i.hasOwnProperty(t)||(i[t]=null,n.call(e,t,o,1)&&(i[t]=2),s(this,t,function(t,o){return i.hasOwnProperty(t)||(i[t]=null,n.call(e,t,o,2)&&(i[t]=2)),i[t]})),i[t]}),s(this,t,function(t,o){return i.hasOwnProperty(t)||(i[t]=null,n.call(e,t,o,1)&&(i[t]=2),r(this,t,function(t,o){return i.hasOwnProperty(t)||(i[t]=!0,n.call(e,t,o,2)&&(i[t]=2)),i[t]})),i[t]}))},countChildren:y,countParents:k,firstParent:w,firstChild:v,validate:function(e){function t(e){var t,n=0;if(null!=e)for(t in e)e.hasOwnProperty(t)&&(n+=1);return n}var i,a;for(i in o(this,function(t){n(this,S,t,function(n){if(!x.hasOwnProperty(n)||!x[n].hasOwnProperty(t))return null!=e&&(e.message="Child #"+n+" does not reference parent #"+t),!1}),n(this,x,t,function(n){if(!S.hasOwnProperty(n)||!S[n].hasOwnProperty(t))return null!=e&&(e.message="Parent #"+n+" does not reference child #"+t),!1})}),x)if(x.hasOwnProperty(i)){if((A[i]||0)!=t(x[i]))return null!=e&&(e.message="Parents count for item #"+i+" missmatch."),!1;if(x.hasOwnProperty(i)&&!M.hasOwnProperty(i))return null!=e&&(e.message="Orphant parents for item #"+i),!1}for(a in S)if(S.hasOwnProperty(a)){if((I[a]||0)!=t(S[a]))return null!=e&&(e.message="Children count for item "+a+" missmatch."),!1;if(S.hasOwnProperty(a)&&!M.hasOwnProperty(a))return null!=e&&(e.message="Orphant children of item "+a),!1}for(a in P)if(P.hasOwnProperty(a)){if((O[a]||0)!=t(P[a]))return null!=e&&(e.message="Root children count for item @"+a+" missmatch."),!1;n(this,P,a,function(t){if(!M.hasOwnProperty(t))return null!=e&&(e.message="Child #"+t+"of root #"+a+" does not exists."),!1})}return!0},hasLoops:function(){var e=b();return m(this,function(t){e.removeNode(t)}),e.hasNodes()},clone:b,BREAK:1,SKIP:2}},e.common.FamilyAlignment=function(t,n,i,o){function a(t,n){var i=t[n];return null==i&&(i=new e.common.FamilyMargins,t[n]=i),i}function r(e,t,n,i,o,a,r,s){var l=a,c=a;n.loopSiblings(this,t,function(e){e=r.getItemPosition(e),l=Math.min(l,e),c=Math.max(c,e)});for(var h=a-1;h>=l;h-=1){var u=r.getItemAtPosition(i,h);if(!e.hasOwnProperty(u)){var d=r.getItemAtPosition(i,h+1);e[u]=e[d]-(m[u]/2+(s[d]||0)+m[d]/2)}}for(h=a+1;h<=c;h+=1)u=r.getItemAtPosition(i,h),e.hasOwnProperty(u)||(d=r.getItemAtPosition(i,h-1),e[u]=e[d]+(m[d]/2+(s[u]||0)+m[u]/2));for(d=e[u=r.getItemAtPosition(i,l)]-m[u]/2,d+=e[u=r.getItemAtPosition(i,c)]+m[u]/2,d/=2,c=l=null,n.loopNonSiblings(this,t,function(e){e=r.getItemPosition(e),l=null!=l?Math.min(l,e):e,c=null!=c?Math.max(c,e):e}),n=0,h=l;h<=c;h+=1)t=r.getItemAtPosition(o,h),n+=m[t],h>l&&(n+=s[t]||0);for(h=d-n/2,t=r.getItemAtPosition(o,l),e.hasOwnProperty(t)||(e[t]=h+m[t]/2),h=l+1;h<=c;h+=1)t=r.getItemAtPosition(o,h),e.hasOwnProperty(t)||(d=r.getItemAtPosition(o,h-1),e[t]=e[d]+(m[d]/2+(s[t]||0)+m[t]/2))}var s,l,m={};return null!=o&&i.loopItems(this,function(e,n){m[e]=o.call(t,e,n)}),l=function(t,n){var i={},o={},r=null;return n.loopLevelsReversed(this,function(s){var l=new e.common.FamilyMargins;null!=r&&(r.add(0,Number.MAX_VALUE),l.merge(r,0));var c=r=l;n.loopLevelItems(this,s,function(e,r,s){var l=a(o,e);switch(l.add(m[e],s),t.countParents(e)){case 0:null!=c&&(i[e]=c.attach(l));break;case 1:t.loopParents(this,e,function(n){return n=a(o,n),i[e]=n.merge(l),c=n,t.BREAK});break;default:var h=0,u=null,d=null,g={};for(t.loopParents(this,e,function(e,i,o){if(0<o)return t.BREAK;h+=m[e],i=n.getItemPosition(e),u=null==u?i:Math.min(u,i),d=null==d?i:Math.max(d,i),g[i]=e}),r=-h/2,s=u;s<=d;s+=1){var p=g[s],f=(r=r+m[p]/2,a(o,p));f.attach(l,-r),c=f,r+=m[p]/2}}})}),i}(n,i),s=function(t,n,i){var o={},a=e.common.getFamilyUnits(t),s={};return n.loopLevels(this,function(e){n.loopLevelItems(this,e,function(t,l,c){if(!o.hasOwnProperty(t)){if(l=0,0===c)null!=i[t]&&(l+=i[t]+m[t]/2);else{var h=n.getItemAtPosition(e,c-1);l=l+(o[h]+m[h]/2+(i[t]||0)+m[t]/2)}o[t]=l}if(null!=(l=a[t]))for(h=0;h<l.length;h+=1){var u=l[h];s.hasOwnProperty(u.id)||(s[u.id]=!0,r(o,t,u,e,e+1,c,n,i))}})}),o}(n,i,l),{getOffset:function(e){return s[e]}}},e.common.FamilyMargins=function(){function e(e,t,n,i){this.left=e,this.right=t,this.leftIndex=n,this.rightIndex=i}this.items=[],this.add=function(t,n,i,o){switch(arguments.length){case 2:this.items.push(new e(-t/2,t/2,n,n));break;case 4:this.items.push(new e(t,n,i,o))}},this.merge=function(t,n){for(var i=this.getDistanceTo(t),o=0,a=0,r=this.items.length,s=t.items.length,l=Math.min(r,s),m=Math.max(r,s),c=0;c<l;c+=1){var h=this.items[r-1-c],u=t.items[s-1-c];0===c&&(o=(a=h.right-h.left+(i||0)+(n||0)+u.right-u.left)/2+h.left,a=a/2-u.right),h.left-=o,h.right=u.right+a,h.rightIndex=u.rightIndex,this.items[m-1-c]=h}for(c=l;c<m;c+=1)h=this.items[r-1-c],u=t.items[s-1-c],null==h?this.items[m-1-c]=new e(u.left+a,u.right+a,u.leftIndex,u.rightIndex):(h.left-=o,h.right-=o);return i},this.attach=function(t,n){for(var i=this.getDistanceTo(t),o=n||0,a=this.items.length,r=t.items.length,s=Math.min(a,r),l=Math.max(a,r),m=0;m<s;m+=1){var c=this.items[a-1-m],h=t.items[r-1-m];0===m&&(o=c.right+(i||0)+(n||0)-h.left),c.right=h.right+o,c.rightIndex=h.rightIndex,this.items[l-1-m]=c}for(m=s;m<l;m+=1)null==(c=this.items[a-1-m])&&(h=t.items[r-1-m],this.items[l-1-m]=new e(h.left+o,h.right+o,h.leftIndex,h.rightIndex));return i},this.getDistanceTo=function(e){var t=null,n=0,i=this.items.length,o=e.items.length,a=Math.min(i,o);if(0<a){for(var r=0;r<a;r+=1){var s=this.items[i-1-r],l=e.items[o-1-r];0===r?t=n=s.right-l.left:s.rightIndex<l.leftIndex&&(t=Math.max(t,s.right-l.left))}t-=n}return t},this.loop=function(e,t){if(null!=t)for(var n=0,i=this.items.length;n<i;n+=1){var o=this.items[i-1-n];if(t.call(e,n,o.left,o.right,o.leftIndex,o.rightIndex))break}},this.getLeft=function(e){var t=this.items.length-1;if(t>=e)return this.items[t-e].left}},e.common.FibonacciHeap=function(e){function t(e){this.key=e.key,this.priority=e.priority,this.item=e.item}function n(e,t,n){this.key=e,this.priority=t,this.item=n,this.degree=0,this.marked=!1,this.right=this.left=this.child=this.parent=null}function i(e,t){var n=u[e.right];t.right=e.right,t.left=e.key,e.right=t.key,n.left=t.key}function o(e){var t=u[e.left],n=u[e.right];t.right=n.key,n.left=t.key,e.right=e.key,e.left=e.key}function a(){var e=null;return null!=h&&(e=new t(u[h])),e}function r(){var e=a();if(null!=e){var t=u[h],n=u[t.right];if(null!=t.child){var i=u[t.child],r=u[i.left];t.right=i.key,n.left=r.key,i.left=t.key,r.right=n.key,o(t),delete u[t.key],h=null,s(i.key)}else o(t),delete u[t.key],h=null,n.key!=t.key&&s(n.key)}return e}function s(t){var n,i=[],o={};for(n=t;!o.hasOwnProperty(n);){var a=(t=u[n]).right;for(o[n]=!0,t.parent=null;null!=(n=i[t.degree]);)(e?t.priority>n.priority:t.priority<n.priority)?l(t,n):(l(n,t),t=n),i[t.degree-1]=null;i[t.degree]=t,(null==h||null==u[h]||(e?u[h].priority<=t.priority:u[h].priority>=t.priority))&&(h=t.key),n=a}}function l(t,n){t.degree+=1,o(n);var a=u[t.child];null!=a?(i(a,n),(e?a.priority<n.priority:a.priority>n.priority)&&(t.child=n.key)):t.child=n.key,n.parent=t.key}function m(t,n){var i=u[t];if(e?i.priority>n:i.priority<n)throw"Priority increase is not supported";if(i.priority=n,null!=i.parent){var o=u[i.parent];(e?o.priority<i.priority:o.priority>i.priority)&&(c(o,i),function e(t){if(null!=t.parent)if(t.marked){var n=u[t.parent];c(n,t),e(n)}else t.marked=!0}(o))}(e?u[h].priority<i.priority:u[h].priority>i.priority)&&(h=i.key)}function c(e,t){t.marked=!1,t.parent=null,t.right==t.key?e.child=null:(e.child=t.right,o(t)),e.degree-=1,i(u[h],t)}var h=null,u={};return{add:function(t,o,a){if(u.hasOwnProperty(t))throw"Duplicate keys are not supported!";o=new n(t,o,a),u[t]=o,null==h?(o.left=t,h=o.right=t):(i(a=u[h],o),(e?a.priority<o.priority:a.priority>o.priority)&&(h=t))},getPriority:function(e){var t=null;return u.hasOwnProperty(e)&&(t=u[e].priority),t},setPriority:m,heapRoot:a,extractRoot:r,deleteKey:function(t){m(t,e?1/0:-1),r()},validate:function(){var e,t=0;for(e in u)if(u.hasOwnProperty(e)){var n=u[e];t=t+1;if(null!=n.child){if(!u.hasOwnProperty(n.child))throw"Child does not exists";var i=u[n.child];if(i.parent!=n.key)throw"Child references wrong parent"}if(null!=n.parent&&!u.hasOwnProperty(n.parent))throw"Parent does not exists";if(null!=n.left){if(!u.hasOwnProperty(n.left))throw"Left does not exists";if((i=u[n.left]).right!=n.key)throw"Left references wrong right"}if(null!=n.right){if(!u.hasOwnProperty(n.right))throw"Right does not exists";if((i=u[n.right]).left!=n.key)throw"Right references wrong left"}}if(null==h&&0<t)throw"Orphans";if(null!=h){if(!u.hasOwnProperty(h))throw"Root node does not exists";if(null!=(n=u[h]).parent)throw"Root node has parent reference";for(e=[h],n={},i=0;0<e.length;){for(var o=[],a=0,r=e.length;a<r;a+=1)for(var s=u[e[a]];!n.hasOwnProperty(s.key);)n[s.key]=!0,i+=1,null!=s.child&&o.push(s.child),s=u[s.right];e=o}if(t!=i)throw"Tree has loops or orpants"}}}},e.common.getCrossingRectangles=function(t,n,i){function o(e,t,n,i){this.isStart=e,this.index=t,this.x=n,this.rect=i}function a(){this.count=0,this.rectangles={},this.add=function(e){this.count+=1,this.rectangles[e]=!0},this.remove=function(e){return this.count-=1,delete this.rectangles[e],0==this.count}}function r(e,o,a,r,s){e.loopForward(this,o,function(e,o){if(e>a)return!0;for(var l in o.rectangles)if(o.rectangles.hasOwnProperty(l)){var m=r>l?r+"-"+l:l+"-"+r;h.hasOwnProperty(m)||(h[m]=!0,i.call(t,s,n[l]))}})}if(null!=i){for(var s=[],l=0;l<n.length;l+=1){var m=n[l];s.push(new o(1,l,m.x,m)),s.push(new o(0,l,m.right(),m))}s.sort(function(e,t){return e.x==t.x?t.isStart-e.isStart:e.x-t.x});m=e.common.SortedList();var c={},h={};for(l=0;l<s.length;l+=1){var u=s[l],d=[u.rect.y,u.rect.bottom()];if(1==u.isStart){r(m,d[0],d[1],u.index,u.rect);for(var g=0,p=d.length;g<p;g+=1){var f=d[g],T=c[f];null==T&&(T=new a,c[f]=T,m.add(f,T)),T.add(u.index)}}else{for(g=0,p=d.length;g<p;g+=1)(T=c[f=d[g]]).remove(u.index)&&(delete c[f],m.remove(f));r(m,d[0],d[1],u.index,u.rect)}}}},e.common.getFamilyUnits=function(e){function t(){this.toIndex=this.fromIndex=0,this.items=[],this.hash={}}function n(e){this.id=e,this.parents=new t,this.children=new t,this.loopSiblings=function(e,t,n){this._loop(e,this.parents.hash.hasOwnProperty(t)?this.parents.items:this.children.items,n)},this.loopNonSiblings=function(e,t,n){this._loop(e,this.parents.hash.hasOwnProperty(t)?this.children.items:this.parents.items,n)},this.loop=function(e,t){this._loop(e,this.parents.items,t),this._loop(e,this.children.items,t)},this._loop=function(e,t,n){if(null!=n)for(var i=0,o=t.length;i<o;i+=1)n.call(e,t[i])},this.addParent=function(e){this._add(e,this.parents)},this.addChild=function(e){this._add(e,this.children)},this._add=function(e,t){t.hash.hasOwnProperty(e)||(t.items.push(e),t.hash[e]=!0)}}var i,o,a=[],r={};i=0,e.loop(this,function(t){var o=e.countChildren(t);if(0<o&&!r.hasOwnProperty(t)){var s=new n(i);i+=1,s.addParent(t),e.loopChildren(this,t,function(t){return s.addChild(t),1==o&&e.loopParents(this,t,function(t){return s.addParent(t),r[t]=s,e.SKIP}),e.SKIP}),a.push(s),r[t]=s}});var s={};for(i=0,o=a.length;i<o;i+=1){var l=a[i];l.loop(this,function(e){s.hasOwnProperty(e)?s[e].push(l):s[e]=[l]})}return s},e.common.getLiniarBreaks=function(t){function n(n,i){var a=0,r=(o[i]-o[n]+t[n])/(i-n+1),s=e.common.binarySearch(t,function(e){return r-e},n,i);return s.item<=r?(a+=r*(s.index+1-n)-(o[s.index]-o[n]+t[n]),a+=o[i]-o[s.index]-r*(i-s.index)):(a+=r*(s.index-n)-(o[s.index]-o[n]-t[s.index]+t[n]),a+=o[i]-o[s.index]+t[s.index]-r*(i-s.index+1)),a}function i(e,t){var i;return i=0+n(0,e),t>e+1&&(i+=n(e+1,t-1)),i+n(t,a-1)}for(var o=[],a=t.length,r=0,s=0;s<a;s+=1)r+=t[s],o[s]=r;for(var l=i(r=0,s=a-1);r<s+1;){var m=i(r+1,s),c=i(r,s-1);if(m<c){if(m>=l)break;r+=1,l=m}else{if(c>=l)break;s-=1,l=c}}return[r,s-1,a-1]},e.common.getMergedRectangles=function(t,n,i){function o(e,t){this.start=e,this.startHead=null,this.end=t,this.endHead=null,this.overlap=function(e){return!(this.end<e.start||this.start>e.end)}}function a(e,t){this.x=e,this.ranges=t}function r(e,t){this.isHead=e,this.list=t,b.hasOwnProperty(t)||(b[t]=[]),b[t].push(this),this.add=function(e){e.from.equalTo(e.to)||(this.isHead?C[this.list].add(P,e):C[this.list].unshift(P,e),P+=1)},this.getTail=function(){return new r(!this.isHead,this.list)},this.attach=function(e){if(this.list!=e.list){C[this.list].attach(C[e.list]);var t=b[e.list];if(delete b[e.list],null!=t)for(var n=0,i=t.length;n<i;n+=1){var o=t[n];o!=e&&(o.list=this.list,b[this.list].push(o))}}}}function s(t){return C.push(new e.common.LinkedHashItems),new r(t,C.length-1)}var l,m,c,h,u;n.sort(function(e,t){return e.x==t.x?e.y-t.y:e.x-t.x});var d=[],g={};for(l=0,m=n.length;l<m;l+=1){h=[(c=n[l]).x,c.right()];for(var p=0;p<h.length;p+=1){null==(u=g[T=h[p]])&&(u={x:T,add:[],remove:[]},g[T]=u,d.push(u)),T==c.x?u.add.push(l):u.remove.push(l)}}for(d.sort(function(e,t){return e.x-t.x}),p={},(g=[]).push(new a(null,[])),l=0,m=d.length;l<m;l+=1){for(c=0,h=(u=d[l]).add.length;c<h;c+=1)p[u.add[c]]=!0;for(c=0,h=u.remove.length;c<h;c+=1)delete p[u.remove[c]];var f,T=[];for(f in p)p.hasOwnProperty(f)&&T.push(n[f]);T.sort(function(e,t){return e.y-t.y});var y=[],k=null,v=null;for(c=0,h=T.length;c<h;c+=1){var w=T[c];null==k?(k=w.y,v=w.bottom()):v<w.y?(y.push(new o(k,v)),k=w.y,v=w.bottom()):v=Math.max(v,w.bottom())}null!=k&&y.push(new o(k,v)),g.push(new a(u.x,y))}var C=[],b={},P=1;for(l=1,m=g.length;l<m;l+=1)for(n=g[l-1],u=g[l],c=f=0;f<n.ranges.length||c<u.ranges.length;)if(h=f<n.ranges.length?n.ranges[f]:null,null==(p=c<u.ranges.length?u.ranges[c]:null)){for(d=[new e.common.Point(n.x,h.end),new e.common.Point(u.x,h.end),new e.common.Point(u.x,h.start),new e.common.Point(n.x,h.start)],y=1;y<d.length;y+=1)h.endHead.add(new e.common.Vector(d[y-1],d[y]));h.endHead.attach(h.startHead),f+=1}else if(null==h)p.endHead=s(!0),p.endHead.add(new e.common.Vector(new e.common.Point(u.x,p.start),new e.common.Point(u.x,p.end))),p.startHead=p.endHead.getTail(),c+=1;else if(p.overlap(h)){for(d=[new e.common.Point(n.x,h.start),new e.common.Point(u.x,h.start),new e.common.Point(u.x,p.start)],y=1;y<d.length;y+=1)h.startHead.add(new e.common.Vector(d[y],d[y-1]));for(p.startHead=h.startHead,y=!0;y;)if(y=!1,h.end>p.end)null!=(T=c+1<u.ranges.length?u.ranges[c+1]:null)&&T.overlap(h)&&(y=new e.common.Point(u.x,T.start),k=new e.common.Point(u.x,p.end),p.endHead=s(!0),p.endHead.add(new e.common.Vector(y,k)),T.startHead=p.endHead.getTail(),c+=1,p=T,y=!0);else if(null!=(T=f+1<n.ranges.length?n.ranges[f+1]:null)&&T.overlap(p)){for(d=[new e.common.Point(n.x,h.end),new e.common.Point(u.x,h.end),new e.common.Point(u.x,T.start),new e.common.Point(n.x,T.start)],y=1;y<d.length;y+=1)h.endHead.add(new e.common.Vector(d[y-1],d[y]));h.endHead.attach(T.startHead),f+=1,h=T,y=!0}for(d=[new e.common.Point(n.x,h.end),new e.common.Point(u.x,h.end),new e.common.Point(u.x,p.end)],y=1;y<d.length;y+=1)h.endHead.add(new e.common.Vector(d[y-1],d[y]));p.endHead=h.endHead,f+=1,c+=1}else if(h.start<p.start){for(d=[new e.common.Point(n.x,h.end),new e.common.Point(u.x,h.end),new e.common.Point(u.x,h.start),new e.common.Point(n.x,h.start)],y=1;y<d.length;y+=1)h.endHead.add(new e.common.Vector(d[y-1],d[y]));h.endHead.attach(h.startHead),f+=1}else p.endHead=s(!0),p.endHead.add(new e.common.Vector(new e.common.Point(u.x,p.start),new e.common.Point(u.x,p.end))),p.startHead=p.endHead.getTail(),c+=1;if(null!=i)for(l=0;l<C.length;l+=1)b.hasOwnProperty(l)&&(m=C[l],d=[],m.iterate(function(e){0==d.length&&d.push(e.from),d.push(e.to)}),i.call(t,d))},e.common.getMinimumCrossingRows=function(e,t,n){var i=null,o=null;if(null!=n){t.sort(function(e,t){return e.y-t.y});for(var a=0;a<t.length;a+=1){var r=t[a],s=r.bottom();null===i?(i=r.y,o=s):r.y>=o?(n.call(e,i),i=r.y,o=s):(r.y>i&&(i=r.y),s<o&&(o=s))}null!==i&&n.call(e,i)}},e.common.graph=function(){function t(e,t,n,i){var a,r,s,l,m=[];if(m.push(t),n[t]=!0,null!=i)for(;0<m.length;){for(t=[],r=0,s=m.length;r<s;r+=1)for(l in a=m[r],i.call(e,a),a=o[a])a.hasOwnProperty(l)&&!n.hasOwnProperty(l)&&(n[l]=!0,t.push(l));m=t}}function n(e,t){var n,i,a,r=null,s=0,l=null;for(n in o)if(o.hasOwnProperty(n)){for(a in s=0,i=o[n])i.hasOwnProperty(a)&&(s+=t.call(e,i[a],n,a));(s>l||null==l)&&(r=n,l=s)}return r}function i(e,t,i,s,l){var m,c,h,u,d,g,p,f={},T=[],y={},k=0;if(null!=i&&null!=s&&(null==t&&(t=n(e,i)),null!=t))for(s.call(e,t),f[t]=!0,k+=1,y[t]=null;0<k;){for(m in T=[],h=c=null,u={},f)if(f.hasOwnProperty(m)){for(g in t=!1,d=o[m])if(d.hasOwnProperty(g)&&!y.hasOwnProperty(g))switch(p=i.call(e,d[g],m,g),t=!0,l){case a:null==u[g]&&(u[g]=0),u[g]+=p,(!h||u[g]>h)&&(c=g,h=u[g]);break;case r:u[g]=null==u[g]?p:Math.min(u[g],p),(!h||u[g]<h)&&(c=g,h=u[g])}t||T.push(m)}if(null==c)break;for(f[c]=!0,k+=1,y[c]=!0,s.call(e,c),t=0,c=T.length;t<c;t+=1)delete f[T[t]],k-=1}}var o={},a=1,r=2;return{addEdge:function(e,t,n){null!=o[e]&&null!=o[e][t]||null==n||(null==o[e]&&(o[e]={}),o[e][t]=n,null==o[t]&&(o[t]={}),o[t][e]=n)},edge:function(e,t){var n=null;return null!=o[e]&&o[e][t]&&(n=o[e][t]),n},hasNode:function(e){return o.hasOwnProperty(e)},loopNodes:function(e,n,i){if(e={},null==n)for(n in o)o.hasOwnProperty(n)&&(e.hasOwnProperty[n]||t(this,n,e,i));else t(this,n,e,i)},loopNodeEdges:function(e,t,n){var i;if(null!=n&&null!=(t=o[t]))for(i in t)t.hasOwnProperty(i)&&n.call(e,i,t[i])},getSpanningTree:function(t,n){var i,a,r,s,l,m=e.common.tree(),c=e.common.FibonacciHeap(!0),h={};for(c.add(t,0,null),h[t]=null;null!=(i=c.extractRoot());){for(r in a=o[i.key])a.hasOwnProperty(r)&&!m.node(r)&&(s=null!=n?n(a[r]):a[r],null==(l=c.getPriority(r))?(c.add(r,s,null),h[r]=i.key.toString()):l<=s&&(c.setPriority(r,s),h[r]=i.key.toString()));m.add(h[i.key],i.key.toString(),{})}return m},getTotalWeightGrowthSequence:function(e,t,o){i(e,n(e,t),t,o,a)},getMinimumWeightGrowthSequence:function(e,t,n,o){i(e,t,n,o,r)},getShortestPath:function(t,n,i,a,r){var s,l,m=e.common.FibonacciHeap(!1),c={},h={},u={},d=0,g=0;c=0;for(l=i.length;c<l;c+=1)s=i[c],u.hasOwnProperty(s)||(d+=1,u[s]=!0);for(m.add(n,0,null),h[n]=null;null!=(n=m.extractRoot());){for(s in i=o[n.key])i.hasOwnProperty(s)&&(l=n.priority+(null!=a?a.call(t,i[s],n,s):1),null!=(c=m.getPriority(s))?c>l&&(m.setPriority(s,l),h[s]=n.key):h.hasOwnProperty(s)||(m.add(s,l,null),h[s]=n.key));if(u.hasOwnProperty(n.key)){for(c=[],i=n.key;null!=i;)c.push(i),i=h[i];if(r.call(t,c,n.key),(g+=1)>=d)break}}}}},e.common.LCA=function(t){var n,i=[],o=[],a={};return function(){var r=0;t.loopEulerWalk(this,function(e,t,n){i.push(e),o.push(n),a.hasOwnProperty(e)||(a[e]=r),r+=1}),n=e.common.RMQ(o)}(),{getLowestCommonAncestor:function(e,t){var o=a[e],r=a[t];o=o<r?n.getRangeMinimumIndex(o,r):n.getRangeMinimumIndex(r,o);return i[o]}}},e.common.LinkedHashItems=function(){function e(e,t){if(a.hasOwnProperty(e))throw"Duplicate segments are not supported!";a[e]=t,r[e]=null,null==m?(l=e,s[e]=null):(r[m]=e,s[e]=m),m=e}function t(e,t){if(a.hasOwnProperty(e))throw"Duplicate segments are not supported!";a[e]=t,s[e]=null,null==l?(m=e,r[e]=null):(s[l]=e,r[e]=l),l=e}function n(n,i,o){if(a.hasOwnProperty(i))throw"Duplicate segments are not supported!";if(null==n)t(i,o);else{var l=r[n];null==l?e(i,o):(a[i]=o,r[n]=i,r[i]=l,s[l]=i,s[i]=n)}}function i(e,t,n,i){var o;if(null==n&&(n=e?l:m),null!=t)for(;null!=n&&(null==(o=a[n])||!t(o,n));)n=n==i?null:e?r[n]:s[n]}function o(e,t,n){i(!0,e,t,n)}var a={},r={},s={},l=null,m=null;return{add:e,item:function(e){return a[e]},nextKey:function(e){return r[e]},prevKey:function(e){return s[e]},startKey:function(){return l},endKey:function(){return m},unshift:t,insertAfter:n,insertBefore:function(e,i,o){if(a.hasOwnProperty(i))throw"Duplicate segments are not supported!";if(null==e||!a.hasOwnProperty(e))throw"Before key should be defined!";null==(e=s[e])?t(i,o):n(e,i,o)},remove:function(e){var t=s[e],n=r[e];null!=t?r[t]=n:l=n,null!=n?s[n]=t:m=t,delete a[e],delete r[e],delete s[e]},isEmpty:function(){return null==l},attach:function(t){t.iterate(function(t,n){e(n,t)})},iterate:o,iterateBack:function(e,t,n){i(!1,e,t,n)},empty:function(){a={},r={},s={},m=l=null},toArray:function(){var e=[];return o(function(t){e.push(t)}),e},validate:function(e){var t,n;for(t in a)if(a.hasOwnProperty(t)&&(!r.hasOwnProperty(t)||!s.hasOwnProperty(t)))return null!=e&&(e.message="Orphant key found!"),!1;if(!a.hasOwnProperty(l)||!a.hasOwnProperty(m))return null!=e&&(e.message="Start or end values are missing!"),!1;for(t in r)if(r.hasOwnProperty(t)){if(!a.hasOwnProperty(t)||!s.hasOwnProperty(t))return null!=e&&(e.message="Orphant key found!"),!1;if((n=r[t])&&!r.hasOwnProperty(n))return null!=e&&(e.message="Next key not found!"),!1}for(t in s)if(s.hasOwnProperty(t)){if(!a.hasOwnProperty(t)||!r.hasOwnProperty(t))return null!=e&&(e.message="Orphant key found!"),!1;if((n=s[t])&&!s.hasOwnProperty(n))return null!=e&&(e.message="Prev key not found!"),!1}return!0}}},e.common.mergeSort=function(e,t,n){var i,o,a,r,s,l,m,c,h,u,d,g,p=null;switch(e.length){case 0:p=[];break;default:for(p=[],a=0;a<e.length;a+=1){for(i=e[a],o=[],l=p.length,m=i.length,s=r=0,d=h=u=c=null,0<l&&(c=p[r],u=t?t(c):c),0<m&&(h=i[s],d=t?t(h):h),g=null;r<l||s<m;)r>=l?(n&&g==h||(o.push(h),g=h),(s+=1)<m&&(h=i[s],d=t?t(h):h)):s>=m?(n&&g==c||(o.push(c),g=c),(r+=1)<l&&(c=p[r],u=t?t(c):c)):u<d?(n&&g==c||(o.push(c),g=c),(r+=1)<l&&(c=p[r],u=t?t(c):c)):(n&&g==h||(o.push(h),g=h),(s+=1)<m&&(h=i[s],d=t?t(h):h));p=o}}return p},e.common.pile=function(){function e(e,t,n,i){this.context=n,this.from=e,this.to=t,this.offset=null,this.direction=i}function t(e,n,i,o,a){if(e>=n.length)return 0;if(i.hasOwnProperty(e))return i[e];for(var r=n[e],s=t(e+1,n,i,o,a),l=e+1;l<n.length&&!(n[l].from>=r.to);)l+=1;return(n=1+t(l,n,i,o,a))>s?(i[e]=n,o[e]=l,a[e]=!0):(i[e]=s,o[e]=e+1,a[e]=!1),i[e]}var n=[];return{add:function(t,i,o){t<i?n.push(new e(t,i,o,1)):n.push(new e(i,t,o,-1))},resolve:function(e,i){var o,a,r,s,l,m,c=0;if(null!=i){for((s=n.slice(0)).sort(function(e,t){return e.from-t.from}),l=[];0<s.length;){for(t(0,s,o={},a={},r={}),o=[],l[c]=[],m=0;a.hasOwnProperty(m);)r[m]&&(o.push(m),l[c].push(s[m])),m=a[m];for(m=o.length-1;0<=m;m-=1)s.splice(o[m],1);c+=1}for(r=0;r<c;r+=1)for(o=l[r],m=0;m<o.length;m+=1)if(a=o[m],i.call(e,a.from,a.to,a.context,r,c,a.direction))return c}return c}}},e.common.QuadTree=function(t){function n(e,t,n,i){this.x=e,this.y=t,this.scale=n,this.size=i,this.quadrants=[],this.points=[]}function i(e){var t=e.size/2;e.quadrants=[new n(e.x,e.y,e.scale-1,t),new n(e.x+t,e.y,e.scale-1,t),new n(e.x,e.y+t,e.scale-1,t),new n(e.x+t,e.y+t,e.scale-1,t)];t=0;for(var i=e.points.length;t<i;t+=1){var o=e.points[t];e.quadrants[e.getQuadrantIndex(Math.floor(o.x),Math.floor(o.y))].points.push(o)}e.points=null}var o=Math.max(1,Math.floor(Math.log(t)/Math.log(2))),a=8,r=256,s=null;s=new n(0,0,a,r);return n.prototype.notEnclosed=function(e){return this.x<e.x||this.x+this.size>e.x+e.width||this.y<e.y||this.y+this.size>e.y+e.height},n.prototype.overlaps=function(e){return!(this.x+this.size<e.x||e.x+e.width<this.x||this.y+this.size<e.y||e.y+e.height<this.y)},n.prototype.getQuadrantIndex=function(e,t){var n=this.scale-1;return e>>n&1|(t>>n&1)<<1},{addPoint:function(e){for(var t=Math.max(Math.floor(e.x),Math.floor(e.y));r<=t;){i(l=new n(0,0,a+=1,r*=2)),l.quadrants[0]=s,s=l}t=Math.floor(e.x);var l=Math.floor(e.y),m=s;if(0>t||0>l)throw"Negative values are not supported in the quad tree.";for(;(null==m.points||0<m.points.length)&&(m.scale!=o||null==m.points);)null!=m.points&&0<m.points.length&&i(m),m=m.quadrants[m.getQuadrantIndex(t,l)];m.points.push(e)},loopArea:function(e,t,n){var i,o,a;if(null!=n)for(var r=[s],l=[];0<r.length||0<l.length;){var m=[],c=[];for(o=0,a=r.length;o<a;o+=1)if((i=r[o]).overlaps(t))if(i.notEnclosed(t))if(null==i.points)for(var h=0;4>h;h+=1)m.push(i.quadrants[h]);else{h=0;for(var u=i.points.length;h<u;h+=1){var d=i.points[h];if(t.contains(d)&&n.call(e,d))return}}else l.push(i);for(o=0,a=l.length;o<a;o+=1)if(null==(i=l[o]).points)for(h=0;4>h;h+=1)c.push(i.quadrants[h]);else for(h=0,u=i.points.length;h<u;h+=1)if(n.call(e,i.points[h]))return;r=m,l=c}},validate:function(){for(var t=[s];0<t.length;){for(var n=[],i=0,o=t.length;i<o;i+=1){var a=t[i],r=new e.common.Rect(a.x,a.y,a.size,a.size);if(null!=a.points&&0<a.quadrants.length)return!1;if(null==a.points)for(r=0;4>r;r+=1)n.push(a.quadrants[r]);else for(var l=0,m=a.points.length;l<m;l+=1)if(!r.contains(a.points[l]))return!1}t=n}return!0},getPositions:function(t){for(var n=[],i=[s];0<i.length;){for(var o=[],a=0,r=i.length;a<r;a+=1){var l=i[a],m=new e.common.Rect(l.x,l.y,l.size,l.size);for(m.context={isHighlighted:!1},null!=t&&t.overlaps(m)&&null!=l.points&&0<l.points.length&&(m.context.isHighlighted=!0),n.push(m),m=0;4>m;m+=1){var c=l.quadrants[m];null!=c&&o.push(c)}}i=o}return n}}},e.common.RMQ=function(e){function t(t,n){var a=Math.floor(Math.log(n-t+1)/o);return e[i[t][a]]<=e[i[n-(1<<a)+1][a]]?i[t][a]:i[n-(1<<a)+1][a]}for(var n,i=[],o=Math.log(2),a=0,r=e.length;a<r;a+=1)i[a]=[a];for(n=1,r=e.length;1<<n<r;n+=1)for(a=0;a+(1<<n)-1<r;a+=1)i[a][n]=e[i[a][n-1]]<e[i[a+(1<<n-1)][n-1]]?i[a][n-1]:i[a+(1<<n-1)][n-1];return{getRangeMinimumIndex:t,getRangeMinimum:function(n,i){return e[t(n,i)]}}},e.common.SortedList=function(){function e(e,t){this.value=e,this.context=t,this.right=this.left=null,this.balance=0}function t(e){var t;if(2==e.balance){var o=e.right;if(0<=(t=o.balance))n(o,e),1==o.balance?(e.balance=0,o.balance=0):(e.balance=-1,o.balance=1);else{var a=o.left;switch(i(a,o),n(o,e),e.balance=0,a.balance){case 1:o.balance=-1,a.balance=0;break;case 0:a.balance=0,o.balance=0;break;default:a.balance=1,o.balance=0}}}else if(-2==e.balance)if(0>=(t=e.left.balance))i(o=e.left,e),-1==o.balance?(e.balance=0,o.balance=0):(e.balance=1,o.balance=-1);else switch(o=e.left,a=o.right,n(a,o),i(o,e),e.balance=0,a.balance){case-1:a.balance=0,o.balance=1;break;case 0:a.balance=0,o.balance=0;break;default:a.balance=-1,o.balance=0}return t}function n(e,t){a(e,t),t.right=e.right,e.right=e.left,e.left=t.left,t.left=e}function i(e,t){a(e,t),t.left=e.left,e.left=e.right,e.right=t.right,t.right=e}function o(e,t){var n=null!=e.right?e.right:e.left;null!=t?t.value>e.value?t.left=n:t.right=n:m=n}function a(e,t){var n=e.value;e.value=t.value,t.value=n,n=e.context,e.context=t.context,t.context=n}function r(e,t,n){if(null!=n){var i=[],o=null;for(o=m;null!=o;)o.value>=t||null==t?(i.push(o),o=o.left):o=o.right;for(;null!=(o=i.pop())&&!n.call(e,o.value,o.context);)for(o=o.right;null!=o;)if(null!=o.left)i.push(o),o=o.left;else{if(n.call(e,o.value,o.context))return;o=o.right}}}function s(e,t,n){if(null!=n){var i=[],o=null;for(o=m;null!=o;)o.value<=t||null==t?(i.push(o),o=o.right):o=o.left;for(;null!=(o=i.pop())&&!n.call(e,o.value,o.context);)for(o=o.left;null!=o;)if(null!=o.right)i.push(o),o=o.right;else{if(n.call(e,o.value,o.context))return;o=o.left}}}function l(e){var t=[],n=0;if(null!=e)for(t.push(e);0<t.length;){for(var i=[],o=0;o<t.length;o+=1)null!=(e=t[o]).left&&i.push(e.left),null!=e.right&&i.push(e.right);t=i,n+=1}return n}var m=null;return{add:function(n,i,o,a){if(null==m)m=new e(n,i);else{for(var r=[],s=null,l=m;null!=l;)if(null!=s&&r.push(s),(s=l).value==n){if(null==a)throw"Structure does not support duplicates.";a.call(o,s.context)}else l=s.value>n?s.left:s.right;for(r.push(s),i=new e(n,i),s.value>n?s.left=i:s.right=i,s=i;null!=(l=r.pop());){if(s.value<l.value){if(0>l.balance){l.balance-=1,t(l);break}if(0<l.balance){l.balance-=1;break}l.balance-=1}else{if(0<l.balance){l.balance+=1,t(l);break}if(0>l.balance){l.balance+=1;break}l.balance+=1}s=l}}},remove:function(e){for(var n=[],i=m;null!=i;){if(i.value==e){if(null!=i.right&&null!=i.left){for(n.push(i),e=i.right;null!=e.left;)n.push(e),e=e.left;var a=e;i.value=a.value,i.context=a.context,o(e,n[n.length-1]),n.push(e)}else o(i,n[n.length-1]),n.push(i);for(e=n.length-2;0<=e;e-=1)if(a=n[e],i=n[e+1],a.value>i.value)if(0<a.balance){if(a.balance+=1,0===t(a))break}else{if(0===a.balance){a.balance+=1;break}a.balance+=1}else if(0>a.balance){if(a.balance-=1,0===t(a))break}else{if(0===a.balance){a.balance-=1;break}a.balance-=1}break}n.push(i),i=i.value>e?i.left:i.right}},loopForward:r,loopBackward:s,nextContext:function(e){var t=null;return r(this,e,function(e,n){return t=n,!0}),t},previousContext:function(e){var t=null;return s(this,e,function(e,n){return t=n,!0}),t},validate:function(){if(null!=m)for(var e=[m];0<e.length;){for(var t=[],n=0;n<e.length;n+=1){var i=e[n];if(null==i.value||null!=i.left&&(t.push(i.left),i.left.value>=i.value)||null!=i.right&&(t.push(i.right),i.right.value<=i.value))return!1;if(i.balance!=l(i.right)-l(i.left))return console.log("Disbalanced node: "+i.value+" - "+JSON.stringify(m)),!1}e=t}return!0}}},e.common.SpatialIndex=function(t){function n(t,n){this.minimum=t,this.maximum=n,this.quadTree=e.common.QuadTree(2*n)}var i=[];switch(t.sort(function(e,t){return e-t}),t.length){case 0:i.push(new n(0,1e6));break;case 1:var o=t[0];i.push(new n(0,o));break;case 2:o=t[0],(t=t[1])>2*o?(i.push(new n(0,o)),i.push(new n(o,t))):i.push(new n(0,t));break;default:o=e.common.getLiniarBreaks(t);for(var a=0,r=0;r<o.length;r+=1){var s=t[o[r]];i.push(new n(a,s)),a=s}}return{addRect:function(e){for(var t=Math.max(e.width,e.height),n=e.centerPoint(),o=0,a=i.length;o<a;o+=1){var r=i[o];if(t<=r.maximum||o==a-1){n.context=e,r.quadTree.addPoint(n);break}}},loopArea:function(t,n,o){if(null!=o)for(var a=0,r=i.length;a<r;a+=1){var s=i[a],l=new e.common.Rect(n);l.offset(s.maximum/2),s.quadTree.loopArea(this,l,function(e){if(e=e.context,n.overlaps(e))return o.call(t,e)})}},validate:function(){for(var e=!0,t=0,n=i.length;t<n;t+=1){var o=i[t];e=e&&o.quadTree.validate()}return e},getPositions:function(e){for(var t=[],n=0,o=i.length;n<o;n+=1)t=t.concat(i[n].quadTree.getPositions(e));return t}}},e.common.tree=function(t){function n(e,t,n){var i,o,a;if(null!=r[t]&&null!=(t=l[t]))for(o=0,a=t.length;o<a&&(i=t[o],!n.call(e,i,r[i],o,a-1));o+=1);}function i(e){var t=null;return null!=s[e]&&(t=s[e]),t}function o(e,t){var n,i=e.length;for(n=0;n<i;n+=1)if(e[n]==t)return e.splice(n,1),i-1;return i}function a(e,t,o){if(null!=o&&r.hasOwnProperty(t)){var a=i(t);null!=a&&o.call(e,a,r[a])||(n(e,a,function(n,i){n!=t&&o.call(e,n,i)}),n(e,t,function(t,n){o.call(e,t,n)}))}}var r={},s={},l={},m={},c={};return e.common.isObject(t)&&(r=e.common.cloneObject(t.nodes,!0),s=e.common.cloneObject(t.parents,!0),l=e.common.cloneObject(t.children,!1),m=e.common.cloneObject(t.roots,!1),c=e.common.cloneObject(t.rootChildren,!0)),{loop:function(e,t){var n;if(null!=t)for(n in r)if(r.hasOwnProperty(n)&&t.call(e,n,r[n]))break},loopLevels:function(e,t,n){var i,o,a,s,m,h=0,u=[];switch(arguments.length){case 2:o=t;break;case 3:i=t,o=n}if(null!=o){if(null==i)for(a in c)c.hasOwnProperty(a)&&(u=u.concat(c[a]));else null!=l[i]&&(u=u.concat(l[i]));for(;0<u.length;){for(a=[],s=0,m=u.length;s<m;s+=1)switch(i=u[s],o.call(e,i,r[i],h)){case 1:a=[];break;case 2:break;default:null!=l[i]&&(a=a.concat(l[i]))}u=a,h+=1}}},loopParents:function(e,t,n,i){if(null!=r[t]&&null!=n&&(!0!==i||!n.call(e,t,r[t])))for(;null!=(t=s[t])&&!n.call(e,t,r[t]););},loopChildren:n,loopChildrenRange:function(e,t,n,i,o){var a;if(null!=r[t]&&null!=(t=l[t]))if(n<i)for(n=Math.max(n,0),i=Math.min(i,t.length-1),a=n;a<=i&&(n=t[a],!o.call(e,n,r[n],a,NaN));a+=1);else for(n=Math.min(n,t.length-1),i=Math.max(0,i),a=n;a>=i&&(n=t[a],!o.call(e,n,r[n],a,NaN));a-=1);},loopChildrenReversed:function(e,t,n){var i,o,a;if(null!=r[t]&&(a=(t=l[t]).length-1,null!=t))for(o=a;0<=o&&(i=t[o],!n.call(e,i,r[i],o,a));o-=1);},loopPostOrder:function(e,t){var n,i,o,a=[];if(null!=t){for(n in c)c.hasOwnProperty(n)&&(a=a.concat(c[n]));for(;0<a.length;)if((n=a[a.length-1])!=i&&null!=(o=l[n]))for(n=o.length-1;0<=n;n-=1)a.push(o[n]);else if(a.pop(),i=s[n],t.call(e,n,r[n],i,r[i]))break}},loopPreOrder:function(e,t){var n,i,o,a,m=[];if(null!=t){for(n in c)c.hasOwnProperty(n)&&(m=m.concat(c[n]));for(;0<m.length&&((n=m[m.length-1])==o||(i=s[n],!t.call(e,n,r[n],i,r[i])));)if(n!=o&&null!=(a=l[n]))for(n=a.length-1;0<=n;n-=1)m.push(a[n]);else m.pop(),o=s[n]}},loopEulerWalk:function(e,t){var n,i,o,a,m=[],h=[],u=0;if(null!=t){for(n in c)if(c.hasOwnProperty(n))for(i=0,u=(a=c[n]).length;i<u;i+=1)m.push(a[i]),h.push(0);for(;0<m.length&&(n=m[i=m.length-1],u=h[i],!t.call(e,n,r[n],u));)if(n!=o&&null!=(a=l[n]))for(i=a.length-1;0<=i;i-=1)m.push(a[i]),h.push(u+1),0<i&&(m.push(n),h.push(u));else m.pop(),h.pop(),o=s[n]}},loopNeighbours:function(e,t,n,i){var o,s={},l=[t],m=0;if(null!=i&&r.hasOwnProperty(t))for(s[t]=!0;0<l.length;){o=[];t=0;for(var c=l.length;t<c;t+=1){var h=l[t];if(0<m&&i.call(e,h,r[h],m))return;m<n&&a(this,h,function(e){s.hasOwnProperty(e)||(o.push(e),s[e]=!0)})}l=o,m+=1}},zipUp:function(e,t,n,i){var o,a;if(null!=i)for(;null!=t&&null!=n&&t!=n&&(o=s[t],a=s[n],!i.call(e,t,o,n,a));)t=o,n=a},parentid:i,parent:function(e){var t=null;return null!=s[e]&&(t=r[s[e]]),t},adopt:function(e,t){if(null==r[e]||null==r[t])throw"Both parent and child should be in hierarchy!";if(e==t)throw"Item cannot be parent of itself!";m.hasOwnProperty(t)&&(o(c[m[t]],t)||delete c[m[t]],delete m[t]),s.hasOwnProperty(t)&&(o(l[s[t]],t)||delete l[s[t]]),s[t]=e,null!=l[e]?l[e].push(t):l[e]=[t]},moveChildren:function(e,t){null!=r[e]&&null!=r[t]&&e!=t&&null!=l[e]&&(n(this,e,function(e){s[e]=t}),l[t]=null!=l[t]?l[t].concat(l[e]):l[e],delete l[e])},node:function(e){return r[e]},add:function(e,t,n,i){var o;if(null!=r[t])throw"Node already exists";if(null!=t&&null!=n&&null==r[t]&&(null!=r[e]?(s[t]=e,null!=l[e]?null==i?l[e].push(t):l[e].splice(i,0,t):l[e]=[t]):(m[t]=e,null!=c[e]?null==i?c[e].push(t):c[e].splice(i,0,t):c[e]=[t]),r[t]=n,null!=c[t]))for(l[t]=c[t],delete c[t],e=0,n=(i=l[t]).length;e<n;e+=1)o=i[e],delete m[o],s[o]=t},insert:function(e,t,i){null!=r[e]&&null!=t&&null==r[t]&&null!=i&&(r[t]=i,null!=l[e]&&(l[t]=l[e]),l[e]=[t],n(this,t,function(e){s[e]=t}),s[t]=e)},hasNodes:function(){return!e.common.isEmptyObject(c)},hasChildren:function(e){return null!=l[e]},countChildren:function(e){return null!=l[e]?l[e].length:0},countSiblings:function(e){return null!=(e=i(e))?l[e].length:0},indexOf:function(t){var n=i(t);return null!=n?e.common.indexOf(l[n],t):null},getChild:function(e,t){var n,i=null;return null!=(n=l[e])&&(i=r[n[t]]),i},arrangeChildren:function(e,t){var n,i,o;t=t.slice(0);if(null!=r[e])if(null!=l[e]){if(l[e].length!=t.length)throw"Collections of children don't match each other!";for(i=0,o=t.length;i<o;i+=1)if(n=t[i],s[n]!=e)throw"Child "+n+" does not belong to given node!";l[e]=t}else if(0<t.length)throw"Collections of children don't match each other!"},validate:function(){var e,t=!0;for(e in m)if(m.hasOwnProperty(e)&&null!=m[e]){t=!1;break}return t},clone:function(){return e.common.tree({nodes:r,parents:s,children:l,roots:m,rootChildren:c})},BREAK:1,SKIP:2}},e.common.TreeLevels=function(t){function n(e){this.context=e,this.items=[]}function i(e,t,n){this.context=e,this.positions={},this.positions[n]=t,this.endLevel=this.startLevel=n}function o(e){return null==a[e]&&(a[e]=new n(null),s=null===s?e:Math.min(s,e),l=null===l?e:Math.max(l,e)),a[e]}var a=[],r={},s=null,l=null;return e.common.isObject(t)&&(a=e.common.cloneObject(t.levels,!0),r=e.common.cloneObject(t.items,!0),s=e.common.cloneObject(t.minimum,!0),l=e.common.cloneObject(t.maximum,!0)),{addlevel:function(e,t){o(e).context=t},hasLevel:function(e){return null!=a[e]},hasItem:function(e){return r.hasOwnProperty(e)},addItem:function(e,t,n){var a;r.hasOwnProperty(t)?((a=o(e)).items.push(t),(t=r[t]).positions[e]=a.items.length-1,t.startLevel=Math.min(t.startLevel,e),t.endLevel=Math.max(t.endLevel,e)):((a=o(e)).items.push(t),r[t]=new i(n,a.items.length-1,e))},getItemContext:function(e){var t=null;return r.hasOwnProperty(e)&&(t=r[e].context),t},getLevelIndex:function(e){return r.hasOwnProperty(e)?r[e].startLevel:null},getEndLevelIndex:function(e){return r.hasOwnProperty(e)?r[e].endLevel:null},getItemPosition:function(e,t){var n=r[e];return null!=n?null!=t?n.positions[t]:n.positions[n.startLevel]:null},getItemAtPosition:function(e,t){var n=a[e],i=null;return null!=n&&(i=n.items[t]),i},loopLevels:function(e,t){var n,i;if(null!=t)for(n=s;n<=l&&(null==(i=a[n])||!t.call(e,n,i.context));n+=1);},loopLevelsReversed:function(e,t){var n,i;if(null!=t)for(n=l;n>=s&&(null==(i=a[n])||!t.call(e,n,i.context));n-=1);},loopLevelItems:function(e,t,n){var i,o,s;if(null!=n&&null!=(o=a[t]))for(t=0,i=o.items.length;t<i&&(s=o.items[t],!n.call(e,s,r[s].context,t));t+=1);},getLevelLength:function(e){var t=0;return null!=(e=a[e])&&(t=e.items.length),t},loopItems:function(e,t){var n,i,o,m,c,h,u={};if(null!=t)for(m=s;m<=l;m+=1)if(null!=(o=a[m]))for(n=0,i=(c=o.items).length;n<i;n+=1)if(h=c[n],!u.hasOwnProperty(h)&&(u[h]=!0,t.call(e,h,r[h].context,n,m,o.context)))return},binarySearch:function(t,n,i){var o=null;return null!=i&&(null!=(n=a[n])&&(o=e.common.binarySearch(n.items,function(e){return i.call(t,e,r[e].context)}))),o.item},loopMerged:function(t,n,i){var o,s,l,m=[];for(o=0,s=a.length;o<s;o+=1)null!=(l=a[o])&&m.push(l.items);if(l=e.common.mergeSort(m,n,!0),null!=i)for(o=0,s=l.length;o<s&&(n=l[o],!i.call(t,n,r[n].context));o+=1);},loopFromItem:function(e,t,n,i,o){var s;if(r.hasOwnProperty(t)&&(t=r[t],s=o||t.startLevel,o=a[s].items,t=t.positions[s],null!=i))if(n)for(n=t-1;0<=n&&(s=o[n],!i.call(e,s,r[s].context));n-=1);else for(n=t+1,t=o.length;n<t&&(s=o[n],!i.call(e,s,r[s].context));n+=1);},loopLevelsFromItem:function(e,t,n,i){if(r.hasOwnProperty(t)&&(t=r[t],null!=i))if(n)for(n=t.endLevel+1;n<=l&&(t=a[n],!i.call(e,n,null!=t?t.context:null));n+=1);else for(n=t.startLevel-1;n>=s&&(t=a[n],!i.call(e,n,null!=t?t.context:null));n-=1);},getPrevItem:function(e,t){var n=null;return r.hasOwnProperty(e)&&(n=r[e],t=t||n.startLevel,n=a[t].items[n.positions[t]-1]),n},getNextItem:function(e,t){var n=null;return r.hasOwnProperty(e)&&(n=r[e],t=t||n.startLevel,n=a[t].items[n.positions[t]+1]),n},length:function(){return a.length},isEmpty:function(){return!a.length},clone:function(){return e.common.TreeLevels({levels:a,items:r,minimum:s,maximum:l})}}},e.common.DependencyManager=function(){var e={};return{register:function(t,n){return e[t]=n},resolve:function(t,n,i){var o=[],a=i||{};return function(){for(var i=Array.prototype.slice.call(arguments,0),r=0;r<t.length;r+=1){var s=t[r];o.push(e.hasOwnProperty(s)&&""!==s?e[s]:i.shift())}return o=o.concat(i),n.apply(a||{},o)}}}},e.common.KeyboardNavigationManager=function(){function t(e,t){this.itemid=e,this.row=t}function n(){if(null==r){var t=0;a=e.common.SortedList(),e.common.getMinimumCrossingRows(this,s,function(e){a.add(e,t),t+=1}),r=e.common.TreeLevels(),s.sort(function(e,t){return e.horizontalCenter()-t.horizontalCenter()});for(var n=0,i=s.length;n<i;n+=1){var o=s[n];a.loopForward(this,o.y,function(e,t){if(e>o.bottom())return!0;r.addItem(t,o.context,o)})}}}function i(e){return n(),null!=l&&l.itemid==e||(l=new t(e,r.getLevelIndex(e))),l}function o(e){var t=r.getItemContext(l.itemid).horizontalCenter(),n=l.itemid;r.loopLevelsFromItem(this,l.itemid,e,function(e){return l.row=e,l.itemid=r.binarySearch(this,e,function(e,n){return t-n.horizontalCenter()}),!0}),n==l.itemid&&(l.row=e?r.getEndLevelIndex(l.itemid):r.getLevelIndex(l.itemid))}var a,r,s=[],l=null;return{addRect:function(t,n){var i=new e.common.Rect(t);i.context=n,s.push(i)},prepair:n,getItemAbove:function(e){return l=i(e),o(!1),l.itemid},getItemBelow:function(e){return l=i(e),o(!0),l.itemid},getItemOnLeft:function(e){return l=i(e),null!=(e=r.getPrevItem(l.itemid,l.row))&&(l.itemid=e),l.itemid},getItemOnRight:function(e){return l=i(e),null!=(e=r.getNextItem(l.itemid,l.row))&&(l.itemid=e),l.itemid},getNavigationLevels:function(){n();var e=[];return r.loopLevels(this,function(t){var n=[];r.loopLevelItems(this,t,function(e){n.push(e)}),e.push(n)}),e}}},e.common.TaskManager=function(){function t(e,t,n,i){this.name=e,this.dependencies=t,this.factory=n,this.task=null,this.color=i}var n=new e.common.family,i=new e.common.DependencyManager,o=[];return{addTask:function(e,i,a,r){if(0<o.length)throw"Task Manager is already initialized";n.add(i,e,new t(e,i,a,r))},addDependency:function(e,t){if(0<o.length)throw"Task Manager is already initialized";i.register(e,t)},getTask:function(e){return(e=n.node(e))&&e.task},process:function(e,t,a){var r=!1;0===o.length&&n.loopTopo(this,function(e,t){t.task=i.register(e,i.resolve(t.dependencies,t.factory)()),o.push(t)}),a&&console.log("-- process --");for(var s={},l=0,m=o.length;l<m;l+=1){var c=o[l],h=[];if(c.name==e||s.hasOwnProperty(c.name)){if(a)var u=performance.now();if((r=c.task.process(a))&&n.loopChildren(this,c.name,function(e){return s[e]=!0,a&&h.push(e),n.SKIP}),a)var d=performance.now();if(a){var g=Math.round(d-u,2);console.log(l+". "+c.name+", "+g+" ms. "+(r?" - forces: "+h.toString():""))}}if(c.name==t)break}},getProcessDiagramConfig:function(){var t=new e.famdiagram.Config;0===o.length&&n.loopTopo(this,function(e,t){t.task=i.register(e,i.resolve(t.dependencies,t.factory)()),o.push(t)});for(var a=0,r=o.length;a<r;a+=1){var s=o[a],l=new e.famdiagram.ItemConfig;l.id=s.name,l.title=e.common.splitCamelCaseName(s.name).join(" "),l.description=s.task.description||"",l.itemTitleColor=s.color,l.parents=[],n.loopParents(this,s.name,function(e){return l.parents.push(e),n.SKIP}),t.items.push(l)}return t}}},e.pdf.graphics=function(t){this._context=this._doc=t,this._dummyPlaceholder=new e.common.Placeholder},e.pdf.graphics.prototype.clean=function(){},e.pdf.graphics.prototype.resize=function(){},e.pdf.graphics.prototype.begin=function(){},e.pdf.graphics.prototype.end=function(){},e.pdf.graphics.prototype.reset=function(){},e.pdf.graphics.prototype.activate=function(){return this._dummyPlaceholder},e.pdf.graphics.prototype.text=function(){},e.pdf.graphics.prototype.polylinesBuffer=function(e){e.loop(this,function(e){0<e.length()&&this.polyline(e)})},e.pdf.graphics.prototype.polyline=function(e){var t,n=e.paletteItem.toAttr(),i=this._doc;if(i.save(),e.loop(this,function(e){switch(e.segmentType){case 1:i.moveTo(Math.round(e.x)+.5,Math.round(e.y)+.5);break;case 0:i.lineTo(Math.round(e.x)+.5,Math.round(e.y)+.5);break;case 4:e.width==e.height&&e.width/2<=e.cornerRadius?i.roundedRect(Math.round(e.x)+.5,Math.round(e.y)+.5,e.width,e.height,Math.min(e.width,e.height)/2):0===e.cornerRadius?(i.moveTo(Math.round(e.x)+.5,Math.round(e.y)+.5),i.lineTo(Math.round(e.x+e.width)+.5,Math.round(e.y)+.5),i.lineTo(Math.round(e.x+e.width)+.5,Math.round(e.y+e.height)+.5),i.lineTo(Math.round(e.x)+.5,Math.round(e.y+e.height)+.5),i.lineTo(Math.round(e.x)+.5,Math.round(e.y)+.5)):(t=Math.min(e.cornerRadius,Math.min(e.width/2,e.height/2)),i.roundedRect(Math.round(e.x)+.5,Math.round(e.y)+.5,e.width,e.height,t));break;case 2:i.quadraticCurveTo(Math.round(e.cpX)+.5,Math.round(e.cpY)+.5,Math.round(e.x)+.5,Math.round(e.y)+.5);break;case 3:i.bezierCurveTo(Math.round(e.cpX1)+.5,Math.round(e.cpY1)+.5,Math.round(e.cpX2)+.5,Math.round(e.cpY2)+.5,Math.round(e.x)+.5,Math.round(e.y)+.5)}}),i.lineJoin("round"),null!=n.lineType)switch(e=Math.round(n.lineWidth)||1,n.lineType){case 1:i.dash(e,2*e);break;case 2:i.dash(5*e,3*e)}void 0!==n.lineWidth&&void 0!==n.fillColor?i.lineWidth(n.lineWidth).fillOpacity(n.opacity).fillAndStroke(n.fillColor,n.borderColor):void 0!==n.lineWidth?i.lineWidth(n.lineWidth).stroke(n.borderColor):void 0!==n.fillColor&&i.fillOpacity(n.opacity).fillColor(n.fillColor),i.restore()},e.pdf.graphics.prototype.rightAngleLine=function(){},e.pdf.graphics.prototype.template=function(t,n,i,o,a,r,s,l,m,c,h,u,d){i=0,null!==d&&void 0!==d.borderWidth&&(i=this.getPxSize(d.borderWidth)),t=new e.common.Rect(t+a,n+r,s-i,l-i),null==u&&(u=new e.common.RenderEventArgs),null!==h&&h(this._doc,t,u)},e.pdf.graphics.prototype.getPxSize=function(e,t){var n=e;return"string"==typeof e&&(n=0<e.indexOf("pt")?96*parseInt(e,10)/72:0<e.indexOf("%")?parseFloat(e)/100*t:parseInt(e,10)),n},e.pdf.famdiagram.Plugin=function(t){function n(){return r.options}function i(){return r.graphics}function o(){var t=new e.common.TaskManager;return t.addDependency("options",n),t.addDependency("graphics",i),t.addDependency("defaultConfig",new e.famdiagram.Config),t.addDependency("defaultItemConfig",new e.famdiagram.ItemConfig),t.addDependency("defaultTemplateConfig",new e.famdiagram.TemplateConfig),t.addDependency("defaultButtonConfig",new e.famdiagram.ButtonConfig),t.addDependency("defaultPaletteItemConfig",new e.famdiagram.PaletteItemConfig),t.addDependency("defaultBackgroundAnnotationConfig",new e.famdiagram.BackgroundAnnotationConfig),t.addDependency("defaultConnectorAnnotationConfig",new e.famdiagram.ConnectorAnnotationConfig),t.addDependency("defaultHighlightPathAnnotationConfig",new e.famdiagram.HighlightPathAnnotationConfig),t.addDependency("defaultShapeAnnotationConfig",new e.famdiagram.ShapeAnnotationConfig),t.addDependency("defaultLabelAnnotationConfig",new e.famdiagram.LabelAnnotationConfig),t.addDependency("isFamilyChartMode",!0),t.addDependency("showElbowDots",!0),t.addDependency("null",null),t.addDependency("foreground",2),t.addDependency("background",1),t.addTask("OptionsTask",["options"],e.famdiagram.OptionsTask,"#000000"),t.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.orgdiagram.CalloutOptionTask,"#000080"),t.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ConnectorsOptionTask,"#000080"),t.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],e.famdiagram.ItemsOptionTask,"#000080"),t.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],e.famdiagram.SpousesOptionTask,"#000080"),t.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],e.orgdiagram.ItemsSizesOptionTask,"#000080"),t.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],e.orgdiagram.TemplatesOptionTask,"#000080"),t.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.OrientationOptionTask,"#000080"),t.addTask("VisualTreeOptionTask",["OptionsTask"],e.famdiagram.VisualTreeOptionTask,"#000080"),t.addTask("HideGrandParentsConnectorsOptionTask",["OptionsTask","defaultConfig"],e.famdiagram.HideGrandParentsConnectorsOptionTask,"#000080"),t.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],e.famdiagram.NormalizeOptionTask,"#000080"),t.addTask("OrderFamilyNodesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.famdiagram.OrderFamilyNodesOptionTask,"#000080"),t.addTask("LinePaletteOptionTask",["OptionsTask","defaultPaletteItemConfig"],e.famdiagram.LinePaletteOptionTask,"#000080"),t.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.CursorItemOptionTask,"#000080"),t.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.HighlightItemOptionTask,"#000080"),t.addTask("SelectedItemsOptionTask",["OptionsTask"],e.orgdiagram.SelectedItemsOptionTask,"#000080"),t.addTask("SplitAnnotationsOptionTask",["OptionsTask"],e.orgdiagram.SplitAnnotationsOptionTask,"#00ffff"),t.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),t.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),t.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),t.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),t.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),t.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),t.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],e.orgdiagram.BackgroundAnnotationOptionTask,"#000080"),t.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ScaleOptionTask,"#000080"),t.addTask("UserDefinedNodesOrderTask",["OrderFamilyNodesOptionTask","defaultItemConfig"],e.famdiagram.UserDefinedNodesOrderTask,"#ff0000"),t.addTask("LogicalFamilyTask",["ItemsOptionTask"],e.famdiagram.LogicalFamilyTask,"#00ffff"),t.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],e.famdiagram.LabelAnnotationOptionTask,"#000080"),t.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],e.famdiagram.LabelAnnotationTemplateOptionTask,"#000080"),t.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],e.famdiagram.LabelAnnotationPlacementOptionTask,"#000080"),t.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],e.orgdiagram.CombinedContextsTask,"#00ffff"),t.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],e.famdiagram.AddLabelAnnotationsTask,"#ff0000"),t.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],e.famdiagram.RemoveLoopsTask,"#ff0000"),t.addTask("AddSpousesTask",["SpousesOptionTask","RemoveLoopsTask"],e.famdiagram.AddSpousesTask,"#ff0000"),t.addTask("HideGrandParentsConnectorsTask",["HideGrandParentsConnectorsOptionTask","AddSpousesTask"],e.famdiagram.HideGrandParentsConnectorsTask,"#ff0000"),t.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","HideGrandParentsConnectorsTask"],e.famdiagram.NormalizeLogicalFamilyTask,"#ff0000"),t.addTask("OrderFamilyNodesTask",["OrderFamilyNodesOptionTask","UserDefinedNodesOrderTask","NormalizeLogicalFamilyTask","defaultItemConfig"],e.famdiagram.OrderFamilyNodesTask,"#ff0000"),t.addTask("ReadTemplatesTask",["TemplatesOptionTask"],e.pdf.orgdiagram.ReadTemplatesTask,"#00ffff"),t.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],e.orgdiagram.ItemTemplateParamsTask,"#00ffff"),t.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],e.famdiagram.LabelAnnotationTemplateParamsTask,"#00ffff"),t.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],e.famdiagram.CombinedTemplateParamsTask,"#00ffff"),t.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],e.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff"),t.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],e.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff"),t.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],e.pdf.orgdiagram.ButtonsTemplateTask,"#00ffff"),t.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],e.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff"),t.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","OrderFamilyNodesTask","AlignDiagramTask"],e.orgdiagram.ConnectionsGraphTask,"#00ffff"),t.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],e.orgdiagram.HighlightItemTask,"#00ffff"),t.addTask("CursorItemTask",["CursorItemOptionTask","null"],e.orgdiagram.CursorItemTask,"#00ffff"),t.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],e.orgdiagram.SelectedItemsTask,"#00ffff"),t.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],e.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff"),t.addTask("CurrentControlSizeTask",["OptionsTask"],e.pdf.orgdiagram.DummyCurrentControlSizeTask,"#00ffff"),t.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask OrderFamilyNodesOptionTask OrderFamilyNodesTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),e.famdiagram.ItemsPositionsTask,"#ff0000"),t.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask null ItemsPositionsTask isFamilyChartMode".split(" "),e.orgdiagram.AlignDiagramTask,"#ff0000"),t.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],e.orgdiagram.CreateTransformTask,"#00ffff"),t.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],e.orgdiagram.PaletteManagerTask,"#00ffff"),t.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask".split(" "),e.orgdiagram.DrawBackgroundAnnotationTask,"#008000"),t.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),t.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),t.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawBackgroundConnectorAnnotationTask".split(" "),e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),t.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),e.orgdiagram.DrawConnectorsTask,"#008000"),t.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),t.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask null ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask null CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawForegroundHighlightPathAnnotationTask".split(" "),e.orgdiagram.DrawTreeItemsTask,"#008000"),t.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask DrawTreeItemsTask".split(" "),e.orgdiagram.DrawCursorTask,"#008000"),t.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),e.orgdiagram.DrawHighlightTask,"#008000"),t.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawHighlightTask".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),t.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),t}function a(){r.options.hasButtons=2,r.options.pageFitMode=5,r.options.autoSizeMaximum=new e.common.Size(1e5,1e5)}var r={name:"famdiagram",doc:null,options:t,tasks:null,graphics:null};return{draw:function(t,n,i){return r.doc=t,r.tasks=o(),r.graphics=new e.pdf.graphics(r.doc),r.graphics.debug=!1,a(),r.doc.save(),r.doc.translate(n,i),r.tasks.process("OptionsTask",null,!1),r.doc.restore(),t=r.tasks.getTask("AlignDiagramTask"),new e.common.Size(t.getContentSize())},getSize:function(){r.tasks=o(),a(),r.tasks.process("OptionsTask","AlignDiagramTask",!1);var t=r.tasks.getTask("AlignDiagramTask");return new e.common.Size(t.getContentSize())}}},e.pdf.Template=function(t,n){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null,null!=n&&(this.templateConfig=n,this.itemTemplate=e.common.isNullOrEmpty(n.itemTemplate)?new e.pdf.ItemTemplate(t,n):new e.pdf.UserTemplate(t,n,t.onItemRender),this.highlightTemplate=e.common.isNullOrEmpty(n.highlightTemplate)?new e.pdf.HighlightTemplate(t,n):new e.pdf.UserTemplate(t,n,t.onHighlightRender),this.dotHighlightTemplate=new e.pdf.DummyTemplate(t,n),this.cursorTemplate=e.common.isNullOrEmpty(n.cursorTemplate)?new e.pdf.CursorTemplate(t,n):new e.pdf.UserTemplate(t,n,t.onCursorRender))},e.pdf.orgdiagram.DummyCurrentControlSizeTask=function(){return{process:function(){return!0},getScrollPanelSize:function(){return new e.common.Size(800,600)},getOptimalPanelSize:function(){return new e.common.Size(775,575)}}},e.pdf.orgdiagram.AnnotationLabelTemplateTask=function(){var t=null;return{process:function(){return!1},getTemplate:function(){return null==t&&(t=new e.pdf.AnnotationLabelTemplate),t}}},e.pdf.orgdiagram.ButtonsTemplateTask=function(){var t=null;return{process:function(){return!1},getTemplate:function(){return null==t&&(t=new e.pdf.DummyTemplate),t}}},e.pdf.orgdiagram.CheckBoxTemplateTask=function(t){var n=null;return{process:function(){return n=null,!0},getTemplate:function(){var i;return null==n&&(i=t.getOptions(),n=new e.pdf.CheckBoxTemplate(i.selectCheckBoxLabel)),n}}},e.pdf.orgdiagram.GroupTitleTemplateTask=function(t){var n=null;return{process:function(){return n=null,!0},getTemplate:function(){var i;return null==n&&(i=t.getOptions(),n=new e.pdf.GroupTitleTemplate(i.itemTitleFirstFontColor,i.itemTitleSecondFontColor)),n}}},e.pdf.orgdiagram.ReadTemplatesTask=function(t){var n={};return{process:function(){var i,o,a,r=t.getOptions(),s=r.templates;for((n={}).DefaultWidgetTemplate=new e.pdf.Template(r,new e.orgdiagram.TemplateConfig),(i=new e.orgdiagram.TemplateConfig).name="DefaultWidgetLabelAnnotationTemplate",i.isActive=!1,i.itemSize=new e.common.Size(100,20),i.minimizedItemSize=new e.common.Size(0,0),(o=new e.pdf.Template).templateConfig=i,o.minimizedItemCornerRadius=i.minimizedItemSize.width/2,o.itemTemplate=new e.pdf.LabelAnnotationTemplate,o.dotHighlightTemplate=new e.pdf.DummyTemplate,n.DefaultWidgetLabelAnnotationTemplate=o,i=0,o=s.length;i<o;i+=1)a=s[i],n[a.name]=new e.pdf.Template(r,a);return!0},getTemplate:function(e,t,i){return n[e]||n[t]||n[i]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}},e.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask=function(){return{process:function(){return!0},isItemSelected:function(){return!1}}},e.pdf.orgdiagram.Plugin=function(t){function n(){return r.options}function i(){return r.graphics}function o(){var t=new e.common.TaskManager;return t.addDependency("options",n),t.addDependency("graphics",i),t.addDependency("defaultConfig",new e.orgdiagram.Config),t.addDependency("defaultItemConfig",new e.orgdiagram.ItemConfig),t.addDependency("defaultTemplateConfig",new e.orgdiagram.TemplateConfig),t.addDependency("defaultButtonConfig",new e.orgdiagram.ButtonConfig),t.addDependency("defaultBackgroundAnnotationConfig",new e.orgdiagram.BackgroundAnnotationConfig),t.addDependency("defaultConnectorAnnotationConfig",new e.orgdiagram.ConnectorAnnotationConfig),t.addDependency("defaultHighlightPathAnnotationConfig",new e.orgdiagram.HighlightPathAnnotationConfig),t.addDependency("defaultShapeAnnotationConfig",new e.orgdiagram.ShapeAnnotationConfig),t.addDependency("isFamilyChartMode",!1),t.addDependency("showElbowDots",!1),t.addDependency("null",null),t.addDependency("foreground",2),t.addDependency("background",1),t.addTask("OptionsTask",["options"],e.orgdiagram.OptionsTask,"#000000"),t.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],e.orgdiagram.CalloutOptionTask,"#000080"),t.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ConnectorsOptionTask,"#000080"),t.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],e.orgdiagram.ItemsOptionTask,"#000080"),t.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],e.orgdiagram.ItemsSizesOptionTask,"#000080"),t.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],e.orgdiagram.TemplatesOptionTask,"#000080"),t.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.OrientationOptionTask,"#000080"),t.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.VisualTreeOptionTask,"#000080"),t.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.CursorItemOptionTask,"#000080"),t.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.HighlightItemOptionTask,"#000080"),t.addTask("SelectedItemsOptionTask",["OptionsTask"],e.orgdiagram.SelectedItemsOptionTask,"#000080"),t.addTask("SplitAnnotationsOptionTask",["OptionsTask"],e.orgdiagram.SplitAnnotationsOptionTask,"#00ffff"),t.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),t.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],e.orgdiagram.ShapeAnnotationOptionTask,"#000080"),t.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),t.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],e.orgdiagram.HighlightPathAnnotationOptionTask,"#000080"),t.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),t.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],e.orgdiagram.ConnectorAnnotationOptionTask,"#000080"),t.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],e.orgdiagram.BackgroundAnnotationOptionTask,"#000080"),t.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],e.orgdiagram.ScaleOptionTask,"#000080"),t.addTask("CombinedContextsTask",["ItemsOptionTask"],e.orgdiagram.CombinedContextsTask,"#00ffff"),t.addTask("OrgTreeTask",["ItemsOptionTask"],e.orgdiagram.OrgTreeTask,"#ff0000"),t.addTask("ReadTemplatesTask",["TemplatesOptionTask"],e.pdf.orgdiagram.ReadTemplatesTask,"#00ffff"),t.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],e.orgdiagram.ItemTemplateParamsTask,"#00ffff"),t.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],e.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff"),t.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],e.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff"),t.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],e.pdf.orgdiagram.ButtonsTemplateTask,"#00ffff"),t.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],e.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff"),t.addTask("VisualTreeTask",["OrgTreeTask","null","VisualTreeOptionTask","isFamilyChartMode"],e.orgdiagram.VisualTreeTask,"#ff0000"),t.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],e.orgdiagram.VisualTreeLevelsTask,"#ff0000"),t.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],e.orgdiagram.ConnectionsGraphTask,"#00ffff"),t.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],e.orgdiagram.HighlightItemTask,"#00ffff"),t.addTask("CursorItemTask",["CursorItemOptionTask","null"],e.orgdiagram.CursorItemTask,"#00ffff"),t.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],e.orgdiagram.SelectedItemsTask,"#00ffff"),t.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],e.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff"),t.addTask("CurrentControlSizeTask",["OptionsTask"],e.pdf.orgdiagram.DummyCurrentControlSizeTask,"#00ffff"),t.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask VisualTreeTask VisualTreeLevelsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),e.orgdiagram.ItemsPositionsTask,"#ff0000"),t.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask null ItemsPositionsTask isFamilyChartMode".split(" "),e.orgdiagram.AlignDiagramTask,"#ff0000"),t.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],e.orgdiagram.CreateTransformTask,"#00ffff"),t.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],e.orgdiagram.PaletteManagerTask,"#00ffff"),t.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask".split(" "),e.orgdiagram.DrawBackgroundAnnotationTask,"#008000"),t.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),t.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),t.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask null ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask null ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawBackgroundConnectorAnnotationTask".split(" "),e.orgdiagram.DrawTreeItemsTask,"#008000"),t.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawTreeItemsTask".split(" "),e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),t.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),e.orgdiagram.DrawConnectorsTask,"#008000"),t.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),e.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff"),t.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundHighlightPathAnnotationTask".split(" "),e.orgdiagram.DrawShapeAnnotationTask,"#008000"),t.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),e.orgdiagram.DrawConnectorAnnotationTask,"#008000"),t.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask DrawForegroundConnectorAnnotationTask".split(" "),e.orgdiagram.DrawCursorTask,"#008000"),t.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),e.orgdiagram.DrawHighlightTask,"#008000"),t}function a(){r.options.hasButtons=2,r.options.pageFitMode=5,r.options.autoSizeMaximum=new e.common.Size(1e5,1e5)}var r={name:"orgdiagram",doc:null,options:t,tasks:null,graphics:null};return{draw:function(t,n,i){return r.doc=t,r.tasks=o(),r.graphics=new e.pdf.graphics(r.doc),r.graphics.debug=!1,a(),r.doc.save(),r.doc.translate(n,i),r.tasks.process("OptionsTask",null,!1),r.doc.restore(),t=r.tasks.getTask("AlignDiagramTask"),new e.common.Size(t.getContentSize())},getSize:function(){r.tasks=o(),a(),r.tasks.process("OptionsTask","AlignDiagramTask",!1);var t=r.tasks.getTask("AlignDiagramTask");return new e.common.Size(t.getContentSize())}}},e.pdf.AnnotationLabelTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(e,t,n){n=n.context,e.save(),e.font("Helvetica",12).text(n.label,t.x,t.y,{width:t.width,height:t.height,align:"center"}),e.restore()}}},e.pdf.CheckBoxTemplate=function(e){return{template:function(){return{}},getHashCode:function(){return 0},render:function(t,n,i){i=i.isSelected?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAF/SURBVDhPpZM7rwFREMf/u4hEY5vVkigoSERiKwq1QqOh28R30QnFRqnSKHwFn0C37Sbi0SCE2KzE41wzd/feG48g91ftmdn5zznzkLLZrNhutzidTvgEv98PRVEgxeNx0e12EYvFcDweXfdjZFmGEIKDx+MxdF0HotGomEwmV/tnUAzFyqT8KrNHLpdDJpPBZrPh81UHLPAO7XYb6/Ua8/kcpmnC5/NBkqT3BJbLJRqNBgKBACqVCgqFAg6HA/veEiiVSlBVFZfLBZ1Ox7V+81KAMtPVV6sV+v2+a/2FBeg9RDqdhqZp/E1Mp1O0Wi32V6tVLuAtLEBvGw6HmM1m2O/3yOfz7CyXy4hEItz3ZrPJtr/8dIEKUiwWYRgGX3e32yGZTOJ8PnMBB4MBB9xy14VarcaZFosFQqEQHMdBvV5HIpFw/3gATZNlWTxdHr1eT4TDYZFKpVzLPRRDsU9HeTQaCdu23dM91wKzwNNlCgaDXINHW0pF95bpn+us4AsY2TIOZFyZ9AAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACjSURBVDhPrZNNCsQgDEY/f2q33sCCN+iNPJlXE2/gTtDiVBln1TJo+zZBJS+YELLvewkhIOeMETjnkFKCaK2LtRbbtiGl9H2+hlKKUkpLds7BGAMopYr3/rwfo+bUXFrN/yrfcXrQBDMwxkAImRfEGFucFnTeEdT/zNIEy7K0wyi/KfSGjPJoCp13BDM9EEK0eLtM67riOI7LLa0F+zI9XGeJDyTldfBA9FNyAAAAAElFTkSuQmCC",t.save(),t.image(i,n.x,n.y),t.font("Helvetica",11).text(e,n.x+20,n.y+4,{ellipsis:!0,width:n.width-4,height:n.height,align:"left"}),t.restore()}}},e.pdf.CursorTemplate=function(e,t){return{template:function(){return{}},getHashCode:function(){return 0},render:function(e,n){e.save(),e.roundedRect(n.x,n.y,n.width,n.height,4).lineWidth(t.cursorBorderWidth).stroke("#fbd850"),e.restore()}}},e.pdf.DummyTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(){}}},e.pdf.GroupTitleTemplate=function(t,n){return{template:function(){return{}},getHashCode:function(){return 0},render:function(i,o,a){var r=(a=a.context).groupTitleColor||"#4169e1",s=e.common.highestContrast(r,n,t);i.save(),i.translate(o.width,0).rotate(90,{origin:[o.x,o.y]}),i.fillColor(r).roundedRect(o.x,o.y,o.height-2,o.width,4).fill(),i.fillColor(s).font("Helvetica",12).text(a.groupTitle,o.x+4,o.y+6,{ellipsis:!0,width:o.height-4,height:o.width-4,align:"center"}),i.restore()}}},e.pdf.HighlightTemplate=function(e,t){return{template:function(){return{}},getHashCode:function(){return 0},render:function(e,n){e.save(),e.roundedRect(n.x,n.y,n.width,n.height,4).lineWidth(t.highlightBorderWidth).stroke("#fbcb09"),e.restore()}}},e.pdf.ItemTemplate=function(t,n){return{template:function(){return{}},getHashCode:function(){return 0},render:function(i,o,a){var r=null!=(a=a.context).itemTitleColor?a.itemTitleColor:"#4169e1",s=e.common.highestContrast(r,t.itemTitleSecondFontColor,t.itemTitleFirstFontColor),l=new e.common.Size(n.itemSize);l.width-=2*n.itemBorderWidth,l.height-=2*n.itemBorderWidth,i.save(),i.roundedRect(o.x,o.y,o.width,o.height,4).lineWidth(n.itemBorderWidth).stroke("#dddddd"),i.fillColor(r).roundedRect(o.x+2,o.y+2,l.width-4,18,2).fill(),i.fillColor(s).font("Helvetica",12).text(a.title,o.x+4,o.y+7,{ellipsis:!0,width:l.width-4-8,height:16,align:"left"}),null!=a.image&&i.image(a.image,o.x+3,o.y+24),i.rect(o.x+3,o.y+24,50,60).stroke("#cccccc"),i.fillColor("black").font("Helvetica",10).text(a.description,o.x+56,o.y+24,{ellipsis:!0,width:l.width-4-56,height:74,align:"left"}),i.restore()}}},e.pdf.LabelAnnotationTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(e,t,n){n=n.context,e.save(),e.font("Helvetica",12).text(n.title,t.x,t.y,{width:t.width,height:t.height,align:"center"}),e.restore()}}},e.pdf.UserTemplate=function(t,n,i){return{template:function(){return{}},getHashCode:function(){return 0},render:function(o,a,r){null!=i?i(o,a,r):e.pdf.ItemTemplate(t,n).render(o,a,r)}}},e}),function(e,t,n,i){"use strict";function o(e,t,n){return setTimeout(m(e,n),t)}function a(e,t,n){return!!Array.isArray(e)&&(r(e,n[t],n),!0)}function r(e,t,n){var o;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==i)for(o=0;o<e.length;)t.call(n,e[o],o,e),o++;else for(o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o,e)}function s(t,n,i){var o="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=e.console&&(e.console.warn||e.console.log);return a&&a.call(e.console,o,i),t.apply(this,arguments)}}function l(e,t,n){var i,o=t.prototype;(i=e.prototype=Object.create(o)).constructor=e,i._super=o,n&&$(i,n)}function m(e,t){return function(){return e.apply(t,arguments)}}function c(e,t){return typeof e==ne?e.apply(t&&t[0]||i,t):e}function h(e,t){return e===i?t:e}function u(e,t,n){r(f(t),function(t){e.addEventListener(t,n,!1)})}function d(e,t,n){r(f(t),function(t){e.removeEventListener(t,n,!1)})}function g(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function p(e,t){return e.indexOf(t)>-1}function f(e){return e.trim().split(/\s+/g)}function T(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function y(e){return Array.prototype.slice.call(e,0)}function k(e,t,n){for(var i=[],o=[],a=0;a<e.length;){var r=t?e[a][t]:e[a];T(o,r)<0&&i.push(e[a]),o[a]=r,a++}return n&&(i=t?i.sort(function(e,n){return e[t]>n[t]}):i.sort()),i}function v(e,t){for(var n,o,a=t[0].toUpperCase()+t.slice(1),r=0;r<ee.length;){if((o=(n=ee[r])?n+a:t)in e)return o;r++}return i}function w(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}function C(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){c(e.options.enable,[e])&&n.handler(t)},this.init()}function b(e,t,n){var i=n.pointers.length,o=n.changedPointers.length,a=t&pe&&i-o==0,r=t&(Te|ye)&&i-o==0;n.isFirst=!!a,n.isFinal=!!r,a&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,o=i.length;n.firstInput||(n.firstInput=O(t)),o>1&&!n.firstMultiple?n.firstMultiple=O(t):1===o&&(n.firstMultiple=!1);var a=n.firstInput,r=n.firstMultiple,s=r?r.center:a.center,l=t.center=S(i);t.timeStamp=ae(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=M(s,l),t.distance=A(s,l),function(e,t){var n=t.center,i=e.offsetDelta||{},o=e.prevDelta||{},a=e.prevInput||{};t.eventType!==pe&&a.eventType!==Te||(o=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=o.x+(n.x-i.x),t.deltaY=o.y+(n.y-i.y)}(n,t),t.offsetDirection=x(t.deltaX,t.deltaY);var m=I(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=m.x,t.overallVelocityY=m.y,t.overallVelocity=oe(m.x)>oe(m.y)?m.x:m.y,t.scale=r?function(e,t){return A(t[0],t[1],xe)/A(e[0],e[1],xe)}(r.pointers,i):1,t.rotation=r?function(e,t){return M(t[1],t[0],xe)+M(e[1],e[0],xe)}(r.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,P(n,t);var c=e.element;g(t.srcEvent.target,c)&&(c=t.srcEvent.target),t.target=c}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function P(e,t){var n,o,a,r,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp;if(t.eventType!=ye&&(l>ge||s.velocity===i)){var m=t.deltaX-s.deltaX,c=t.deltaY-s.deltaY,h=I(l,m,c);o=h.x,a=h.y,n=oe(h.x)>oe(h.y)?h.x:h.y,r=x(m,c),e.lastInterval=t}else n=s.velocity,o=s.velocityX,a=s.velocityY,r=s.direction;t.velocity=n,t.velocityX=o,t.velocityY=a,t.direction=r}function O(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:ie(e.pointers[n].clientX),clientY:ie(e.pointers[n].clientY)},n++;return{timeStamp:ae(),pointers:t,center:S(t),deltaX:e.deltaX,deltaY:e.deltaY}}function S(e){var t=e.length;if(1===t)return{x:ie(e[0].clientX),y:ie(e[0].clientY)};for(var n=0,i=0,o=0;t>o;)n+=e[o].clientX,i+=e[o].clientY,o++;return{x:ie(n/t),y:ie(i/t)}}function I(e,t,n){return{x:t/e||0,y:n/e||0}}function x(e,t){return e===t?ke:oe(e)>=oe(t)?0>e?ve:we:0>t?Ce:be}function A(e,t,n){n||(n=Ie);var i=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return Math.sqrt(i*i+o*o)}function M(e,t,n){n||(n=Ie);var i=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return 180*Math.atan2(o,i)/Math.PI}function L(){this.evEl=Me,this.evWin=Le,this.pressed=!1,C.apply(this,arguments)}function R(){this.evEl=Be,this.evWin=De,C.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function z(){this.evTarget=Fe,this.evWin=Ee,this.started=!1,C.apply(this,arguments)}function B(){this.evTarget=He,this.targetIds={},C.apply(this,arguments)}function D(){C.apply(this,arguments);var e=m(this.handler,this);this.touch=new B(this.manager,e),this.mouse=new L(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function V(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout(function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)},We)}}function F(e,t){this.manager=e,this.set(t)}function E(e){this.options=$({},this.defaults,e||{}),this.id=le++,this.manager=null,this.options.enable=h(this.options.enable,!0),this.state=Ze,this.simultaneous={},this.requireFail=[]}function N(e){return e&it?"cancel":e&tt?"end":e&et?"move":e&$e?"start":""}function H(e){return e==be?"down":e==Ce?"up":e==ve?"left":e==we?"right":""}function W(e,t){var n=t.manager;return n?n.get(e):e}function G(){E.apply(this,arguments)}function _(){G.apply(this,arguments),this.pX=null,this.pY=null}function j(){G.apply(this,arguments)}function Y(){E.apply(this,arguments),this._timer=null,this._input=null}function X(){G.apply(this,arguments)}function q(){G.apply(this,arguments)}function K(){E.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function U(e,t){return(t=t||{}).recognizers=h(t.recognizers,U.defaults.preset),new J(e,t)}function J(e,t){this.options=$({},U.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=function(e){var t=e.options.inputClass;return new(t||(ce?R:he?B:me?D:L))(e,b)}(this),this.touchAction=new F(this,this.options.touchAction),Q(this,!0),r(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Q(e,t){var n,i=e.element;i.style&&(r(e.options.cssProps,function(o,a){n=v(i.style,a),t?(e.oldCssProps[n]=i.style[n],i.style[n]=o):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}function Z(e,n){var i=t.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=n,n.target.dispatchEvent(i)}var $,ee=["","webkit","Moz","MS","ms","o"],te=t.createElement("div"),ne="function",ie=Math.round,oe=Math.abs,ae=Date.now;$="function"!=typeof Object.assign?function(e){if(e===i||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(o!==i&&null!==o)for(var a in o)o.hasOwnProperty(a)&&(t[a]=o[a])}return t}:Object.assign;var re=s(function(e,t,n){for(var o=Object.keys(t),a=0;a<o.length;)(!n||n&&e[o[a]]===i)&&(e[o[a]]=t[o[a]]),a++;return e},"extend","Use `assign`."),se=s(function(e,t){return re(e,t,!0)},"merge","Use `assign`."),le=1,me="ontouchstart"in e,ce=v(e,"PointerEvent")!==i,he=me&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),ue="touch",de="mouse",ge=25,pe=1,fe=2,Te=4,ye=8,ke=1,ve=2,we=4,Ce=8,be=16,Pe=ve|we,Oe=Ce|be,Se=Pe|Oe,Ie=["x","y"],xe=["clientX","clientY"];C.prototype={handler:function(){},init:function(){this.evEl&&u(this.element,this.evEl,this.domHandler),this.evTarget&&u(this.target,this.evTarget,this.domHandler),this.evWin&&u(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(w(this.element),this.evWin,this.domHandler)}};var Ae={mousedown:pe,mousemove:fe,mouseup:Te},Me="mousedown",Le="mousemove mouseup";l(L,C,{handler:function(e){var t=Ae[e.type];t&pe&&0===e.button&&(this.pressed=!0),t&fe&&1!==e.which&&(t=Te),this.pressed&&(t&Te&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:de,srcEvent:e}))}});var Re={pointerdown:pe,pointermove:fe,pointerup:Te,pointercancel:ye,pointerout:ye},ze={2:ue,3:"pen",4:de,5:"kinect"},Be="pointerdown",De="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Be="MSPointerDown",De="MSPointerMove MSPointerUp MSPointerCancel"),l(R,C,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),o=Re[i],a=ze[e.pointerType]||e.pointerType,r=a==ue,s=T(t,e.pointerId,"pointerId");o&pe&&(0===e.button||r)?0>s&&(t.push(e),s=t.length-1):o&(Te|ye)&&(n=!0),0>s||(t[s]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),n&&t.splice(s,1))}});var Ve={touchstart:pe,touchmove:fe,touchend:Te,touchcancel:ye},Fe="touchstart",Ee="touchstart touchmove touchend touchcancel";l(z,C,{handler:function(e){var t=Ve[e.type];if(t===pe&&(this.started=!0),this.started){var n=function(e,t){var n=y(e.touches),i=y(e.changedTouches);return t&(Te|ye)&&(n=k(n.concat(i),"identifier",!0)),[n,i]}.call(this,e,t);t&(Te|ye)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:ue,srcEvent:e})}}});var Ne={touchstart:pe,touchmove:fe,touchend:Te,touchcancel:ye},He="touchstart touchmove touchend touchcancel";l(B,C,{handler:function(e){var t=Ne[e.type],n=function(e,t){var n=y(e.touches),i=this.targetIds;if(t&(pe|fe)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var o,a,r=y(e.changedTouches),s=[],l=this.target;if(a=n.filter(function(e){return g(e.target,l)}),t===pe)for(o=0;o<a.length;)i[a[o].identifier]=!0,o++;for(o=0;o<r.length;)i[r[o].identifier]&&s.push(r[o]),t&(Te|ye)&&delete i[r[o].identifier],o++;return s.length?[k(a.concat(s),"identifier",!0),s]:void 0}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:ue,srcEvent:e})}});var We=2500,Ge=25;l(D,C,{handler:function(e,t,n){var i=n.pointerType==ue,o=n.pointerType==de;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)(function(e,t){e&pe?(this.primaryTouch=t.changedPointers[0].identifier,V.call(this,t)):e&(Te|ye)&&V.call(this,t)}).call(this,t,n);else if(o&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var o=this.lastTouches[i],a=Math.abs(t-o.x),r=Math.abs(n-o.y);if(Ge>=a&&Ge>=r)return!0}return!1}.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _e=v(te.style,"touchAction"),je=_e!==i,Ye="compute",Xe="auto",qe="manipulation",Ke="none",Ue="pan-x",Je="pan-y",Qe=function(){if(!je)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){t[i]=!n||e.CSS.supports("touch-action",i)}),t}();F.prototype={set:function(e){e==Ye&&(e=this.compute()),je&&this.manager.element.style&&Qe[e]&&(this.manager.element.style[_e]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return r(this.manager.recognizers,function(t){c(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(p(e,Ke))return Ke;var t=p(e,Ue),n=p(e,Je);return t&&n?Ke:t||n?t?Ue:Je:p(e,qe)?qe:Xe}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(!this.manager.session.prevented){var i=this.actions,o=p(i,Ke)&&!Qe[Ke],a=p(i,Je)&&!Qe[Je],r=p(i,Ue)&&!Qe[Ue];if(o){var s=1===e.pointers.length,l=e.distance<2,m=e.deltaTime<250;if(s&&l&&m)return}return r&&a?void 0:o||a&&n&Pe||r&&n&Oe?this.preventSrc(t):void 0}t.preventDefault()},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ze=1,$e=2,et=4,tt=8,nt=tt,it=16;E.prototype={defaults:{},set:function(e){return $(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(a(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=W(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return a(e,"dropRecognizeWith",this)?this:(e=W(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(a(e,"requireFailure",this))return this;var t=this.requireFail;return-1===T(t,e=W(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(a(e,"dropRequireFailure",this))return this;e=W(e,this);var t=T(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){n.manager.emit(t,e)}var n=this,i=this.state;tt>i&&t(n.options.event+N(i)),t(n.options.event),e.additionalEvent&&t(e.additionalEvent),i>=tt&&t(n.options.event+N(i))},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=32)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|Ze)))return!1;e++}return!0},recognize:function(e){var t=$({},e);return c(this.options.enable,[this,t])?(this.state&(nt|it|32)&&(this.state=Ze),this.state=this.process(t),void(this.state&($e|et|tt|it)&&this.tryEmit(t))):(this.reset(),void(this.state=32))},process:function(e){},getTouchAction:function(){},reset:function(){}},l(G,E,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=t&($e|et),o=this.attrTest(e);return i&&(n&ye||!o)?t|it:i||o?n&Te?t|tt:t&$e?t|et:$e:32}}),l(_,G,{defaults:{event:"pan",threshold:10,pointers:1,direction:Se},getTouchAction:function(){var e=this.options.direction,t=[];return e&Pe&&t.push(Je),e&Oe&&t.push(Ue),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,o=e.direction,a=e.deltaX,r=e.deltaY;return o&t.direction||(t.direction&Pe?(o=0===a?ke:0>a?ve:we,n=a!=this.pX,i=Math.abs(e.deltaX)):(o=0===r?ke:0>r?Ce:be,n=r!=this.pY,i=Math.abs(e.deltaY))),e.direction=o,n&&i>t.threshold&&o&t.direction},attrTest:function(e){return G.prototype.attrTest.call(this,e)&&(this.state&$e||!(this.state&$e)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=H(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),l(j,G,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ke]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&$e)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),l(Y,E,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Xe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,a=e.deltaTime>t.time;if(this._input=e,!i||!n||e.eventType&(Te|ye)&&!a)this.reset();else if(e.eventType&pe)this.reset(),this._timer=o(function(){this.state=nt,this.tryEmit()},t.time,this);else if(e.eventType&Te)return nt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===nt&&(e&&e.eventType&Te?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ae(),this.manager.emit(this.options.event,this._input)))}}),l(X,G,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ke]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&$e)}}),l(q,G,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Pe|Oe,pointers:1},getTouchAction:function(){return _.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(Pe|Oe)?t=e.overallVelocity:n&Pe?t=e.overallVelocityX:n&Oe&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&oe(t)>this.options.velocity&&e.eventType&Te},emit:function(e){var t=H(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),l(K,E,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[qe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,a=e.deltaTime<t.time;if(this.reset(),e.eventType&pe&&0===this.count)return this.failTimeout();if(i&&a&&n){if(e.eventType!=Te)return this.failTimeout();var r=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||A(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&r?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=o(function(){this.state=nt,this.tryEmit()},t.interval,this),$e):nt}return 32},failTimeout:function(){return this._timer=o(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==nt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),U.VERSION="2.0.8",U.defaults={domEvents:!1,touchAction:Ye,enable:!0,inputTarget:null,inputClass:null,preset:[[X,{enable:!1}],[j,{enable:!1},["rotate"]],[q,{direction:Pe}],[_,{direction:Pe},["swipe"]],[K],[K,{event:"doubletap",taps:2},["tap"]],[Y]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};J.prototype={set:function(e){return $(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var n,i=this.recognizers,o=t.curRecognizer;(!o||o&&o.state&nt)&&(o=t.curRecognizer=null);for(var a=0;a<i.length;)n=i[a],2===t.stopped||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(e),!o&&n.state&($e|et|tt)&&(o=t.curRecognizer=n),a++}},get:function(e){if(e instanceof E)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(a(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(a(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=T(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==i&&t!==i){var n=this.handlers;return r(f(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==i){var n=this.handlers;return r(f(e),function(e){t?n[e]&&n[e].splice(T(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&Z(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&Q(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},$(U,{INPUT_START:pe,INPUT_MOVE:fe,INPUT_END:Te,INPUT_CANCEL:ye,STATE_POSSIBLE:Ze,STATE_BEGAN:$e,STATE_CHANGED:et,STATE_ENDED:tt,STATE_RECOGNIZED:nt,STATE_CANCELLED:it,STATE_FAILED:32,DIRECTION_NONE:ke,DIRECTION_LEFT:ve,DIRECTION_RIGHT:we,DIRECTION_UP:Ce,DIRECTION_DOWN:be,DIRECTION_HORIZONTAL:Pe,DIRECTION_VERTICAL:Oe,DIRECTION_ALL:Se,Manager:J,Input:C,TouchAction:F,TouchInput:B,MouseInput:L,PointerEventInput:R,TouchMouseInput:D,SingleTouchInput:z,Recognizer:E,AttrRecognizer:G,Tap:K,Pan:_,Swipe:q,Pinch:j,Rotate:X,Press:Y,on:u,off:d,each:r,merge:se,extend:re,assign:$,inherit:l,bindFn:m,prefixed:v}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=U,"function"==typeof define&&define.amd?define(function(){return U}):"undefined"!=typeof module&&module.exports?module.exports=U:e.Hammer=U}(window,document);const print=console.log;function getEditDistance(e,t){"use strict";e=e.toLowerCase(),t=t.toLowerCase();let n=[];for(let i=0,o=e.length;i<=o;i++){let o=i;for(let a=0,r=t.length;a<=r;a++)if(0==i)n[a]=a;else if(a>0){let r=n[a-1];e.charAt(i-1)!=t.charAt(a-1)&&(r=Math.min(Math.min(r,o),n[a])+1),n[a-1]=o,o=r}i>0&&(n[t.length]=o)}return n[t.length]}function RGBa(e,t,n,i){return i||(i=1),"rgba("+[e,t,n,i].join(", ")+")"}document.body.width=function(){"use strict";return Math.max(document.body.offsetWidth,document.body.scrollWidth,document.documentElement.clientWidth,document.documentElement.offsetWidth,document.documentElement.scrollWidth)}(),window.location.get=function(e){"use strict";const t=new URLSearchParams(this.search);let n=t.get(e)?t.get(e):null;return null!=n?n.trimStart().trimEnd().replace(/\s\s+/g," "):null==(n=new RegExp("[?&]"+e+"=([^&#]*)").exec(this.href))||n&&!n[1]?null:decodeURI(n[1]).trimStart().trimEnd().replace(/\s\s+/g," ")},Array.prototype.intersect=function(e){return this.filter(t=>e.includes(t))},String.prototype.compare=function(e){"use strict";let t=this,n=e;return this.length<e.length&&(t=e,n=this),0==t.length?1:(t.length-getEditDistance(t,n))/parseFloat(t.length)},Array.prototype.getby=function(e,t){"use strict";t||(t="id");for(let n=this.length-1;n>=0;n--)if(this[n][t]==e)return this[n];return null},Array.prototype.getbys=function(e,t){"use strict";t||(t="id");let n=[];for(let i=this.length-1;i>=0;i--){let o=this[i][t];Array.isArray(e)&&Array.isArray(o)&&0!=o.intersect(e).length&&n.push(this[i])}return n};const style={item:{background:{color:RGBa(255,255,255)},text:{color:RGBa(34,34,34)},height:141.4,width:82.62},dot:{height:3,width:3},line:{color:RGBa(175,175,175)},highlight:{thickness:[3.5,3.3125,3.125,2.9375,2.75,2.5625,2.375,2.1875,2],text:{color:RGBa(255,255,255)},background:{colors:[RGBa(36,36,36),RGBa(39,39,39),RGBa(42,42,42),RGBa(45,45,45),RGBa(48,48,48),RGBa(51,51,51),RGBa(54,54,54),RGBa(57,57,57),RGBa(60,60,60)]},opacity:1,zOrderType:2,showArrows:!1},name:{lengthThreshold:23},body:{background:{color:RGBa(242,243,244)},text:{color:RGBa(34,34,34)}}};let config={arrowsDirection:primitives.common.GroupByType.None,bevelSize:9,connectorType:primitives.common.ConnectorType.Curved,elbowDotSize:0,elbowType:primitives.common.ElbowType.Round,linesColor:style.line.color,showExtraArrows:!1,lineItemsInterval:50,lineLevelShift:30,linesWidth:2,normalItemsInterval:13,normalLevelShift:26,pageFitMode:primitives.common.PageFitMode.None,updateMode:primitives.common.UpdateMode.Recreate};function getItemizedArray(e){"use strict";let t=[];for(let n=0,i=e.length;n<i;n++)e[n].idx=n,t.push(new primitives.famdiagram.ItemConfig(e[n]));return t}function getDisplayName(e,t){"use strict";const n="Given",i="Surname",o="Suffix",a=e.names[0].nameForms[0].parts;function r(e){let t="";return e[n]&&(t+=e[n].value.join(" ")),e[i]&&(t+=" ",t+=e[i].value.join(" ")),e[o]&&(t+=" ",t+=e[o].value.join(" ")),t}function s(e,t){for(;r(l).length>t&&l[e].cursor>0;){let t=l[e].value[l[e].cursor];l[e].value[l[e].cursor]=t[0],l[e].cursor-=1}}let l={};for(let e=0,t=a.length;e<t;e++){let t=a[e].type.split("/").pop(),n=a[e].value.split(" ");l[t]={cursor:n.length-1,value:n}}return s(n,t-6),s(i,t),r(l)}function getDisplayGender(e){"use strict";return e.gender.type.includes("Male")?1:0}function getLifeRange(e){"use strict";if(!e.facts||0==e.facts.length)return"";let t=null,n=null,i=!1;for(let o=0,a=e.facts.length;o<a;o++){let a=e.facts[o];a.type.includes("Death")?(i=!0,a.date&&a.date.original&&(n=a.date.original.split(" ").pop(),parseInt(n)||(n=""))):a.type.includes("Birth")&&a.date&&a.date.original&&(t=a.date.original.split(" ").pop(),parseInt(t)||(t=""))}i||(n="Living");let o="";return(t||n)&&(o=" — "),(t||"")+o+(n||"")}function addRelationship(e,t,n,i){"use strict";if(!t.type.includes(n))return;let o=t.person1.resourceId;e[i]?e[i].push(o):e[i]=[o]}function addRelationships(e,t){"use strict";if(!t||t.length<=0)return e;for(let n=0,i=t.length;n<i;n++){let i=t[n],o=e.getby(i.person2.resourceId);addRelationship(o,i,"ParentChild","parents"),addRelationship(o,i,"Couple","spouses")}for(let t=0,n=e.length;t<n;t++){let n=e[t],i=e.getbys(n.parents,"parents");if(0!=i.length){n.siblings=[];for(let e=0,t=i.length;e<t;e++){let t=i[e];n.id!=t.id&&n.siblings.push(t.id)}}}return e}function addHighlightPath(e,t,n,i,o){"use strict";return null==i&&(i=20),null==o&&(o=0),e.concat([new primitives.famdiagram.HighlightPathAnnotationConfig(Object.assign(style.highlight,{color:style.body.background.color,items:n,lineWidth:(8+2*i)/1.5})),new primitives.famdiagram.HighlightPathAnnotationConfig(Object.assign(style.highlight,{color:t,items:n,lineWidth:i,lineType:o}))])}function getPedegreeAnnotations(e,t,n,i){"use strict";i||(i=[]);let o=n.getby(e);if(o||(o=n[0].id),o&&!o.parents)return o.importance=t,i;i=addHighlightPath(i,style.highlight.background.colors[t],[e].concat(o.parents),style.highlight.thickness[t]),o.importance=t;for(let e=0,a=(o.parents||[]).length;e<a;e++)i=getPedegreeAnnotations(o.parents[e],t+1,n,i);return i}const loc=window.location.pathname,url=loc.substring(0,loc.lastIndexOf("/"))+(loc.includes(".html")?"/index.html":""),classes={item:"tree-item",imgWrapper:"item-img-container",img:"item-img",detailsWrapper:"item-details-container",details:"item-details",displayname:"displayname",liferange:"liferange"},template=function(){"use strict";let e=new primitives.famdiagram.TemplateConfig;return e.name="TreeItemTemplate",e.isActive=!1,e.itemSize=new primitives.common.Size(style.item.width,style.item.height),e.minimizedItemSize=new primitives.common.Size(style.dot.width,style.dot.height),e.itemTemplate=["a",{class:[classes.item],style:{height:e.itemSize.height+"px",width:e.itemSize.width+"px"}},["div",{class:[classes.imgWrapper],style:{height:e.itemSize.width+"px"}},["figure",{name:classes.img,class:[classes.img],style:{height:e.itemSize.width+"px"}}]],["div",{class:[classes.details],style:{height:e.itemSize.height-e.itemSize.width+"px"}},["div",{class:[classes.detailsWrapper],style:{height:e.itemSize.height-e.itemSize.width+"px",width:e.itemSize.width+"px"}},["div",{name:classes.displayname,class:[classes.displayname]}],["div",{name:classes.liferange,class:[classes.liferange]}]]]],e.render=function(e,t){let n=t.context,i=$(t.element);n.displayname=getDisplayName(n,style.name.lengthThreshold),n.displaygender=getDisplayGender(n),n.liferange=getLifeRange(n),i.children("."+classes.imgWrapper).children("."+classes.img).css({"background-position-x":(n.extracted?n.idx+2:n.displaygender)*(-1*style.item.width)});let o=i.children("."+classes.details);o.children("."+classes.detailsWrapper).children().each(function(){let e=$(this).attr("name");$(this).text(n[e])});let a=n.importance;null!=a||null!=a?o.css({"background-color":style.highlight.background.colors[a],color:style.highlight.text.color}):o.css({"background-color":style.item.background.color,color:style.item.text.color}),i.attr({onClick:"updatePersons('"+n.id+"')"})},e}();function searchPerson(e,t){"use strict";if(!e)return!1;let n=parseInt(e);if(Number.isInteger(n))return t.id==n?1:0;let i=e.split(" "),o=t.names[0].nameForms[0].fullText.split(" "),a=0;for(let e=0,t=i.length;e<t;e++){let t=0;for(let n=0,a=o.length;n<a;n++){let a=i[e].compare(o[n]);a>t&&(t=a)}a+=t}return a/=i.length}function filterPersons(e,t){"use strict";for(let e=0,n=t.length;e<n;e++)delete t[e].importance;if(!e)return{persons:t,annotations:getPedegreeAnnotations(t[0].id,0,t,[]),main:t[0]};let n={},i=0;for(let o=0,a=t.length;o<a;o++){let a=t[o],r=searchPerson(e,a);null==n[r]?n[r]=[a.id]:n[r].push(a.id),i=Math.max(i,r)}if(i<.73)return{persons:t,annotations:getPedegreeAnnotations(t[0].id,0,t,[]),main:t[0]};let o=!1;for(let t=0,n=e.split(" "),i=n.length;t<i;t++)["acosta","argabioso","maramba","saplala"].includes(n[t])&&(o=!0);let a=n[i],r=[],s=[],l=[],m=[];for(let e=0,n=a.length;e<n;e++){let n=a[e],i=t.getby(n);r=r.concat(i.parents),s=s.concat(i.siblings),l=l.concat(i.spouses)}let c=1==a.length,h=null,u=getPedegreeAnnotations((h=c?t.getby(a[0]):o?t[0]:t.getby(a[0])).id,0,t,[]);for(let e=0,n=t.length;e<n;e++){let n=t[e];for(let e=0,t=(n.parents||[]).length;e<t;e++)a.includes(n.parents[e])&&m.push(n.id);for(let e=0,t=(n.spouses||[]).length;e<t;e++)a.includes(n.spouses[e])&&m.push(n.id)}let d=a.concat(m);if(d=(d=(d=d.concat(r)).concat(s)).concat(l),c)for(let e=0,n=d.length;e<n;e++)for(let n=0,i=t.length;n<i;n++){let i=t[n];d[e]==i.id&&(d=d.concat(i.parents))}let g=!1;for(let e=0,n=a.length;e<n;e++)null!=t.getby(a[e]).importance&&(g=!0);if(g)for(let e=0,n=t.length;e<n;e++){let n=t[e];null!=n.importance&&d.push(n.id)}let p=[];for(let e=0,n=t.length;e<n;e++){let n=t[e];if(!d.includes(n.id))continue;let i=[];for(let e=0,t=(n.parents||[]).length;e<t;e++)d.includes(n.parents[e])&&i.push(n.parents[e]);let o=[];for(let e=0,t=(n.spouses||[]).length;e<t;e++)d.includes(n.spouses[e])&&o.push(n.spouses[e]);n.parents=i,n.spouses=o,p.push(n)}return{persons:p,annotations:u,main:h}}let control=null;function updatePersons(e){e||(e=""),$.getJSON("/family/data.json",function(t){"use strict";let n=new primitives.famdiagram.Config;n=Object.assign(n,config);let i=addRelationships(t.persons,t.relationships);i=getItemizedArray(i);let o=filterPersons(e,i);n.items=o.persons,n.annotations=o.annotations,n.defaultTemplateName=template.name,n.onItemRender=template.render,n.templates=[template],$("#tree").animate({opacity:0},200,function(){$("#tree").empty(),control=primitives.famdiagram.Control(document.getElementById("tree"),n);let e=$("#tree").children().first().children().first();$("#tree").children().first().scrollTop((e.height()-$(window).height())/2),$("#tree").children().first().scrollLeft((e.width()-$(window).width())/2),$("#tree").animate({opacity:1})});let a=o.main.names[0].nameForms[0].fullText+" | Family Tree";window.history.pushState("popState",a,window.location.href.split("?")[0]+"?q="+e),$(document).prop("title",a)})}$(document).ready(function(e){let t=!0;e("#search-button").attr("disabled","disabled"),e("#search-form :input").on("keyup",function(){let t=!1;e("#search-form :input").each(function(){t=0==e(this).val().length}),t?e("#search-button").attr("disabled","disabled"):e("#search-button").attr("disabled",!1)}),e("#search-form").submit(function(n){var i={};e("#search-form :input").each(function(){i[this.name]=e(this).val()}),t=!1,updatePersons(i.q),n.preventDefault()}),e(window).on("popstate",function(){t=!1,updatePersons(window.location.get("q"))}),t&&updatePersons(window.location.get("q")),hammerIt(document.getElementById("tree"))});